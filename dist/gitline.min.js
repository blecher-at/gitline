function indexToX(t){return 20*t+12}var AsyncLoadingItem=function(){function t(t,e,n,i,o){this.label=t,this.data=e,this.callback=n,this.index=i,this.of=o}return t}(),AsyncLoader=function(){function t(t){this.items=[],this.suspended=!1,this.element=t}return t.prototype.then=function(t,e,n){var i=this;return this.thenSingle(t,function(){for(var o=e(),a=o.length-1;a>=0;a--)i.items.unshift(new AsyncLoadingItem(t,o[a],n,a,o.length))}),this},t.prototype.thenSingle=function(t,e){return this.items.push(new AsyncLoadingItem(t,null,e,0,1)),this},t.prototype.start=function(t){void 0===t&&(t=!0),t&&(this.element.hidden=!1),this.next()},t.prototype.next=function(){var t=this,e=this.items.shift();void 0!==e?e.index%50===0?(this.showStatus(e),window.setTimeout(function(){Logger.debug("executing "+e.label+" ("+e.index+"/"+e.of+")"),t.execute(e)},0)):this.execute(e):this.element.hidden=!0},t.prototype.suspend=function(){this.suspended=!0},t.prototype.resume=function(){this.suspended=!1,this.next()},t.prototype.showStatus=function(t){this.element.innerHTML=t.label},t.prototype.execute=function(t){t.callback(t.data),this.suspended||this.next()},t}(),GitlineConfig=function(){function t(){this.dotHeight=6,this.dotWidth=8,this.remoteOnly=!1,this.avatars=[this.avatar_gravatar]}return t.prototype.avatar_gravatar=function(t){return"http://www.gravatar.com/avatar/"+CryptoJS.MD5(t.toLowerCase())+"?s=16&d=404"},t}(),Expandable=function(){function t(){}return t.extend=function(t){var e=t;return t.classList.add("gitline-expandable"),e.whenFull=function(n){e.onclick=function(i){2==i.detail&&(e.innerHTML=n,i.cancelBubble=!0,t.classList.add("gitline-expandable-expanded"))}},e.whenShort=function(n){e.innerHTML=n,e.onmouseout=function(i){e.innerHTML=n+" ",t.classList.remove("gitline-expandable-expanded")}},e},t}(),CommitProvider=function(){function t(t){this.url=t}return t.prototype.whenDone=function(t){this.callback(t)},t.prototype.withCallback=function(t){this.callback=t},t.prototype.onRequested=function(t){throw new Error("onRequested not implemented on "+this)},t.prototype.request=function(){this.onRequested(this.url)},t}(),__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},LocalGit2JsonProvider=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.onRequested=function(t){var e=this;jQuery.getJSON(t,{},function(t){e.whenDone(t)}).error(function(){Gitline.displayFatalError("Error loading git data from "+t+" create it using git2json")})},e}(CommitProvider),GithubCommitProvider=function(t){function e(e,n,i){t.call(this,e),this.forks=[],this.baseBranches=[],this.data={},this.done=!1,this.accessToken=i,this.limit=n}return __extends(e,t),e.prototype.gitURL=function(t,e,n){return void 0===n&&(n=""),-1==t.indexOf("api.github.com")&&(t=t.replace(/.*github.com/,"https://api.github.com/repos/").replace(/\/\//g,"/")),t+"/"+e+"?access_token="+this.accessToken+"&per_page="+this.limit+"&callback=?&"+n},e.prototype.onRequested=function(t){this.loadForks(t)},e.prototype.loadForks=function(t){var e=this;jQuery.when(jQuery.getJSON(this.gitURL(t,"forks")),jQuery.getJSON(this.gitURL(t,"branches"))).then(function(n,i){e.processBranches(t,i[0].data),e.forks=n[0].data,e.loadBranches()})},e.prototype.processBranches=function(t,e){var n=this;e.forEach(function(e){e.repo=void 0!==t.url?t.url:t,void 0!==t.full_name&&(e.name=e.name+"@"+t.full_name),n.baseBranches.push(e)})},e.prototype.loadBranches=function(){var t=this,e=this.forks.map(function(e){return jQuery.getJSON(t.gitURL(e.url,"branches"),function(n){Logger.debug("loaded branches for "+e.name),t.processBranches(e,n.data)})});jQuery.when.apply(jQuery,e).done(function(){Logger.debug("all branches loaded"),t.loadCommits()})},e.prototype.loadCommits=function(){var t=this,e=[];this.baseBranches.forEach(function(n){var i=t.data[n.commit.sha];void 0==i&&e.push(jQuery.getJSON(t.gitURL(n.repo,"commits","sha="+n.commit.sha),function(e){Logger.debug("loaded commits for "+n.name),t.processCommits(e.data)}))}),jQuery.when.apply(jQuery,e).done(function(){t.process()})},e.prototype.processCommits=function(t){var e=this;t.map(function(t){var e={};return e.sha=t.sha,e.ssha=t.sha.substring(0,8),e.parenthashes=t.parents.map(function(t){return t.sha}),e.authorname=t.commit.author.name,e.authoremail=t.commit.author.email,e.authordate=t.commit.author.date,e.authortimestamp=new Date(t.commit.author.date).getTime(),e.committername=t.commit.committer.name,e.committeremail=t.commit.committer.email,e.committerdate=t.commit.committer.date,e.committertimestamp=new Date(t.commit.committer.date).getTime(),e.subject=t.commit.message,e.body="",e.refnames=[],e.inHeads=[],e}).forEach(function(t){e.data[t.sha]=t})},e.prototype.process=function(){var t=this;this.baseBranches.forEach(function(e){var n=t.data[e.commit.sha];void 0==n||(e.assigned=!0,n.refnames.push(e.name),t.assignHeads(n))});var e={};Object.keys(this.data).sort(function(e,n){return t.data[n].committertimestamp-t.data[e].committertimestamp}).forEach(function(n){e[n]=t.data[n]}),this.whenDone(e)},e.prototype.assignHeads=function(t){var e=this;for(t.parents1=t.parenthashes.map(function(t){return t});t.parents1.length>0;){var n=[];t.parents1.forEach(function(i){var o=e.data[i];void 0!=o&&(o.inHeads.push(t.sha),o.parenthashes.forEach(function(t){-1===n.indexOf(t)&&n.push(t)}))}),t.parents1=n}},e}(CommitProvider),Gitline=function(){function t(){this.self=this,this.maxX=0,this.maxIndexY=0,this.commits={},this.headsMap={},this.config=new GitlineConfig}return t.prototype.addCommit=function(t){this.commits[t.getFullSha()]=t,void 0===this.firstCommit&&(this.firstCommit=t)},t.prototype.addBranch=function(t,e,n){var i=new Branch(t,e,n);this.headsMap[t]=i},t.prototype.render=function(){var t=this;this.canvas=new jsgl.Panel(this.graphicalPanel),this.al.thenSingle("Loading Data",function(){t.al.suspend(),t.commitProvider.withCallback(function(e){t.data=e,t.al.resume()}),t.commitProvider.request()}).then("Loading Commits",function(){return Object.keys(t.data)},function(e){var n=new Commit(t,t.data[e]);t.addCommit(n)}).thenSingle("Building Graph",function(){t.buildGraph()}).then("Drawing Labels",function(){return Object.keys(t.commits)},function(e){var n=t.commits[e];t.drawCommit(n)}).thenSingle("Creating Legend",function(){t.rootLabel=document.createElement("div"),t.rootLabel.className="commit-legend",t.textPanel.appendChild(t.rootLabel)}).then("Drawing Merges",function(){return Object.keys(t.commits)},function(e){var n=t.commits[e];t.drawReferences(n)}).thenSingle("Resizing",function(){t.graphicalPanel.style.width=indexToX(t.maxX+1)+"px",t.graphicalPanel.style.height=t.getHeight()+"px"}).start(),window.onresize=function(e){t.al.then("Redrawing",function(){return Object.keys(t.commits)},function(e){var n=t.commits[e];n.view.redraw()}).thenSingle("Resizing",function(){t.graphicalPanel.style.width=indexToX(t.maxX+1)+"px",t.graphicalPanel.style.height=t.getHeight()+"px"}).start(!1)}},t.prototype.getHeight=function(){return this.rootLabel.offsetTop-this.firstCommit.view.label.offsetTop},t.prototype.buildGraph=function(){var t=this,e=Object.keys(this.commits);e.forEach(function(e){var n=t.commits[e];n.initRelations()}),e.forEach(function(e){var n=t.commits[e];n.initHeadSpecifity(),n.initMerges()}),this.initBranches()},t.prototype.drawCommit=function(t){t.view=new CommitView(this.canvas,this.config,t),t.outOfScope===!1&&(t.view.label=this.drawLabel(t),t.view.label.onclick=function(){console&&Logger.debug(t)},this.textPanel.appendChild(t.view.label),t.view.label.style["padding-left"]=indexToX(this.maxX+1)+"px")},t.prototype.drawReferences=function(t){t.view.addRelations(),t.view.redraw()},t.prototype.drawLabel=function(t){var e=document.createElement("div");e.className="commit-legend";var n=t.getShortSha(),i=t.getFullSha(),o=Expandable.extend(document.createElement("span"));if(o.whenShort(n+" "),o.whenFull(i),o.style.fontFamily="Courier",e.appendChild(o),e.appendChild(this.drawIdentity("author",t.author)),t.author.email!=t.committer.email&&e.appendChild(this.drawIdentity("committer",t.committer)),t.branch&&t.branch.commit===t&&!t.branch.anonymous){var a=document.createElement("span");a.className="head-label",a.style.backgroundColor=t.getColor(40),a.style.color="white",a.style.paddingLeft=a.style.paddingRight="2px",a.innerHTML=t.branch.ref,e.appendChild(a)}var r=document.createElement("span");return r.innerHTML=" "+t.subject,r.style.color=t.hasMerges()?"grey":"black",e.appendChild(r),e.style.position="relative",e},t.prototype.drawIdentity=function(t,e){var n=Expandable.extend(document.createElement("gitline-identity"));n.setAttribute("class",t),n.setAttribute("name",e.name);var i=e.name+" &lt;"+e.email.toLowerCase()+"&gt;";return n.setAttribute("title",i),n.style.background=this.config.avatars.map(function(t){return"url("+t(e.email)+") no-repeat"}).join(", "),n.whenFull(i),n.whenShort(" "),n},t.prototype.initBranches=function(){for(var t=Object.keys(this.headsMap),e=0;e<t.length;e++){var n=t[e],i=this.headsMap[n];i.commit.initDefaultBranch()}var o=this;t.sort(function(t,e){var n=o.headsMap[t].commit,i=o.headsMap[e].commit;return n===i?0:n.branch.category===i.branch.category?n.branch.specifity-i.branch.specifity:n.branch.category.length-i.branch.category.length});for(var a=0,e=0;e<t.length;e++){var n=t[e],i=this.headsMap[n],r=i.commit;if(r.branch===i){i.lane=a,a++;for(var s=0;s<t.length;s++){for(var h=!0,c=0;c<t.length;c++){var l=t[c],d=this.headsMap[l].commit;(void 0===d||d.branch!=i&&d.branch.lane===s&&(r.intersects(d)||r.branch.category!=d.branch.category))&&(h=!1)}if(h){Logger.debug("NO INTERSECTS: ",r.branch.ref," - ",d.branch.ref),i.lane=s;break}}this.maxX=Math.max(this.maxX,i.lane)}}},t.prototype.fromJSON=function(t){return this.fromProvider(new LocalGit2JsonProvider(t))},t.prototype.fromProvider=function(t){return this.commitProvider=t,this},t.prototype.renderTo=function(t){return void 0!==this.headerPanel&&t.appendChild(this.headerPanel),t.appendChild(this.loadingPanel=document.createElement("gitline-loadingpanel")),t.appendChild(this.contentPanel=document.createElement("gitline-contentpanel")),this.contentPanel.appendChild(this.graphicalPanel=document.createElement("gitline-graphicalpanel")),this.contentPanel.appendChild(this.textPanel=document.createElement("gitline-textpanel")),this.al=new AsyncLoader(this.loadingPanel),this.render(),this},t.prototype.withHeader=function(t){return"string"==typeof t?(this.headerPanel=document.createElement("gitline-headerpanel"),this.headerPanel.innerHTML=t):this.headerPanel=t,this},t.displayFatalError=function(t){alert(t)},t}(),Shape=function(){function t(t,e){this.dependencies=[],this.canvas=t,this.element=e}return t.prototype.addIfMissing=function(){void 0!==this.element&&null==this.renderedTo&&(this.addElements(),this.renderedTo=this.canvas)},t.prototype.addElements=function(){this.canvas.addElement(this.element)},t.prototype.update=function(){this.dependencies.forEach(function(t){t.update()})},t.prototype.dependsOn=function(t){t.dependencies.push(this)},t}(),Dot=function(t){function e(e){t.call(this,e,e.createRectangle())}return __extends(e,t),e.prototype.size=function(t,e){return this.width=t,this.height=e,this.element.setWidth(t),this.element.setHeight(e),this.element.setXRadius(t/4),this.element.setYRadius(t/4),this.update(),this.addIfMissing(),this},e.prototype.at=function(t,e){return this.x=t,this.y=e,this.update(),this.addIfMissing(),this},e.prototype.color=function(t,e){return this.element.getStroke().setWeight(1),this.element.getStroke().setColor(t),this.element.getFill().setColor(e),this},e.prototype.update=function(){this.element.setLocationXY(this.x-this.width/2,this.y-this.height/2),t.prototype.update.call(this)},e}(Shape),BaseLink=function(t){function e(e,n){t.call(this,e,n)}return __extends(e,t),e.prototype.from=function(t){return this.dependsOn(t),this.parentDot=t,this},e.prototype.to=function(t){return this.childDot=t,this},e.prototype.color=function(t){return this.element.getStroke().setWeight(1),this.element.getStroke().setColor(t),this.lineColor=t,this.addIfMissing(),this},e}(Shape),Curve=function(t){function e(e){t.call(this,e,e.createCurve()),this.arrow=this.canvas.createPolygon()}return __extends(e,t),e.prototype.addElements=function(){t.prototype.addElements.call(this),this.canvas.addElement(this.arrow)},e.prototype.update=function(){var t=this.childDot.x,e=this.childDot.y,n=this.parentDot.x,i=this.parentDot.y,o=this.lineColor,a=n>t?1:-1;this.element.setStartPointXY(n,i-this.parentDot.height/2),this.element.setEndPointXY(t+this.childDot.width/2*a,e),this.element.setControl2PointXY(n,e),this.element.setControl1PointXY(n,e),this.element.getStroke().setWeight(1),this.element.getStroke().setColor(o),this.arrow.getStroke().setWeight(0),this.arrow.getFill().setColor(o),this.arrow.clearPoints(),this.arrow.addPointXY(0,0),this.arrow.addPointXY(6,-4),this.arrow.addPointXY(6,4);for(var r=0;r<this.arrow.getPointsCount();r++){var s=this.arrow.getPointAt(r).X,h=this.arrow.getPointAt(r).Y;this.arrow.setPointXYAt(s*a+t+this.childDot.width/2*a,h+e,r)}},e}(BaseLink),Straight=function(t){function e(e){t.call(this,e,e.createLine())}return __extends(e,t),e.prototype.update=function(){t.prototype.update.call(this),this.element.setStartPointXY(this.parentDot.x,this.parentDot.y-this.parentDot.height/2),this.element.setEndPointXY(this.childDot.x,this.childDot.y+this.childDot.height/2)},e}(BaseLink),Creation=function(t){function e(e){t.call(this,e,e.createLine()),this.secondLine=e.createLine()}return __extends(e,t),e.prototype.addElements=function(){t.prototype.addElements.call(this),this.canvas.addElement(this.secondLine)},e.prototype.update=function(){t.prototype.update.call(this),this.parentDot.x<this.childDot.x?this.element.setStartPointXY(this.parentDot.x+this.parentDot.width/2,this.parentDot.y):this.element.setStartPointXY(this.parentDot.x-this.parentDot.width/2,this.parentDot.y),this.element.setEndPointXY(this.childDot.x,this.parentDot.y),this.element.getStroke().setWeight(1),this.element.getStroke().setDashStyle(jsgl.DashStyles.DASH),this.element.getStroke().setColor(this.lineColor),this.secondLine.setStartPointXY(this.childDot.x,this.parentDot.y),this.secondLine.setEndPointXY(this.childDot.x,this.childDot.y+this.childDot.height/2),this.secondLine.getStroke().setWeight(1),this.secondLine.getStroke().setColor(this.lineColor)},e}(BaseLink),CommitView=function(){function t(t,e,n){this.lines=[],this.canvas=t,this.config=e,this.commit=n,this.dot=new Dot(this.canvas)}return t.prototype.addRelations=function(){var t=this;if(null!=this.commit.directparent){var e;e=this.commit.getLane()==this.commit.directparent.getLane()||this.commit.directparent.outOfScope?new Straight(this.canvas).from(this.commit.directparent.view.dot).to(this.dot).color(this.commit.getColor(20)):new Creation(this.canvas).from(this.commit.directparent.view.dot).to(this.dot).color(this.commit.getColor(30)),this.lines.push(e)}var n=this.commit.merges.standard.concat(this.commit.merges.anonymous);n.forEach(function(e){t.lines.push(new Curve(t.canvas).from(e.source.view.dot).to(t.dot).color(e.source.getColor(35)))})},t.prototype.redraw=function(){this.dot.at(this.commit.getX(),this.commit.getY()).size(this.config.dotWidth,this.config.dotHeight).color(this.commit.getColor(20),this.commit.getColor(80))},t}(),Identity=function(){function t(t,e,n){this.name=t,this.email=e,this.date=n}return t}(),Commit=function(){function t(t,e){this.warnings=[],this.inHeadsRef=[],this.parents=[],this.childs=[],this.siblings=[],this.outOfScope=!1,this.merges={standard:[],anonymous:[]},this.container=t,this.data=e,this.data.obj=this,null==e.inHeads&&(e.inHeads=[]),null==e.parenthashes&&(e.parenthashes=[]),null==e.refnames&&(e.refnames=[]),this.sha=e.sha,this.ssha=e.ssha,this.subject=e.subject,this.indexY=t.maxIndexY++,this.committer=new Identity(this.data.committername,this.data.committeremail,new Date(this.data.committerdate).getTime()),this.author=new Identity(this.data.authorname,this.data.authoremail,new Date(this.data.authordate).getTime())}return t.prototype.getShortSha=function(){return this.ssha},t.prototype.getFullSha=function(){return this.sha},t.prototype.initRelations=function(){var e=this,n=this;this.data.parenthashes.forEach(function(i){var o=e.container.commits[i];if(null==o&&(o=new t(e.container,{sha:i+Math.random()}),o.outOfScope=!0,n.container.addCommit(o)),e.parents.push(o),o.childs.push(e),e.siblings=o.childs,e.parents.length>0){var a=e.parents[0];e.directparent=a,a.directchild=e}}),this.data.inHeads.forEach(function(t){var n=e.container.commits[t];void 0===e.inHeadsRef.indexOf(n)&&e.inHeadsRef.push(n)})},t.prototype.initDefaultBranch=function(){for(var t=this;null!=t;)(null==t.branch||t.branch.specifity>this.branch.specifity)&&(t.branch=this.branch),t.branch.start=t,t.branch.origin=t.directparent,t=t.directparent},t.prototype.initHeadSpecifity=function(){for(var t=0;t<this.data.refnames.length;t++){var e=this.data.refnames[t];if(!this.container.config.remoteOnly||0==e.indexOf("origin/")){this.container.config.remoteOnly&&(e=e.replace(/^origin./,""));var n=1e3*e.replace(/[^\/-]/g,"").length;n+=e.replace(/[^a-zA-Z0-9-]/,"").length,this.container.addBranch(e,this,n),(null==this.maxSpecifity||n<this.maxSpecifity)&&(Logger.debug("assigning branch",e,this.sha,this.maxSpecifity,n),this.maxSpecifity=n,this.branch=this.container.headsMap[e]),this.initDefaultBranch()}}},t.prototype.initMerges=function(){if(this.merges={standard:[],anonymous:[]},this.warnings=[],1==this.parents.length){var t=this.parents[0];this.directparent=t,t.directchild=this}if(this.parents.length>=2){var t=this.parents[0];this.directparent=t,t.directchild=this;for(var e=1;e<this.parents.length;e++){var n=this.parents[e];null!=n&&(n.data.refnames.length>0||n.inHeadsRef.length!=t.inHeadsRef.length?this.merges.standard.push({source:n}):(this.merges.anonymous.push({source:n}),this.initAnonymous()))}}},t.prototype.initAnonymous=function(){var t=this;this.merges.anonymous.forEach(function(e){for(var n=e.source,i=t;null!=i&&null==i.branch;)i=i.directchild;null!=i&&null==n.branch&&(n.branch=new Branch(i.branch.ref+"/anonymous"+n.sha+Math.random(),n,i.branch.specifity+1),n.branch.anonymous=!0,n.branch.parent=i.branch,n.branch.start=i,n.branch.category=i.branch.category,t.container.headsMap[n.branch.ref]=n.branch)})},t.prototype.getColor=function(t){if(null!=this.branch){var e=this.branch;this.branch.anonymous&&(e=this.branch.parent);var n=300*e.lane/this.container.maxX;return"hsl("+n+", 100%, "+t+"%)"}this.warn("No Branch set")},t.prototype.hasMerges=function(){return this.merges.standard.length>0||this.merges.anonymous.length>0},t.prototype.getX=function(){return indexToX(this.getLane())},t.prototype.getY=function(){return this.outOfScope?this.container.rootLabel.offsetTop+20:this.view.label.offsetTop-this.container.firstCommit.view.label.offsetTop+this.view.label.offsetHeight/2},t.prototype.getOriginIndexY=function(){return void 0!=this.branch.origin?this.branch.origin.getIndexY():this.branch.start.outOfScope?this.container.maxIndexY:this.branch.start.indexY},t.prototype.intersects=function(t){var e=9999999,n=999999;return this.outOfScope||t.outOfScope?!0:(null!=t.directchild&&(e=t.directchild.indexY),null!=this.directchild&&(n=this.directchild.indexY),this.getOriginIndexY()>=Math.min(t.indexY,e)&&Math.min(n,this.indexY)<=t.getOriginIndexY())},t.prototype.getIndex=function(){return this.data.index},t.prototype.getIndexY=function(){return this.indexY},t.prototype.warn=function(t){this.warnings.push(t),this.debug(t)},t.prototype.debug=function(t){console&&Logger.debug(t,this)},t.prototype.getLane=function(){return null!=this.branch?this.branch.commit.branch.lane:null},t}(),Branch=function(){function t(t,e,n){this.ref=t,this.commit=e,this.specifity=n,this.shortname=t.split("@")[0],this.category=this.shortname.substring(0,this.shortname.lastIndexOf("/"))}return t}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9zb3VyY2UvQ29uZmlnLnRzIiwiL3NvdXJjZS9Bc3luY0xvYWRlci50cyIsIi9zb3VyY2UvRXhwYW5kYWJsZS50cyIsIi9zb3VyY2UvQ29tbWl0UHJvdmlkZXIudHMiLCJnaXRsaW5lLmpzIiwiL3NvdXJjZS9wbHVnaW5zL0xvY2FsR2l0Mkpzb25Qcm92aWRlci50cyIsIi9zb3VyY2UvcGx1Z2lucy9naXRodWIudHMiLCIvc291cmNlL0dpdGxpbmUudHMiLCIvc291cmNlL3JlbmRlcmluZy9TaGFwZS50cyIsIi9zb3VyY2UvcmVuZGVyaW5nL0RvdC50cyIsIi9zb3VyY2UvcmVuZGVyaW5nL0Jhc2VMaW5rLnRzIiwiL3NvdXJjZS9yZW5kZXJpbmcvQ3VydmUudHMiLCIvc291cmNlL3JlbmRlcmluZy9TdHJhaWdodC50cyIsIi9zb3VyY2UvcmVuZGVyaW5nL0NyZWF0aW9uLnRzIiwiL3NvdXJjZS9Db21taXRWaWV3LnRzIiwiL3NvdXJjZS9Db21taXQudHMiLCIvc291cmNlL0JyYW5jaC50cyJdLCJuYW1lcyI6WyJpbmRleFRvWCIsImluZGV4IiwiQXN5bmNMb2FkaW5nSXRlbSIsIkFzeW5jTG9hZGluZ0l0ZW0uY29uc3RydWN0b3IiLCJBc3luY0xvYWRlciIsIkFzeW5jTG9hZGVyLmNvbnN0cnVjdG9yIiwiQXN5bmNMb2FkZXIudGhlbiIsIkFzeW5jTG9hZGVyLnRoZW5TaW5nbGUiLCJBc3luY0xvYWRlci5zdGFydCIsIkFzeW5jTG9hZGVyLm5leHQiLCJBc3luY0xvYWRlci5zdXNwZW5kIiwiQXN5bmNMb2FkZXIucmVzdW1lIiwiQXN5bmNMb2FkZXIuc2hvd1N0YXR1cyIsIkFzeW5jTG9hZGVyLmV4ZWN1dGUiLCJHaXRsaW5lQ29uZmlnIiwiR2l0bGluZUNvbmZpZy5jb25zdHJ1Y3RvciIsIkdpdGxpbmVDb25maWcuYXZhdGFyX2dyYXZhdGFyIiwiRXhwYW5kYWJsZSIsIkV4cGFuZGFibGUuZXh0ZW5kIiwiQ29tbWl0UHJvdmlkZXIiLCJDb21taXRQcm92aWRlci5jb25zdHJ1Y3RvciIsIkNvbW1pdFByb3ZpZGVyLndoZW5Eb25lIiwiQ29tbWl0UHJvdmlkZXIud2l0aENhbGxiYWNrIiwiQ29tbWl0UHJvdmlkZXIub25SZXF1ZXN0ZWQiLCJDb21taXRQcm92aWRlci5yZXF1ZXN0IiwiX19leHRlbmRzIiwidGhpcyIsImQiLCJiIiwiX18iLCJjb25zdHJ1Y3RvciIsInAiLCJoYXNPd25Qcm9wZXJ0eSIsInByb3RvdHlwZSIsIk9iamVjdCIsImNyZWF0ZSIsIkxvY2FsR2l0Mkpzb25Qcm92aWRlciIsIl9zdXBlciIsIkxvY2FsR2l0Mkpzb25Qcm92aWRlci5jb25zdHJ1Y3RvciIsIkxvY2FsR2l0Mkpzb25Qcm92aWRlci5vblJlcXVlc3RlZCIsIkdpdGxpbmUiLCJkaXNwbGF5RmF0YWxFcnJvciIsInVybCIsIkdpdGh1YkNvbW1pdFByb3ZpZGVyIiwiR2l0aHViQ29tbWl0UHJvdmlkZXIuY29uc3RydWN0b3IiLCJHaXRodWJDb21taXRQcm92aWRlci5naXRVUkwiLCJHaXRodWJDb21taXRQcm92aWRlci5vblJlcXVlc3RlZCIsIkdpdGh1YkNvbW1pdFByb3ZpZGVyLmxvYWRGb3JrcyIsIkdpdGh1YkNvbW1pdFByb3ZpZGVyLnByb2Nlc3NCcmFuY2hlcyIsIkdpdGh1YkNvbW1pdFByb3ZpZGVyLmxvYWRCcmFuY2hlcyIsIkdpdGh1YkNvbW1pdFByb3ZpZGVyLmxvYWRDb21taXRzIiwiR2l0aHViQ29tbWl0UHJvdmlkZXIucHJvY2Vzc0NvbW1pdHMiLCJHaXRodWJDb21taXRQcm92aWRlci5wcm9jZXNzIiwiR2l0aHViQ29tbWl0UHJvdmlkZXIuYXNzaWduSGVhZHMiLCJHaXRsaW5lLmNvbnN0cnVjdG9yIiwiR2l0bGluZS5hZGRDb21taXQiLCJHaXRsaW5lLmFkZEJyYW5jaCIsIkdpdGxpbmUucmVuZGVyIiwiR2l0bGluZS5nZXRIZWlnaHQiLCJHaXRsaW5lLmJ1aWxkR3JhcGgiLCJHaXRsaW5lLmRyYXdDb21taXQiLCJjb25zb2xlIiwiTG9nZ2VyIiwiZGVidWciLCJjb21taXQiLCJHaXRsaW5lLmRyYXdSZWZlcmVuY2VzIiwiR2l0bGluZS5kcmF3TGFiZWwiLCJHaXRsaW5lLmRyYXdJZGVudGl0eSIsIkdpdGxpbmUuaW5pdEJyYW5jaGVzIiwibEhlYWQiLCJzZWxmIiwiaGVhZHNNYXAiLCJsIiwickhlYWQiLCJyIiwiYnJhbmNoIiwiY2F0ZWdvcnkiLCJzcGVjaWZpdHkiLCJsZW5ndGgiLCJHaXRsaW5lLmZyb21KU09OIiwiR2l0bGluZS5mcm9tUHJvdmlkZXIiLCJHaXRsaW5lLnJlbmRlclRvIiwiR2l0bGluZS53aXRoSGVhZGVyIiwiR2l0bGluZS5kaXNwbGF5RmF0YWxFcnJvciIsIlNoYXBlIiwiU2hhcGUuY29uc3RydWN0b3IiLCJTaGFwZS5hZGRJZk1pc3NpbmciLCJTaGFwZS5hZGRFbGVtZW50cyIsIlNoYXBlLnVwZGF0ZSIsIlNoYXBlLmRlcGVuZHNPbiIsIkRvdCIsIkRvdC5jb25zdHJ1Y3RvciIsIkRvdC5zaXplIiwiRG90LmF0IiwiRG90LmNvbG9yIiwiRG90LnVwZGF0ZSIsIkJhc2VMaW5rIiwiQmFzZUxpbmsuY29uc3RydWN0b3IiLCJCYXNlTGluay5mcm9tIiwiQmFzZUxpbmsudG8iLCJCYXNlTGluay5jb2xvciIsIkN1cnZlIiwiQ3VydmUuY29uc3RydWN0b3IiLCJDdXJ2ZS5hZGRFbGVtZW50cyIsIkN1cnZlLnVwZGF0ZSIsIlN0cmFpZ2h0IiwiU3RyYWlnaHQuY29uc3RydWN0b3IiLCJTdHJhaWdodC51cGRhdGUiLCJDcmVhdGlvbiIsIkNyZWF0aW9uLmNvbnN0cnVjdG9yIiwiQ3JlYXRpb24uYWRkRWxlbWVudHMiLCJDcmVhdGlvbi51cGRhdGUiLCJDb21taXRWaWV3IiwiQ29tbWl0Vmlldy5jb25zdHJ1Y3RvciIsIkNvbW1pdFZpZXcuYWRkUmVsYXRpb25zIiwiQ29tbWl0Vmlldy5yZWRyYXciLCJJZGVudGl0eSIsIklkZW50aXR5LmNvbnN0cnVjdG9yIiwiQ29tbWl0IiwiQ29tbWl0LmNvbnN0cnVjdG9yIiwiQ29tbWl0LmdldFNob3J0U2hhIiwiQ29tbWl0LmdldEZ1bGxTaGEiLCJDb21taXQuaW5pdFJlbGF0aW9ucyIsIkNvbW1pdC5pbml0RGVmYXVsdEJyYW5jaCIsIkNvbW1pdC5pbml0SGVhZFNwZWNpZml0eSIsIkNvbW1pdC5pbml0TWVyZ2VzIiwiQ29tbWl0LmluaXRBbm9ueW1vdXMiLCJDb21taXQuZ2V0Q29sb3IiLCJDb21taXQuaGFzTWVyZ2VzIiwiQ29tbWl0LmdldFgiLCJDb21taXQuZ2V0WSIsIkNvbW1pdC5nZXRPcmlnaW5JbmRleFkiLCJDb21taXQuaW50ZXJzZWN0cyIsIkNvbW1pdC5nZXRJbmRleCIsIkNvbW1pdC5nZXRJbmRleFkiLCJDb21taXQud2FybiIsIkNvbW1pdC5kZWJ1ZyIsIkNvbW1pdC5nZXRMYW5lIiwiQnJhbmNoIiwiQnJhbmNoLmNvbnN0cnVjdG9yIl0sIm1hcHBpbmdzIjoiQUFRQSxRQUFBQSxVQUFrQkMsR0FDakJELE1BQWNBLElBQVBBLEVBQVlBLEdDUnBCLEdBQUFFLGtCQUFBLFdBT0NBLFFBQUFBLEdBQWFBLEVBQWVBLEVBQVdBLEVBQW9CQSxFQUFlQSxHQUN6RUMsS0FBS0EsTUFBUUEsRUFDYkEsS0FBS0EsS0FBT0EsRUFDWkEsS0FBS0EsU0FBV0EsRUFDaEJBLEtBQUtBLE1BQVFBLEVBQ2JBLEtBQUtBLEdBQUtBLEVBRVpELE1BQUFBLE1BRUFFLFlBQUEsV0FNQ0EsUUFBQUEsR0FBYUEsR0FITEMsS0FBQUEsU0FDQUEsS0FBQUEsV0FBcUJBLEVBRzVCQSxLQUFLQSxRQUFVQSxFQStEakJELE1BM0RRQSxHQUFBQSxVQUFBQSxLQUFQQSxTQUFZQSxFQUFlQSxFQUF3QkEsR0FBbkRFLEdBQUFBLEdBQUFBLElBUUNBLE9BUEFBLE1BQUtBLFdBQVdBLEVBQU9BLFdBR3RCQSxJQUFJQSxHQURBQSxHQUFjQSxJQUNWQSxFQUFJQSxFQUFLQSxPQUFPQSxFQUFHQSxHQUFJQSxFQUFHQSxJQUNqQ0EsRUFBS0EsTUFBTUEsUUFBUUEsR0FBSUEsa0JBQWlCQSxFQUFPQSxFQUFLQSxHQUFJQSxFQUFVQSxFQUFHQSxFQUFLQSxXQUdyRUEsTUFHREYsRUFBQUEsVUFBQUEsV0FBUEEsU0FBa0JBLEVBQWVBLEdBRWhDRyxNQURBQSxNQUFLQSxNQUFNQSxLQUFLQSxHQUFJQSxrQkFBaUJBLEVBQU9BLEtBQU1BLEVBQVVBLEVBQUdBLElBQ3hEQSxNQUdESCxFQUFBQSxVQUFBQSxNQUFQQSxTQUFhQSxHQUFBSSxTQUFBQSxJQUFBQSxHQUFBQSxHQUNUQSxJQUNGQSxLQUFLQSxRQUFRQSxRQUFTQSxHQUV2QkEsS0FBS0EsUUFHQ0osRUFBQUEsVUFBQUEsS0FBUEEsV0FBQUssR0FBQUEsR0FBQUEsS0FDS0EsRUFBNkJBLEtBQUtBLE1BQU1BLE9BQzVCQSxVQUFiQSxFQUVHQSxFQUFTQSxNQUFRQSxLQUFRQSxHQUM3QkEsS0FBS0EsV0FBV0EsR0FDYkEsT0FBT0EsV0FBV0EsV0FDTEEsT0FBT0EsTUFBTUEsYUFBYUEsRUFBU0EsTUFBT0EsS0FBS0EsRUFBU0EsTUFBTUEsSUFBSUEsRUFBU0EsR0FBR0EsS0FDOUVBLEVBQUtBLFFBQVFBLElBQ2RBLElBRUhBLEtBQUtBLFFBQVFBLEdBRzFCQSxLQUFLQSxRQUFRQSxRQUFTQSxHQUlqQkwsRUFBQUEsVUFBQUEsUUFBUEEsV0FDQ00sS0FBS0EsV0FBWUEsR0FHWE4sRUFBQUEsVUFBQUEsT0FBUEEsV0FDQ08sS0FBS0EsV0FBWUEsRUFDakJBLEtBQUtBLFFBRUNQLEVBQUFBLFVBQUFBLFdBQVBBLFNBQWtCQSxHQUNqQlEsS0FBS0EsUUFBUUEsVUFBWUEsRUFBS0EsT0FHeEJSLEVBQUFBLFVBQUFBLFFBQVBBLFNBQWVBLEdBQ2RTLEVBQUtBLFNBQVNBLEVBQUtBLE1BQ2ZBLEtBQUtBLFdBQ1JBLEtBQUtBLFFBR1JULEtEM0VBVSxjQUFBLFdBQUFBLFFBQUFBLEtBQ1FDLEtBQUFBLFVBQVlBLEVBQ1pBLEtBQUFBLFNBQVdBLEVBRVhBLEtBQUFBLFlBQXNCQSxFQU10QkEsS0FBQUEsU0FBd0JBLEtBQUtBLGlCQUNyQ0QsTUFMU0EsR0FBQUEsVUFBQUEsZ0JBQVJBLFNBQXlCQSxHQUN4QkUsTUFBT0Esa0NBQWtDQSxTQUFTQSxJQUFJQSxFQUFNQSxlQUFlQSxlQUk3RUYsS0VkQ0csV0FBQSxXQUFBQSxRQUFBQSxNQXlCQUEsTUF4QmVBLEdBQUFBLE9BQWRBLFNBQXFCQSxHQUNwQkMsR0FBSUEsR0FBMERBLENBcUIvREEsT0FwQkNBLEdBQVFBLFVBQVVBLElBQUlBLHNCQUV0QkEsRUFBU0EsU0FBV0EsU0FBQ0EsR0FDcEJBLEVBQVNBLFFBQVVBLFNBQUNBLEdBQ0FBLEdBQWhCQSxFQUFNQSxTQUNSQSxFQUFTQSxVQUFZQSxFQUNyQkEsRUFBTUEsY0FBZUEsRUFDckJBLEVBQVFBLFVBQVVBLElBQUlBLGtDQUt6QkEsRUFBU0EsVUFBYUEsU0FBQ0EsR0FDdEJBLEVBQVNBLFVBQVlBLEVBQ3BCQSxFQUFTQSxXQUFhQSxTQUFDQSxHQUN2QkEsRUFBU0EsVUFBWUEsRUFBV0EsSUFDaENBLEVBQVFBLFVBQVVBLE9BQU9BLGlDQUlyQkEsR0FFUkQsS0M5QkRFLGVBQUEsV0FJQ0EsUUFBQUEsR0FBYUEsR0FDWkMsS0FBS0EsSUFBTUEsRUFtQmJELE1BaEJRQSxHQUFBQSxVQUFBQSxTQUFQQSxTQUFnQkEsR0FDZkUsS0FBS0EsU0FBU0EsSUFHUkYsRUFBQUEsVUFBQUEsYUFBUEEsU0FBb0JBLEdBQ25CRyxLQUFLQSxTQUFXQSxHQUlWSCxFQUFBQSxVQUFBQSxZQUFQQSxTQUFtQkEsR0FDbEJJLEtBQU1BLElBQUlBLE9BQU1BLGtDQUFrQ0EsT0FHNUNKLEVBQUFBLFVBQUFBLFFBQVBBLFdBQ0NLLEtBQUtBLFlBQVlBLEtBQUtBLE1BRXhCTCxLQ3NISU0sVUFBYUMsTUFBUUEsS0FBS0QsV0FBYyxTQUFVRSxFQUFHQyxHQUVyRCxRQUFTQyxLQUFPSCxLQUFLSSxZQUFjSCxFQURuQyxJQUFLLEdBQUlJLEtBQUtILEdBQU9BLEVBQUVJLGVBQWVELEtBQUlKLEVBQUVJLEdBQUtILEVBQUVHLEdBRW5ESixHQUFFTSxVQUFrQixPQUFOTCxFQUFhTSxPQUFPQyxPQUFPUCxJQUFNQyxFQUFHSSxVQUFZTCxFQUFFSyxVQUFXLEdBQUlKLEtDN0luRk8sc0JBQUEsU0FBQUMsR0FBQUQsUUFBQUEsS0FBb0NFLEVBQUFBLE1BQUFBLEtBQUFBLFdBVXBDRixNQVZvQ0EsV0FBQUEsRUFBQUEsR0FFNUJBLEVBQUFBLFVBQUFBLFlBQVBBLFNBQW1CQSxHQUFuQkcsR0FBQUEsR0FBQUEsSUFFQ0EsUUFBT0EsUUFBUUEsS0FBU0EsU0FBQ0EsR0FDeEJBLEVBQUtBLFNBQVNBLEtBQ1pBLE1BQU1BLFdBQ1JDLFFBQVFDLGtCQUFrQiwrQkFBK0JDLEVBQUssZ0NBR2pFTixHQVZvQ2pCLGdCQ0RwQ3dCLHFCQUFBLFNBQUFOLEdBV0NNLFFBQUFBLEdBQWFBLEVBQWFBLEVBQWVBLEdBQ3hDQyxFQUFBQSxLQUFBQSxLQUFNQSxHQVZDQSxLQUFBQSxTQUVBQSxLQUFBQSxnQkFDQUEsS0FBQUEsUUFJQUEsS0FBQUEsTUFBZ0JBLEVBSXZCQSxLQUFLQSxZQUFjQSxFQUNuQkEsS0FBS0EsTUFBUUEsRUErSWZELE1BN0ptQ0EsV0FBQUEsRUFBQUEsR0FpQjNCQSxFQUFBQSxVQUFBQSxPQUFQQSxTQUFjQSxFQUFhQSxFQUFhQSxHQU92Q0UsTUFQdUNBLFVBQUFBLElBQUFBLEVBQUFBLElBR0hBLElBQWpDQSxFQUFJQSxRQUFRQSxvQkFDZEEsRUFBTUEsRUFBSUEsUUFBUUEsZUFBZ0JBLGlDQUFpQ0EsUUFBUUEsUUFBU0EsTUFHOUVBLEVBQU1BLElBQUlBLEVBQUlBLGlCQUFpQkEsS0FBS0EsWUFBWUEsYUFBYUEsS0FBS0EsTUFBTUEsZUFBZUEsR0FHeEZGLEVBQUFBLFVBQUFBLFlBQVBBLFNBQW1CQSxHQUNsQkcsS0FBS0EsVUFBVUEsSUFHVEgsRUFBQUEsVUFBQUEsVUFBUEEsU0FBaUJBLEdBQWpCSSxHQUFBQSxHQUFBQSxJQUNDQSxRQUFPQSxLQUNMQSxPQUFPQSxRQUFRQSxLQUFLQSxPQUFPQSxFQUFLQSxVQUNoQ0EsT0FBT0EsUUFBUUEsS0FBS0EsT0FBT0EsRUFBS0EsY0FDL0JBLEtBQU1BLFNBQUNBLEVBQU9BLEdBRWZBLEVBQUtBLGdCQUFnQkEsRUFBS0EsRUFBU0EsR0FBR0EsTUFDdENBLEVBQUtBLE1BQVFBLEVBQU1BLEdBQUdBLEtBRXRCQSxFQUFLQSxrQkFLREosRUFBQUEsVUFBQUEsZ0JBQVBBLFNBQXVCQSxFQUFNQSxHQUE3QkssR0FBQUEsR0FBQUEsSUFDQ0EsR0FBS0EsUUFBUUEsU0FBQUEsR0FDWkEsRUFBT0EsS0FBb0JBLFNBQWJBLEVBQUtBLElBQW9CQSxFQUFLQSxJQUFNQSxFQUM1QkEsU0FBbkJBLEVBQUtBLFlBQ1BBLEVBQU9BLEtBQU9BLEVBQU9BLEtBQU9BLElBQU1BLEVBQUtBLFdBRXhDQSxFQUFLQSxhQUFhQSxLQUFLQSxNQUlsQkwsRUFBQUEsVUFBQUEsYUFBUEEsV0FBQU0sR0FBQUEsR0FBQUEsS0FDS0EsRUFBZUEsS0FBS0EsTUFBTUEsSUFBSUEsU0FBQUEsR0FBU0EsTUFBT0EsUUFBT0EsUUFBUUEsRUFBS0EsT0FBT0EsRUFBS0EsSUFBS0EsWUFBYUEsU0FBQUEsR0FDbkdBLE9BQU9BLE1BQU1BLHVCQUF1QkEsRUFBS0EsTUFDekNBLEVBQUtBLGdCQUFnQkEsRUFBTUEsRUFBS0EsU0FFakNBLFFBQU9BLEtBQUtBLE1BQU1BLE9BQVFBLEdBQWNBLEtBQUtBLFdBQzVDQSxPQUFPQSxNQUFNQSx1QkFDYkEsRUFBS0EsaUJBSUFOLEVBQUFBLFVBQUFBLFlBQVBBLFdBQUFPLEdBQUFBLEdBQUFBLEtBQ0tBLElBQ0pBLE1BQUtBLGFBQWFBLFFBQVFBLFNBQUFBLEdBQ3pCQSxHQUFJQSxHQUFTQSxFQUFLQSxLQUFLQSxFQUFFQSxPQUFPQSxJQUNuQkEsU0FBVkEsR0FDRkEsRUFBZUEsS0FDZEEsT0FBT0EsUUFBUUEsRUFBS0EsT0FBT0EsRUFBRUEsS0FBTUEsVUFBV0EsT0FBT0EsRUFBRUEsT0FBT0EsS0FBTUEsU0FBQUEsR0FDbkVBLE9BQU9BLE1BQU1BLHNCQUFzQkEsRUFBRUEsTUFDckNBLEVBQUtBLGVBQWVBLEVBQUtBLFdBSzdCQSxPQUFPQSxLQUFLQSxNQUFNQSxPQUFRQSxHQUFnQkEsS0FBS0EsV0FDOUNBLEVBQUtBLGFBSUFQLEVBQUFBLFVBQUFBLGVBQVBBLFNBQXNCQSxHQUF0QlEsR0FBQUEsR0FBQUEsSUFDQ0EsR0FBS0EsSUFBSUEsU0FBQUEsR0FDUkEsR0FBSUEsS0FtQkpBLE9BbEJBQSxHQUFFQSxJQUFNQSxFQUFLQSxJQUNiQSxFQUFFQSxLQUFPQSxFQUFLQSxJQUFJQSxVQUFVQSxFQUFFQSxHQUM5QkEsRUFBRUEsYUFBd0JBLEVBQUtBLFFBQVNBLElBQUlBLFNBQUFBLEdBQU9BLE1BQU9BLEdBQUVBLE1BQzVEQSxFQUFFQSxXQUFhQSxFQUFLQSxPQUFPQSxPQUFPQSxLQUNsQ0EsRUFBRUEsWUFBY0EsRUFBS0EsT0FBT0EsT0FBT0EsTUFDbkNBLEVBQUVBLFdBQWFBLEVBQUtBLE9BQU9BLE9BQU9BLEtBQ2xDQSxFQUFFQSxnQkFBa0JBLEdBQUlBLE1BQUtBLEVBQUtBLE9BQU9BLE9BQU9BLE1BQU1BLFVBRXREQSxFQUFFQSxjQUFnQkEsRUFBS0EsT0FBT0EsVUFBVUEsS0FDeENBLEVBQUVBLGVBQWlCQSxFQUFLQSxPQUFPQSxVQUFVQSxNQUN6Q0EsRUFBRUEsY0FBZ0JBLEVBQUtBLE9BQU9BLFVBQVVBLEtBQ3hDQSxFQUFFQSxtQkFBcUJBLEdBQUlBLE1BQUtBLEVBQUtBLE9BQU9BLFVBQVVBLE1BQU1BLFVBRTVEQSxFQUFFQSxRQUFVQSxFQUFLQSxPQUFPQSxRQUN4QkEsRUFBRUEsS0FBT0EsR0FDVEEsRUFBRUEsWUFDRkEsRUFBRUEsV0FFS0EsSUFDTEEsUUFBUUEsU0FBQUEsR0FDVkEsRUFBS0EsS0FBS0EsRUFBT0EsS0FBT0EsS0FNbkJSLEVBQUFBLFVBQUFBLFFBQVBBLFdBQUFTLEdBQUFBLEdBQUFBLElBQ0NBLE1BQUtBLGFBQWFBLFFBQVFBLFNBQUFBLEdBQ3pCQSxHQUFJQSxHQUFTQSxFQUFLQSxLQUFLQSxFQUFFQSxPQUFPQSxJQUNuQkEsU0FBVkEsSUFHRkEsRUFBRUEsVUFBV0EsRUFDYkEsRUFBT0EsU0FBU0EsS0FBS0EsRUFBRUEsTUFDdkJBLEVBQUtBLFlBQVlBLEtBS25CQSxJQUFJQSxLQUNKQSxRQUFPQSxLQUFLQSxLQUFLQSxNQUFNQSxLQUFLQSxTQUFDQSxFQUFFQSxHQUM5QkEsTUFBT0EsR0FBS0EsS0FBS0EsR0FBR0EsbUJBQXFCQSxFQUFLQSxLQUFLQSxHQUFHQSxxQkFDcERBLFFBQVFBLFNBQUFBLEdBQ1ZBLEVBQVFBLEdBQU9BLEVBQUtBLEtBQUtBLEtBSTFCQSxLQUFLQSxTQUFTQSxJQUdQVCxFQUFBQSxVQUFBQSxZQUFSQSxTQUFvQkEsR0FBcEJVLEdBQUFBLEdBQUFBLElBR0NBLEtBRkFBLEVBQU9BLFNBQVdBLEVBQU9BLGFBQWFBLElBQUtBLFNBQUFBLEdBQU9BLE1BQU9BLEtBRW5EQSxFQUFPQSxTQUFTQSxPQUFTQSxHQUFHQSxDQUNqQ0EsR0FBSUEsS0FDSkEsR0FBT0EsU0FBU0EsUUFBU0EsU0FBQUEsR0FDeEJBLEdBQUlBLEdBQUlBLEVBQUtBLEtBQUtBLEVBQ1ZBLFNBQUxBLElBQ0ZBLEVBQUVBLFFBQVFBLEtBQUtBLEVBQU9BLEtBRXRCQSxFQUFFQSxhQUFhQSxRQUFRQSxTQUFBQSxHQUNPQSxLQUExQkEsRUFBV0EsUUFBUUEsSUFDckJBLEVBQVdBLEtBQUtBLFFBS3BCQSxFQUFPQSxTQUFXQSxJQUdyQlYsR0E3Sm1DeEIsZ0JDS25DcUIsUUFBQSxXQUFBQSxRQUFBQSxLQUVDYyxLQUFBQSxLQUFPQSxLQUNBQSxLQUFBQSxLQUFjQSxFQUNkQSxLQUFBQSxVQUFtQkEsRUFDbkJBLEtBQUFBLFdBTUFBLEtBQUFBLFlBS0FBLEtBQUFBLE9BQXdCQSxHQUFJQSxlQTZScENkLE1BblJRQSxHQUFBQSxVQUFBQSxVQUFQQSxTQUFpQkEsR0FDaEJlLEtBQUtBLFFBQVFBLEVBQU9BLGNBQWdCQSxFQUdaQSxTQUFyQkEsS0FBS0EsY0FDUEEsS0FBS0EsWUFBY0EsSUFJZGYsRUFBQUEsVUFBQUEsVUFBUEEsU0FBaUJBLEVBQWlCQSxFQUFnQkEsR0FDakRnQixHQUFJQSxHQUFTQSxHQUFJQSxRQUFPQSxFQUFTQSxFQUFRQSxFQUN6Q0EsTUFBS0EsU0FBU0EsR0FBV0EsR0FHbkJoQixFQUFBQSxVQUFBQSxPQUFQQSxXQUFBaUIsR0FBQUEsR0FBQUEsSUFDQ0EsTUFBS0EsT0FBU0EsR0FBSUEsTUFBS0EsTUFBTUEsS0FBS0EsZ0JBRWxDQSxLQUFLQSxHQUFHQSxXQUFXQSxlQUFnQkEsV0FDbENBLEVBQUtBLEdBQUdBLFVBQ1JBLEVBQUtBLGVBQWVBLGFBQWNBLFNBQUNBLEdBQ2xDQSxFQUFLQSxLQUFPQSxFQUNaQSxFQUFLQSxHQUFHQSxXQUVUQSxFQUFLQSxlQUFlQSxZQUNsQkEsS0FBS0Esa0JBQW1CQSxXQUFPQSxNQUFPQSxRQUFPQSxLQUFLQSxFQUFLQSxPQUFRQSxTQUFDQSxHQUNsRUEsR0FBSUEsR0FBU0EsR0FBSUEsUUFBT0EsRUFBTUEsRUFBS0EsS0FBS0EsR0FDeENBLEdBQUtBLFVBQVVBLEtBRWZBLFdBQVdBLGlCQUFrQkEsV0FDN0JBLEVBQUtBLGVBRUxBLEtBQUtBLGlCQUFrQkEsV0FBT0EsTUFBT0EsUUFBT0EsS0FBS0EsRUFBS0EsVUFBV0EsU0FBQ0EsR0FDbEVBLEdBQUlBLEdBQVNBLEVBQUtBLFFBQVFBLEVBQzFCQSxHQUFLQSxXQUFXQSxLQUVoQkEsV0FBV0Esa0JBQW1CQSxXQUM5QkEsRUFBS0EsVUFBWUEsU0FBU0EsY0FBY0EsT0FDeENBLEVBQUtBLFVBQVVBLFVBQVlBLGdCQUMzQkEsRUFBS0EsVUFBVUEsWUFBWUEsRUFBS0EsYUFFaENBLEtBQUtBLGlCQUFrQkEsV0FBT0EsTUFBT0EsUUFBT0EsS0FBS0EsRUFBS0EsVUFBV0EsU0FBQ0EsR0FDbEVBLEdBQUlBLEdBQVNBLEVBQUtBLFFBQVFBLEVBQzFCQSxHQUFLQSxlQUFlQSxLQUVwQkEsV0FBV0EsV0FBWUEsV0FDdkJBLEVBQUtBLGVBQWVBLE1BQU1BLE1BQVFBLFNBQVNBLEVBQUtBLEtBQU9BLEdBQUtBLEtBQzVEQSxFQUFLQSxlQUFlQSxNQUFNQSxPQUFTQSxFQUFLQSxZQUFjQSxPQUNwREEsUUFFSEEsT0FBT0EsU0FBV0EsU0FBQ0EsR0FFbEJBLEVBQUtBLEdBQUdBLEtBQUtBLFlBQWFBLFdBQU9BLE1BQU9BLFFBQU9BLEtBQUtBLEVBQUtBLFVBQVdBLFNBQUNBLEdBQ3BFQSxHQUFJQSxHQUFnQkEsRUFBS0EsUUFBUUEsRUFDakNBLEdBQU9BLEtBQUtBLFdBQ1ZBLFdBQVdBLFdBQVlBLFdBQ3pCQSxFQUFLQSxlQUFlQSxNQUFNQSxNQUFRQSxTQUFTQSxFQUFLQSxLQUFPQSxHQUFLQSxLQUM1REEsRUFBS0EsZUFBZUEsTUFBTUEsT0FBU0EsRUFBS0EsWUFBY0EsT0FDcERBLE9BQU1BLEtBSUpqQixFQUFBQSxVQUFBQSxVQUFQQSxXQUNDa0IsTUFBT0EsTUFBS0EsVUFBVUEsVUFBWUEsS0FBS0EsWUFBWUEsS0FBS0EsTUFBTUEsV0FHeERsQixFQUFBQSxVQUFBQSxXQUFQQSxXQUFBbUIsR0FBQUEsR0FBQUEsS0FDS0EsRUFBT0EsT0FBT0EsS0FBS0EsS0FBS0EsUUFDNUJBLEdBQUtBLFFBQVFBLFNBQUNBLEdBQ2JBLEdBQUlBLEdBQVNBLEVBQUtBLFFBQVFBLEVBQzFCQSxHQUFPQSxrQkFFUkEsRUFBS0EsUUFBUUEsU0FBQ0EsR0FDYkEsR0FBSUEsR0FBU0EsRUFBS0EsUUFBUUEsRUFFMUJBLEdBQU9BLG9CQUNQQSxFQUFPQSxlQUVSQSxLQUFLQSxnQkFHQ25CLEVBQUFBLFVBQUFBLFdBQVBBLFNBQWtCQSxHQUVqQm9CLEVBQU9BLEtBQU9BLEdBQUlBLFlBQVdBLEtBQUtBLE9BQVFBLEtBQUtBLE9BQVFBLEdBRXBEQSxFQUFPQSxjQUFlQSxJQUN4QkEsRUFBT0EsS0FBS0EsTUFBUUEsS0FBS0EsVUFBVUEsR0FFbkNBLEVBQU9BLEtBQUtBLE1BQU1BLFFBQVVBLFdBQ3hCQyxTQUNGQyxPQUFPQyxNQUFNQyxJQUlmSixLQUFLQSxVQUFVQSxZQUFZQSxFQUFPQSxLQUFLQSxPQUN2Q0EsRUFBT0EsS0FBS0EsTUFBTUEsTUFBTUEsZ0JBQWtCQSxTQUFTQSxLQUFLQSxLQUFPQSxHQUFHQSxPQUk3RHBCLEVBQUFBLFVBQUFBLGVBQVBBLFNBQXNCQSxHQUNyQnlCLEVBQU9BLEtBQUtBLGVBQ1pBLEVBQU9BLEtBQUtBLFVBR056QixFQUFBQSxVQUFBQSxVQUFQQSxTQUFpQkEsR0FDaEIwQixHQUFJQSxHQUFRQSxTQUFTQSxjQUFjQSxNQUNuQ0EsR0FBTUEsVUFBWUEsZUFHbEJBLElBQUlBLEdBQWtCQSxFQUFPQSxjQUN6QkEsRUFBaUJBLEVBQU9BLGFBQ3hCQSxFQUE0QkEsV0FBV0EsT0FBT0EsU0FBU0EsY0FBY0EsUUFlekVBLElBZEFBLEVBQUlBLFVBQVVBLEVBQVNBLEtBQ3ZCQSxFQUFJQSxTQUFTQSxHQUNiQSxFQUFJQSxNQUFNQSxXQUFhQSxVQUV2QkEsRUFBTUEsWUFBWUEsR0FHbEJBLEVBQU1BLFlBQVlBLEtBQUtBLGFBQWFBLFNBQVVBLEVBQU9BLFNBRWxEQSxFQUFPQSxPQUFPQSxPQUFTQSxFQUFPQSxVQUFVQSxPQUMxQ0EsRUFBTUEsWUFBWUEsS0FBS0EsYUFBYUEsWUFBYUEsRUFBT0EsWUFJdERBLEVBQU9BLFFBQVVBLEVBQU9BLE9BQU9BLFNBQVdBLElBQVdBLEVBQU9BLE9BQU9BLFVBQVdBLENBQ2hGQSxHQUFJQSxHQUFPQSxTQUFTQSxjQUFjQSxPQUNsQ0EsR0FBS0EsVUFBWUEsYUFDakJBLEVBQUtBLE1BQU1BLGdCQUFrQkEsRUFBT0EsU0FBU0EsSUFDN0NBLEVBQUtBLE1BQU1BLE1BQVFBLFFBQ25CQSxFQUFLQSxNQUFNQSxZQUFjQSxFQUFLQSxNQUFNQSxhQUFlQSxNQUNuREEsRUFBS0EsVUFBWUEsRUFBT0EsT0FBT0EsSUFFL0JBLEVBQU1BLFlBQVlBLEdBS25CQSxHQUFJQSxHQUFVQSxTQUFTQSxjQUFjQSxPQU1yQ0EsT0FMQUEsR0FBUUEsVUFBWUEsSUFBSUEsRUFBT0EsUUFDL0JBLEVBQVFBLE1BQU1BLE1BQVFBLEVBQU9BLFlBQWNBLE9BQVFBLFFBQ25EQSxFQUFNQSxZQUFZQSxHQUVsQkEsRUFBTUEsTUFBTUEsU0FBV0EsV0FDaEJBLEdBR0QxQixFQUFBQSxVQUFBQSxhQUFQQSxTQUFvQkEsRUFBY0EsR0FDakMyQixHQUFJQSxHQUE0QkEsV0FBV0EsT0FBT0EsU0FBU0EsY0FBY0Esb0JBQ3pFQSxHQUFHQSxhQUFhQSxRQUFTQSxHQUN6QkEsRUFBR0EsYUFBYUEsT0FBUUEsRUFBR0EsS0FDM0JBLElBQUlBLEdBQVdBLEVBQUdBLEtBQU9BLFFBQVFBLEVBQUdBLE1BQU1BLGNBQWNBLE1BTXhEQSxPQUxBQSxHQUFHQSxhQUFhQSxRQUFTQSxHQUV6QkEsRUFBR0EsTUFBTUEsV0FBYUEsS0FBS0EsT0FBT0EsUUFBUUEsSUFBSUEsU0FBQUEsR0FBTUEsTUFBT0EsT0FBT0EsRUFBRUEsRUFBR0EsT0FBT0EsZ0JBQWdCQSxLQUFLQSxNQUNuR0EsRUFBR0EsU0FBU0EsR0FDWkEsRUFBR0EsVUFBVUEsS0FDTkEsR0FNRDNCLEVBQUFBLFVBQUFBLGFBQVBBLFdBS0M0QixJQUFJQSxHQUhBQSxHQUFRQSxPQUFPQSxLQUFLQSxLQUFLQSxVQUdyQkEsRUFBR0EsRUFBR0EsRUFBR0EsRUFBTUEsT0FBUUEsSUFBS0EsQ0FDbkNBLEdBQUlBLEdBQVdBLEVBQU1BLEdBQ2pCQSxFQUFPQSxLQUFLQSxTQUFTQSxFQUN6QkEsR0FBS0EsT0FBT0Esb0JBSWJBLEdBQUlBLEdBQU9BLElBQ1hBLEdBQU1BLEtBQUtBLFNBQVNBLEVBQUdBLEdBQ3RCLEdBQUlDLEdBQWdCQyxFQUFLQyxTQUFTQyxHQUFHUixPQUNqQ1MsRUFBZ0JILEVBQUtDLFNBQVNHLEdBQUdWLE1BRXJDLE9BQUdLLEtBQVVJLEVBQ0wsRUFHTEosRUFBTU0sT0FBT0MsV0FBYUgsRUFBTUUsT0FBT0MsU0FDbENQLEVBQU1NLE9BQU9FLFVBQVlKLEVBQU1FLE9BQU9FLFVBRXRDUixFQUFNTSxPQUFPQyxTQUFTRSxPQUFTTCxFQUFNRSxPQUFPQyxTQUFTRSxRQVE5RFYsS0FBSUEsR0FEQUEsR0FBVUEsRUFDTkEsRUFBR0EsRUFBR0EsRUFBR0EsRUFBTUEsT0FBUUEsSUFBS0EsQ0FDbkNBLEdBQUlBLEdBQVdBLEVBQU1BLEdBQ2pCQSxFQUFPQSxLQUFLQSxTQUFTQSxHQUNyQkEsRUFBY0EsRUFBS0EsTUFFdkJBLElBQUdBLEVBQUlBLFNBQVdBLEVBQU1BLENBQ3ZCQSxFQUFLQSxLQUFPQSxFQUVaQSxHQUdBQSxLQUFJQSxHQUFJQSxHQUFFQSxFQUFHQSxFQUFHQSxFQUFNQSxPQUFRQSxJQUFLQSxDQUdsQ0EsSUFBSUEsR0FEQUEsSUFBdUJBLEVBQ25CQSxFQUFFQSxFQUFHQSxFQUFHQSxFQUFNQSxPQUFRQSxJQUFLQSxDQUNsQ0EsR0FBSUEsR0FBWUEsRUFBTUEsR0FDbEJBLEVBQXFCQSxLQUFLQSxTQUFTQSxHQUFXQSxRQUVoQ0EsU0FBZkEsR0FBNEJBLEVBQVdBLFFBQVVBLEdBQVFBLEVBQVdBLE9BQU9BLE9BQVNBLElBQU1BLEVBQUlBLFdBQVdBLElBQWVBLEVBQUlBLE9BQU9BLFVBQVlBLEVBQVdBLE9BQU9BLGFBQ25LQSxHQUFhQSxHQUtmQSxHQUFHQSxFQUFZQSxDQUVkQSxPQUFPQSxNQUFNQSxrQkFBa0JBLEVBQUlBLE9BQU9BLElBQUlBLE1BQU1BLEVBQVdBLE9BQU9BLEtBQ3RFQSxFQUFLQSxLQUFPQSxDQUNaQSxRQUlGQSxLQUFLQSxLQUFPQSxLQUFLQSxJQUFJQSxLQUFLQSxLQUFNQSxFQUFLQSxTQVFqQzVCLEVBQUFBLFVBQUFBLFNBQVBBLFNBQWdCQSxHQUNmdUMsTUFBT0EsTUFBS0EsYUFBYUEsR0FBSUEsdUJBQXNCQSxLQUc3Q3ZDLEVBQUFBLFVBQUFBLGFBQVBBLFNBQW9CQSxHQUVuQndDLE1BREFBLE1BQUtBLGVBQWlCQSxFQUNmQSxNQUdBeEMsRUFBQUEsVUFBQUEsU0FBUkEsU0FBaUJBLEdBV2hCeUMsTUFWd0JBLFVBQXJCQSxLQUFLQSxhQUNQQSxFQUFNQSxZQUFZQSxLQUFLQSxhQUV4QkEsRUFBTUEsWUFBWUEsS0FBS0EsYUFBZUEsU0FBU0EsY0FBY0EseUJBQzdEQSxFQUFNQSxZQUFZQSxLQUFLQSxhQUFlQSxTQUFTQSxjQUFjQSx5QkFDN0RBLEtBQUtBLGFBQWFBLFlBQVlBLEtBQUtBLGVBQWlCQSxTQUFTQSxjQUFjQSwyQkFDM0VBLEtBQUtBLGFBQWFBLFlBQVlBLEtBQUtBLFVBQVlBLFNBQVNBLGNBQWNBLHNCQUN0RUEsS0FBS0EsR0FBS0EsR0FBSUEsYUFBWUEsS0FBS0EsY0FFL0JBLEtBQUtBLFNBQ0VBLE1BTUR6QyxFQUFBQSxVQUFBQSxXQUFQQSxTQUFrQkEsR0FRakIwQyxNQVBxQkEsZ0JBQVhBLElBQ1RBLEtBQUtBLFlBQWNBLFNBQVNBLGNBQWNBLHVCQUMxQ0EsS0FBS0EsWUFBWUEsVUFBWUEsR0FFN0JBLEtBQUtBLFlBQWNBLEVBR2JBLE1BR00xQyxFQUFBQSxrQkFBZEEsU0FBZ0NBLEdBQy9CMkMsTUFBTUEsSUFFUjNDLEtDdFRBNEMsTUFBQSxXQUtDQSxRQUFBQSxHQUFtQkEsRUFBYUEsR0FEeEJDLEtBQUFBLGdCQUVQQSxLQUFLQSxPQUFTQSxFQUNkQSxLQUFLQSxRQUFVQSxFQXVCakJELE1BcEJRQSxHQUFBQSxVQUFBQSxhQUFQQSxXQUNxQkUsU0FBakJBLEtBQUtBLFNBQTRDQSxNQUFuQkEsS0FBS0EsYUFDckNBLEtBQUtBLGNBQ0xBLEtBQUtBLFdBQWFBLEtBQUtBLFNBSWxCRixFQUFBQSxVQUFBQSxZQUFQQSxXQUNDRyxLQUFLQSxPQUFPQSxXQUFXQSxLQUFLQSxVQUd0QkgsRUFBQUEsVUFBQUEsT0FBUEEsV0FDQ0ksS0FBS0EsYUFBYUEsUUFBUUEsU0FBQUEsR0FDekJBLEVBQUlBLFlBSUNKLEVBQUFBLFVBQUFBLFVBQVBBLFNBQWlCQSxHQUNoQkssRUFBR0EsYUFBYUEsS0FBS0EsT0FFdkJMLEtDNUJBTSxJQUFBLFNBQUFyRCxHQU9DcUQsUUFBQUEsR0FBWUEsR0FDWEMsRUFBQUEsS0FBQUEsS0FBTUEsRUFBUUEsRUFBT0EsbUJBc0N2QkQsTUE5Q2tCQSxXQUFBQSxFQUFBQSxHQVdWQSxFQUFBQSxVQUFBQSxLQUFQQSxTQUFZQSxFQUFlQSxHQVcxQkUsTUFWQUEsTUFBS0EsTUFBUUEsRUFDYkEsS0FBS0EsT0FBU0EsRUFFZEEsS0FBS0EsUUFBUUEsU0FBU0EsR0FDdEJBLEtBQUtBLFFBQVFBLFVBQVVBLEdBQ3ZCQSxLQUFLQSxRQUFRQSxXQUFXQSxFQUFPQSxHQUMvQkEsS0FBS0EsUUFBUUEsV0FBV0EsRUFBT0EsR0FFL0JBLEtBQUtBLFNBQ0xBLEtBQUtBLGVBQ0VBLE1BR0RGLEVBQUFBLFVBQUFBLEdBQVBBLFNBQVVBLEVBQVdBLEdBTXBCRyxNQUxBQSxNQUFLQSxFQUFJQSxFQUNUQSxLQUFLQSxFQUFJQSxFQUVUQSxLQUFLQSxTQUNMQSxLQUFLQSxlQUNFQSxNQUdESCxFQUFBQSxVQUFBQSxNQUFQQSxTQUFhQSxFQUFxQkEsR0FJakNJLE1BSEFBLE1BQUtBLFFBQVFBLFlBQVlBLFVBQVVBLEdBQ25DQSxLQUFLQSxRQUFRQSxZQUFZQSxTQUFTQSxHQUNsQ0EsS0FBS0EsUUFBUUEsVUFBVUEsU0FBU0EsR0FDekJBLE1BR0RKLEVBQUFBLFVBQUFBLE9BQVBBLFdBQ0NLLEtBQUtBLFFBQVFBLGNBQWNBLEtBQUtBLEVBQUlBLEtBQUtBLE1BQVFBLEVBQUdBLEtBQUtBLEVBQUlBLEtBQUtBLE9BQVNBLEdBQzNFQSxFQUFBQSxVQUFNQSxPQUFNQSxLQUFBQSxPQUdkTCxHQTlDa0JOLE9DQ2xCWSxTQUFBLFNBQUEzRCxHQU9DMkQsUUFBQUEsR0FBWUEsRUFBYUEsR0FDeEJDLEVBQUFBLEtBQUFBLEtBQU1BLEVBQVFBLEdBc0JoQkQsTUE5QnVCQSxXQUFBQSxFQUFBQSxHQVdmQSxFQUFBQSxVQUFBQSxLQUFQQSxTQUFZQSxHQUdYRSxNQUZBQSxNQUFLQSxVQUFVQSxHQUNmQSxLQUFLQSxVQUFZQSxFQUNWQSxNQUdERixFQUFBQSxVQUFBQSxHQUFQQSxTQUFVQSxHQUdURyxNQURBQSxNQUFLQSxTQUFXQSxFQUNUQSxNQUdESCxFQUFBQSxVQUFBQSxNQUFQQSxTQUFhQSxHQUtaSSxNQUpBQSxNQUFLQSxRQUFRQSxZQUFZQSxVQUFVQSxHQUNuQ0EsS0FBS0EsUUFBUUEsWUFBWUEsU0FBU0EsR0FDbENBLEtBQUtBLFVBQVlBLEVBQ2pCQSxLQUFLQSxlQUNFQSxNQUVUSixHQTlCdUJaLE9DQXZCaUIsTUFBQSxTQUFBaEUsR0FJQ2dFLFFBQUFBLEdBQVlBLEdBQ1hDLEVBQUFBLEtBQUFBLEtBQU1BLEVBQVFBLEVBQU9BLGVBQ3JCQSxLQUFLQSxNQUFRQSxLQUFLQSxPQUFPQSxnQkE2QzNCRCxNQW5Eb0JBLFdBQUFBLEVBQUFBLEdBU1pBLEVBQUFBLFVBQUFBLFlBQVBBLFdBQ0NFLEVBQUFBLFVBQU1BLFlBQVdBLEtBQUFBLE1BR2pCQSxLQUFLQSxPQUFPQSxXQUFXQSxLQUFLQSxRQUd0QkYsRUFBQUEsVUFBQUEsT0FBUEEsV0FDQ0csR0FBSUEsR0FBWUEsS0FBS0EsU0FBU0EsRUFDMUJBLEVBQVlBLEtBQUtBLFNBQVNBLEVBQzFCQSxFQUFrQkEsS0FBS0EsVUFBVUEsRUFDakNBLEVBQWtCQSxLQUFLQSxVQUFVQSxFQUNqQ0EsRUFBZ0JBLEtBQUtBLFVBRXJCQSxFQUFnQkEsRUFBSkEsRUFBY0EsRUFBSUEsRUFFbENBLE1BQUtBLFFBQVFBLGdCQUFnQkEsRUFBU0EsRUFBVUEsS0FBS0EsVUFBVUEsT0FBU0EsR0FDeEVBLEtBQUtBLFFBQVFBLGNBQWNBLEVBQUVBLEtBQUtBLFNBQVNBLE1BQVFBLEVBQUVBLEVBQVdBLEdBQ2hFQSxLQUFLQSxRQUFRQSxtQkFBbUJBLEVBQVNBLEdBQ3pDQSxLQUFLQSxRQUFRQSxtQkFBbUJBLEVBQVNBLEdBRXpDQSxLQUFLQSxRQUFRQSxZQUFZQSxVQUFVQSxHQUNuQ0EsS0FBS0EsUUFBUUEsWUFBWUEsU0FBU0EsR0FHbENBLEtBQUtBLE1BQU1BLFlBQVlBLFVBQVVBLEdBQ2pDQSxLQUFLQSxNQUFNQSxVQUFVQSxTQUFTQSxHQUU5QkEsS0FBS0EsTUFBTUEsY0FDWEEsS0FBS0EsTUFBTUEsV0FBV0EsRUFBRUEsR0FDeEJBLEtBQUtBLE1BQU1BLFdBQVdBLEVBQUVBLElBQ3hCQSxLQUFLQSxNQUFNQSxXQUFXQSxFQUFFQSxFQUd4QkEsS0FBSUEsR0FBSUEsR0FBRUEsRUFBRUEsRUFBRUEsS0FBS0EsTUFBTUEsaUJBQWtCQSxJQUFLQSxDQUMvQ0EsR0FBSUEsR0FBS0EsS0FBS0EsTUFBTUEsV0FBV0EsR0FBR0EsRUFDOUJBLEVBQUtBLEtBQUtBLE1BQU1BLFdBQVdBLEdBQUdBLENBRWxDQSxNQUFLQSxNQUFNQSxhQUFhQSxFQUFHQSxFQUFZQSxFQUFJQSxLQUFLQSxTQUFTQSxNQUFRQSxFQUFFQSxFQUFXQSxFQUFLQSxFQUFHQSxLQUl6RkgsR0FuRG9CTCxVQ0RwQlMsU0FBQSxTQUFBcEUsR0FFQ29FLFFBQUFBLEdBQVlBLEdBQ1hDLEVBQUFBLEtBQUFBLEtBQU1BLEVBQVFBLEVBQU9BLGNBU3ZCRCxNQVp1QkEsV0FBQUEsRUFBQUEsR0FNZkEsRUFBQUEsVUFBQUEsT0FBUEEsV0FDQ0UsRUFBQUEsVUFBTUEsT0FBTUEsS0FBQUEsTUFDWkEsS0FBS0EsUUFBUUEsZ0JBQWdCQSxLQUFLQSxVQUFVQSxFQUFHQSxLQUFLQSxVQUFVQSxFQUFJQSxLQUFLQSxVQUFVQSxPQUFTQSxHQUMxRkEsS0FBS0EsUUFBUUEsY0FBY0EsS0FBS0EsU0FBU0EsRUFBR0EsS0FBS0EsU0FBU0EsRUFBSUEsS0FBS0EsU0FBU0EsT0FBU0EsSUFHdkZGLEdBWnVCVCxVQ0d2QlksU0FBQSxTQUFBdkUsR0FJQ3VFLFFBQUFBLEdBQVlBLEdBQ1hDLEVBQUFBLEtBQUFBLEtBQU1BLEVBQVFBLEVBQU9BLGNBQ3JCQSxLQUFLQSxXQUFhQSxFQUFPQSxhQStCM0JELE1BckN1QkEsV0FBQUEsRUFBQUEsR0FTZkEsRUFBQUEsVUFBQUEsWUFBUEEsV0FDQ0UsRUFBQUEsVUFBTUEsWUFBV0EsS0FBQUEsTUFHakJBLEtBQUtBLE9BQU9BLFdBQVdBLEtBQUtBLGFBR3RCRixFQUFBQSxVQUFBQSxPQUFQQSxXQUNDRyxFQUFBQSxVQUFNQSxPQUFNQSxLQUFBQSxNQUdUQSxLQUFLQSxVQUFVQSxFQUFJQSxLQUFLQSxTQUFTQSxFQUNuQ0EsS0FBS0EsUUFBUUEsZ0JBQWdCQSxLQUFLQSxVQUFVQSxFQUFJQSxLQUFLQSxVQUFVQSxNQUFRQSxFQUFHQSxLQUFLQSxVQUFVQSxHQUV6RkEsS0FBS0EsUUFBUUEsZ0JBQWdCQSxLQUFLQSxVQUFVQSxFQUFJQSxLQUFLQSxVQUFVQSxNQUFRQSxFQUFHQSxLQUFLQSxVQUFVQSxHQUcxRkEsS0FBS0EsUUFBUUEsY0FBY0EsS0FBS0EsU0FBU0EsRUFBR0EsS0FBS0EsVUFBVUEsR0FDM0RBLEtBQUtBLFFBQVFBLFlBQVlBLFVBQVVBLEdBQ25DQSxLQUFLQSxRQUFRQSxZQUFZQSxhQUFhQSxLQUFLQSxXQUFXQSxNQUN0REEsS0FBS0EsUUFBUUEsWUFBWUEsU0FBU0EsS0FBS0EsV0FHdkNBLEtBQUtBLFdBQVdBLGdCQUFnQkEsS0FBS0EsU0FBU0EsRUFBR0EsS0FBS0EsVUFBVUEsR0FDaEVBLEtBQUtBLFdBQVdBLGNBQWNBLEtBQUtBLFNBQVNBLEVBQUdBLEtBQUtBLFNBQVNBLEVBQUlBLEtBQUtBLFNBQVNBLE9BQVNBLEdBQ3hGQSxLQUFLQSxXQUFXQSxZQUFZQSxVQUFVQSxHQUN0Q0EsS0FBS0EsV0FBV0EsWUFBWUEsU0FBU0EsS0FBS0EsWUFFNUNILEdBckN1QlosVUNFdEJnQixXQUFBLFdBVUNBLFFBQUFBLEdBQVlBLEVBQVFBLEVBQXVCQSxHQUZwQ0MsS0FBQUEsU0FHTkEsS0FBS0EsT0FBU0EsRUFDZEEsS0FBS0EsT0FBU0EsRUFDZEEsS0FBS0EsT0FBU0EsRUFFZEEsS0FBS0EsSUFBTUEsR0FBSUEsS0FBSUEsS0FBS0EsUUF1QzFCRCxNQXBDT0EsR0FBQUEsVUFBQUEsYUFBUEEsV0FBQUUsR0FBQUEsR0FBQUEsSUFHQ0EsSUFBK0JBLE1BQTVCQSxLQUFLQSxPQUFPQSxhQUFzQkEsQ0FDcENBLEdBQUlBLEVBR0hBLEdBRkVBLEtBQUtBLE9BQU9BLFdBQWFBLEtBQUtBLE9BQU9BLGFBQWFBLFdBQWFBLEtBQUtBLE9BQU9BLGFBQWFBLFdBRXBGQSxHQUFJQSxVQUFTQSxLQUFLQSxRQUFRQSxLQUFLQSxLQUFLQSxPQUFPQSxhQUFhQSxLQUFLQSxLQUFLQSxHQUFHQSxLQUFLQSxLQUFLQSxNQUFNQSxLQUFLQSxPQUFPQSxTQUFTQSxLQUcxR0EsR0FBSUEsVUFBU0EsS0FBS0EsUUFBUUEsS0FBS0EsS0FBS0EsT0FBT0EsYUFBYUEsS0FBS0EsS0FBS0EsR0FBR0EsS0FBS0EsS0FBS0EsTUFBTUEsS0FBS0EsT0FBT0EsU0FBU0EsS0FHakhBLEtBQUtBLE1BQU1BLEtBQUtBLEdBR2pCQSxHQUFJQSxHQUFZQSxLQUFLQSxPQUFPQSxPQUFPQSxTQUFTQSxPQUFPQSxLQUFLQSxPQUFPQSxPQUFPQSxVQUN0RUEsR0FBVUEsUUFBUUEsU0FBQUEsR0FDakJBLEVBQUtBLE1BQU1BLEtBQ1ZBLEdBQUlBLE9BQU1BLEVBQUtBLFFBQ2RBLEtBQUtBLEVBQU1BLE9BQU9BLEtBQUtBLEtBQ3ZCQSxHQUFHQSxFQUFLQSxLQUNSQSxNQUFNQSxFQUFNQSxPQUFPQSxTQUFTQSxTQU14QkYsRUFBQUEsVUFBQUEsT0FBUEEsV0FDQ0csS0FBS0EsSUFDSEEsR0FBR0EsS0FBS0EsT0FBT0EsT0FBUUEsS0FBS0EsT0FBT0EsUUFDbkNBLEtBQUtBLEtBQUtBLE9BQU9BLFNBQVVBLEtBQUtBLE9BQU9BLFdBQ3ZDQSxNQUFNQSxLQUFLQSxPQUFPQSxTQUFTQSxJQUFLQSxLQUFLQSxPQUFPQSxTQUFTQSxNQUl6REgsS0MzRERJLFNBQUEsV0FHQ0EsUUFBQUEsR0FBMkJBLEVBQXFCQSxFQUFzQkEsR0FBM0NDLEtBQUFBLEtBQUFBLEVBQXFCQSxLQUFBQSxNQUFBQSxFQUFzQkEsS0FBQUEsS0FBQUEsRUFFdkVELE1BQUFBLE1BRUFFLE9BQUEsV0EwQkNBLFFBQUFBLEdBQVlBLEVBQW9CQSxHQXZCeEJDLEtBQUFBLFlBQ0FBLEtBQUFBLGNBQ0FBLEtBQUFBLFdBQ0FBLEtBQUFBLFVBQ0FBLEtBQUFBLFlBQ0RBLEtBQUFBLFlBQXNCQSxFQUN0QkEsS0FBQUEsUUFBV0EsWUFBY0EsY0FrQi9CQSxLQUFLQSxVQUFZQSxFQUNqQkEsS0FBS0EsS0FBT0EsRUFHWkEsS0FBS0EsS0FBS0EsSUFBTUEsS0FFR0EsTUFBaEJBLEVBQUtBLFVBQWlCQSxFQUFLQSxZQUNOQSxNQUFyQkEsRUFBS0EsZUFBc0JBLEVBQUtBLGlCQUNmQSxNQUFqQkEsRUFBS0EsV0FBa0JBLEVBQUtBLGFBRS9CQSxLQUFLQSxJQUFNQSxFQUFLQSxJQUNoQkEsS0FBS0EsS0FBT0EsRUFBS0EsS0FDakJBLEtBQUtBLFFBQVVBLEVBQUtBLFFBQ3BCQSxLQUFLQSxPQUFTQSxFQUFVQSxZQUV4QkEsS0FBS0EsVUFBWUEsR0FBSUEsVUFBU0EsS0FBS0EsS0FBS0EsY0FBZUEsS0FBS0EsS0FBS0EsZUFBZ0JBLEdBQUlBLE1BQUtBLEtBQUtBLEtBQUtBLGVBQWVBLFdBQ25IQSxLQUFLQSxPQUFTQSxHQUFJQSxVQUFTQSxLQUFLQSxLQUFLQSxXQUFZQSxLQUFLQSxLQUFLQSxZQUFhQSxHQUFJQSxNQUFLQSxLQUFLQSxLQUFLQSxZQUFZQSxXQTJPekdELE1BeE9RQSxHQUFBQSxVQUFBQSxZQUFQQSxXQUNDRSxNQUFPQSxNQUFLQSxNQUdORixFQUFBQSxVQUFBQSxXQUFQQSxXQUNDRyxNQUFPQSxNQUFLQSxLQUdOSCxFQUFBQSxVQUFBQSxjQUFQQSxXQUFBSSxHQUFBQSxHQUFBQSxLQUNLQSxFQUFPQSxJQUVYQSxNQUFLQSxLQUFLQSxhQUFhQSxRQUFTQSxTQUFBQSxHQUMvQkEsR0FBSUEsR0FBZUEsRUFBS0EsVUFBVUEsUUFBUUEsRUFhMUNBLElBVm1CQSxNQUFoQkEsSUFDRkEsRUFBZUEsR0FBSUEsR0FBT0EsRUFBS0EsV0FBYUEsSUFBS0EsRUFBS0EsS0FBS0EsV0FDM0RBLEVBQWFBLFlBQWFBLEVBQzFCQSxFQUFLQSxVQUFVQSxVQUFVQSxJQUcxQkEsRUFBS0EsUUFBUUEsS0FBS0EsR0FDbEJBLEVBQWFBLE9BQU9BLEtBQUtBLEdBQ3pCQSxFQUFLQSxTQUFXQSxFQUFhQSxPQUUxQkEsRUFBS0EsUUFBUUEsT0FBU0EsRUFBR0EsQ0FDM0JBLEdBQUlBLEdBQUtBLEVBQUtBLFFBQVFBLEVBQ3RCQSxHQUFLQSxhQUFlQSxFQUNwQkEsRUFBR0EsWUFBY0EsS0FJbkJBLEtBQUtBLEtBQUtBLFFBQVFBLFFBQVFBLFNBQUFBLEdBQ3pCQSxHQUFJQSxHQUFTQSxFQUFLQSxVQUFVQSxRQUFRQSxFQUNHQSxVQUFwQ0EsRUFBS0EsV0FBV0EsUUFBUUEsSUFDMUJBLEVBQUtBLFdBQVdBLEtBQUtBLE1BTWpCSixFQUFBQSxVQUFBQSxrQkFBUEEsV0FHQ0ssSUFGQUEsR0FBSUEsR0FBaUJBLEtBRUxBLE1BQVZBLElBR2VBLE1BQWpCQSxFQUFPQSxRQUFrQkEsRUFBT0EsT0FBT0EsVUFBWUEsS0FBS0EsT0FBT0EsYUFDakVBLEVBQU9BLE9BQVNBLEtBQUtBLFFBR3RCQSxFQUFPQSxPQUFPQSxNQUFRQSxFQUN0QkEsRUFBT0EsT0FBT0EsT0FBU0EsRUFBT0EsYUFDOUJBLEVBQVNBLEVBQU9BLGNBR1hMLEVBQUFBLFVBQUFBLGtCQUFQQSxXQUNDTSxJQUFLQSxHQUFJQSxHQUFFQSxFQUFHQSxFQUFFQSxLQUFLQSxLQUFLQSxTQUFTQSxPQUFRQSxJQUFLQSxDQUMvQ0EsR0FBSUEsR0FBVUEsS0FBS0EsS0FBS0EsU0FBU0EsRUFFakNBLEtBQUlBLEtBQUtBLFVBQVVBLE9BQU9BLFlBQTRDQSxHQUE5QkEsRUFBUUEsUUFBUUEsV0FBaUJBLENBRXJFQSxLQUFLQSxVQUFVQSxPQUFPQSxhQUN4QkEsRUFBVUEsRUFBUUEsUUFBUUEsV0FBWUEsSUFHdkNBLElBQUlBLEdBQWtEQSxJQUF0Q0EsRUFBUUEsUUFBUUEsVUFBV0EsSUFBSUEsTUFDL0NBLElBQWFBLEVBQVFBLFFBQVFBLGdCQUFpQkEsSUFBSUEsT0FFbERBLEtBQUtBLFVBQVVBLFVBQVVBLEVBQVNBLEtBQU1BLElBR2ZBLE1BQXJCQSxLQUFLQSxjQUF3QkEsRUFBWUEsS0FBS0EsZ0JBQ2pEQSxPQUFPQSxNQUFNQSxtQkFBb0JBLEVBQVNBLEtBQUtBLElBQUtBLEtBQUtBLGFBQWNBLEdBQ3ZFQSxLQUFLQSxhQUFlQSxFQUNwQkEsS0FBS0EsT0FBU0EsS0FBS0EsVUFBVUEsU0FBU0EsSUFHdkNBLEtBQUtBLHVCQUtETixFQUFBQSxVQUFBQSxXQUFQQSxXQU9DTyxHQUxBQSxLQUFLQSxRQUFXQSxZQUFjQSxjQUM5QkEsS0FBS0EsWUFJcUJBLEdBQXZCQSxLQUFLQSxRQUFRQSxPQUFhQSxDQUM1QkEsR0FBSUEsR0FBS0EsS0FBS0EsUUFBUUEsRUFDdEJBLE1BQUtBLGFBQWVBLEVBQ3BCQSxFQUFHQSxZQUFjQSxLQUdsQkEsR0FBR0EsS0FBS0EsUUFBUUEsUUFBVUEsRUFBR0EsQ0FDNUJBLEdBQUlBLEdBQUtBLEtBQUtBLFFBQVFBLEVBQ3RCQSxNQUFLQSxhQUFlQSxFQUNwQkEsRUFBR0EsWUFBY0EsSUFFakJBLEtBQUlBLEdBQUlBLEdBQUlBLEVBQUlBLEVBQUVBLEtBQUtBLFFBQVFBLE9BQVNBLElBQUtBLENBQzdDQSxHQUFJQSxHQUFLQSxLQUFLQSxRQUFRQSxFQUVaQSxPQUFOQSxJQUdDQSxFQUFHQSxLQUFLQSxTQUFTQSxPQUFTQSxHQUN6QkEsRUFBR0EsV0FBV0EsUUFBVUEsRUFBR0EsV0FBV0EsT0FHekNBLEtBQUtBLE9BQU9BLFNBQVNBLE1BQU1BLE9BQVFBLEtBR25DQSxLQUFLQSxPQUFPQSxVQUFVQSxNQUFNQSxPQUFRQSxJQUNwQ0EsS0FBS0EscUJBT0hQLEVBQUFBLFVBQUFBLGNBQVBBLFdBQUFRLEdBQUFBLEdBQUFBLElBS0NBLE1BQUtBLE9BQU9BLFVBQVVBLFFBQVFBLFNBQUFBLEdBSTdCQSxJQUhBQSxHQUFJQSxHQUFnQkEsRUFBT0EsT0FDdkJBLEVBQVFBLEVBRUdBLE1BQVRBLEdBQWlDQSxNQUFoQkEsRUFBTUEsUUFDNUJBLEVBQVFBLEVBQU1BLFdBS0hBLE9BQVRBLEdBQWlDQSxNQUFoQkEsRUFBTUEsU0FDekJBLEVBQU1BLE9BQVNBLEdBQUlBLFFBQU9BLEVBQU1BLE9BQU9BLElBQUlBLGFBQWFBLEVBQU1BLElBQUlBLEtBQUtBLFNBQVVBLEVBQU9BLEVBQU1BLE9BQU9BLFVBQVVBLEdBQy9HQSxFQUFNQSxPQUFPQSxXQUFZQSxFQUN6QkEsRUFBTUEsT0FBT0EsT0FBU0EsRUFBTUEsT0FDNUJBLEVBQU1BLE9BQU9BLE1BQU9BLEVBQ3BCQSxFQUFNQSxPQUFPQSxTQUFXQSxFQUFNQSxPQUFPQSxTQUVyQ0EsRUFBS0EsVUFBVUEsU0FBU0EsRUFBTUEsT0FBT0EsS0FBT0EsRUFBTUEsV0FNOUNSLEVBQUFBLFVBQUFBLFNBQVBBLFNBQWdCQSxHQUNmUyxHQUFrQkEsTUFBZkEsS0FBS0EsT0FFREEsQ0FDTkEsR0FBSUEsR0FBSUEsS0FBS0EsTUFDVkEsTUFBS0EsT0FBT0EsWUFDZEEsRUFBSUEsS0FBS0EsT0FBT0EsT0FHakJBLElBQUlBLEdBQWVBLElBQVRBLEVBQUVBLEtBQVdBLEtBQUtBLFVBQVVBLElBQ3RDQSxPQUFPQSxPQUFPQSxFQUFJQSxXQUFXQSxFQUFVQSxLQVJ2Q0EsS0FBS0EsS0FBS0Esa0JBWUxULEVBQUFBLFVBQUFBLFVBQVBBLFdBQ0NVLE1BQU9BLE1BQUtBLE9BQU9BLFNBQVNBLE9BQVNBLEdBQUtBLEtBQUtBLE9BQU9BLFVBQVVBLE9BQVNBLEdBR25FVixFQUFBQSxVQUFBQSxLQUFQQSxXQUNDVyxNQUFPQSxVQUFTQSxLQUFLQSxZQUdmWCxFQUFBQSxVQUFBQSxLQUFQQSxXQUNDWSxNQUFHQSxNQUFLQSxXQUNBQSxLQUFLQSxVQUFVQSxVQUFVQSxVQUFZQSxHQUV0Q0EsS0FBS0EsS0FBS0EsTUFBTUEsVUFBWUEsS0FBS0EsVUFBVUEsWUFBWUEsS0FBS0EsTUFBTUEsVUFBWUEsS0FBS0EsS0FBS0EsTUFBTUEsYUFBY0EsR0FHN0daLEVBQUFBLFVBQUFBLGdCQUFQQSxXQUNDYSxNQUF5QkEsU0FBdEJBLEtBQUtBLE9BQU9BLE9BQ1BBLEtBQUtBLE9BQU9BLE9BQU9BLFlBQ2pCQSxLQUFLQSxPQUFPQSxNQUFNQSxXQUNwQkEsS0FBS0EsVUFBVUEsVUFFZkEsS0FBS0EsT0FBT0EsTUFBTUEsUUFJcEJiLEVBQUFBLFVBQUFBLFdBQVBBLFNBQWtCQSxHQUNqQmMsR0FBSUEsR0FBT0EsUUFBU0EsRUFBTUEsTUFDMUJBLE9BQUdBLE1BQUtBLFlBQWNBLEVBQU1BLFlBQW1CQSxHQUV2QkEsTUFBckJBLEVBQU1BLGNBQ1JBLEVBQVNBLEVBQU1BLFlBQVlBLFFBR0xBLE1BQXBCQSxLQUFLQSxjQUNQQSxFQUFRQSxLQUFLQSxZQUFZQSxRQUduQkEsS0FBS0EsbUJBQXFCQSxLQUFLQSxJQUFJQSxFQUFNQSxPQUFRQSxJQUFXQSxLQUFLQSxJQUFJQSxFQUFPQSxLQUFLQSxTQUFXQSxFQUFNQSxvQkFHbkdkLEVBQUFBLFVBQUFBLFNBQVBBLFdBQ0NlLE1BQU9BLE1BQUtBLEtBQUtBLE9BR1hmLEVBQUFBLFVBQUFBLFVBQVBBLFdBQ0NnQixNQUFPQSxNQUFLQSxRQUdOaEIsRUFBQUEsVUFBQUEsS0FBUEEsU0FBWUEsR0FDWGlCLEtBQUtBLFNBQVNBLEtBQUtBLEdBQ25CQSxLQUFLQSxNQUFNQSxJQUdMakIsRUFBQUEsVUFBQUEsTUFBUEEsU0FBYUEsR0FDVGtCLFNBQ0ZBLE9BQU9BLE1BQU1BLEVBQVNBLE9BSWpCbEIsRUFBQUEsVUFBQUEsUUFBUEEsV0FDQ21CLE1BQWtCQSxPQUFmQSxLQUFLQSxPQUNBQSxLQUFLQSxPQUFPQSxPQUFPQSxPQUFPQSxLQUUzQkEsTUFLVG5CLEtDaFNBb0IsT0FBQSxXQWFDQSxRQUFBQSxHQUFZQSxFQUFpQkEsRUFBZ0JBLEdBQzVDQyxLQUFLQSxJQUFNQSxFQUNYQSxLQUFLQSxPQUFTQSxFQUNkQSxLQUFLQSxVQUFZQSxFQUNqQkEsS0FBS0EsVUFBWUEsRUFBUUEsTUFBTUEsS0FBS0EsR0FDcENBLEtBQUtBLFNBQVdBLEtBQUtBLFVBQVVBLFVBQVVBLEVBQUdBLEtBQUtBLFVBQVVBLFlBQVlBLE1BRXpFRCxNQUFBQSIsImZpbGUiOiJnaXRsaW5lLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJCcmFuY2gudHNcIi8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiQ29tbWl0LnRzXCIvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIkdpdGxpbmUudHNcIi8+XG4vKiBnbG9iYWxzICovXG5kZWNsYXJlIHZhciBqc2dsOiBhbnk7XG5kZWNsYXJlIHZhciBDcnlwdG9KUzogYW55O1xuZGVjbGFyZSB2YXIgTG9nZ2VyOiBhbnk7XG5cbmZ1bmN0aW9uIGluZGV4VG9YKGluZGV4KSB7XG5cdHJldHVybiBpbmRleCAqMjAgKyAxMjtcbn1cblxuY2xhc3MgR2l0bGluZUNvbmZpZyB7XG5cdHB1YmxpYyBkb3RIZWlnaHQgPSA2O1xuXHRwdWJsaWMgZG90V2lkdGggPSA4O1xuXG5cdHB1YmxpYyByZW1vdGVPbmx5OiBib29sZWFuID0gZmFsc2U7XG5cblx0cHJpdmF0ZSBhdmF0YXJfZ3JhdmF0YXIgKGVtYWlsKSB7XG5cdFx0cmV0dXJuIFwiaHR0cDovL3d3dy5ncmF2YXRhci5jb20vYXZhdGFyL1wiK0NyeXB0b0pTLk1ENShlbWFpbC50b0xvd2VyQ2FzZSgpKStcIj9zPTE2JmQ9NDA0XCI7XG5cdH1cblxuXHRwdWJsaWMgYXZhdGFycyA6IEZ1bmN0aW9uW10gPSBbdGhpcy5hdmF0YXJfZ3JhdmF0YXJdO1xufVxuXG4iLCJcclxuY2xhc3MgQXN5bmNMb2FkaW5nSXRlbSB7XHJcblx0cHVibGljIGxhYmVsOiBzdHJpbmc7XHJcblx0cHVibGljIGRhdGE6IGFueTtcclxuXHRwdWJsaWMgY2FsbGJhY2s6IEZ1bmN0aW9uO1xyXG5cdHB1YmxpYyBpbmRleDogbnVtYmVyO1xyXG5cdHB1YmxpYyBvZiA6IG51bWJlcjtcclxuXHRcclxuXHRjb25zdHJ1Y3RvciAobGFiZWw6IHN0cmluZywgZGF0YTogYW55LCBjYWxsYmFjazogRnVuY3Rpb24sIGluZGV4OiBudW1iZXIsIG9mOiBudW1iZXIpIHtcclxuXHRcdHRoaXMubGFiZWwgPSBsYWJlbDtcclxuXHRcdHRoaXMuZGF0YSA9IGRhdGE7XHJcblx0XHR0aGlzLmNhbGxiYWNrID0gY2FsbGJhY2s7XHJcblx0XHR0aGlzLmluZGV4ID0gaW5kZXg7XHJcblx0XHR0aGlzLm9mID0gb2Y7XHJcblx0fVxyXG59XHJcblxyXG5jbGFzcyBBc3luY0xvYWRlciB7XHJcblx0XHJcblx0cHJpdmF0ZSBlbGVtZW50OiBIVE1MRWxlbWVudDtcclxuXHRwcml2YXRlIGl0ZW1zOiBBc3luY0xvYWRpbmdJdGVtW10gPSBbXTtcclxuXHRwcml2YXRlIHN1c3BlbmRlZDogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuXHRjb25zdHJ1Y3RvciAoZWxlbWVudDogSFRNTEVsZW1lbnQpIHtcclxuXHRcdHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcblx0fVxyXG5cdFxyXG5cdC8qKiBkbyB0aGlzIGFzeW5jLCBkaXNwbGF5IHRoZSBsYWJlbCBhbmQgdGhlIGRhdGEgKi9cclxuXHRwdWJsaWMgdGhlbihsYWJlbDogc3RyaW5nLCBkYXRhY2FsbGJhY2s6IEZ1bmN0aW9uLCBjYWxsYmFjazogRnVuY3Rpb24pOiBBc3luY0xvYWRlciB7XHJcblx0XHR0aGlzLnRoZW5TaW5nbGUobGFiZWwsICgpID0+IHtcclxuXHRcdFx0Ly8gYWRkIGl0IHRvIHRoZSBiZWdpbm5pbmcgb2YgdGhlIHF1ZXVlXHJcblx0XHRcdHZhciBkYXRhOiBhbnlbXSA9IGRhdGFjYWxsYmFjaygpO1xyXG5cdFx0XHRmb3IodmFyIGkgPSBkYXRhLmxlbmd0aC0xOyBpPj0gMDsgaS0tKSB7XHJcblx0XHRcdFx0dGhpcy5pdGVtcy51bnNoaWZ0KG5ldyBBc3luY0xvYWRpbmdJdGVtKGxhYmVsLCBkYXRhW2ldLCBjYWxsYmFjaywgaSwgZGF0YS5sZW5ndGgpKTtcdFxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH1cclxuXHRcclxuXHRwdWJsaWMgdGhlblNpbmdsZShsYWJlbDogc3RyaW5nLCBjYWxsYmFjazogRnVuY3Rpb24pOiBBc3luY0xvYWRlciB7XHJcblx0XHR0aGlzLml0ZW1zLnB1c2gobmV3IEFzeW5jTG9hZGluZ0l0ZW0obGFiZWwsIG51bGwsIGNhbGxiYWNrLCAwLCAxKSk7XHJcblx0XHRyZXR1cm4gdGhpcztcdFxyXG5cdH1cclxuXHRcclxuXHRwdWJsaWMgc3RhcnQoc2hpZWxkOiBib29sZWFuID0gdHJ1ZSkge1xyXG5cdFx0aWYoc2hpZWxkKSB7XHJcblx0XHRcdHRoaXMuZWxlbWVudC5oaWRkZW4gPSBmYWxzZTtcdFxyXG5cdFx0fVxyXG5cdFx0dGhpcy5uZXh0KCk7XHJcblx0fVxyXG5cdFxyXG5cdHB1YmxpYyBuZXh0KCkge1xyXG5cdFx0dmFyIG5leHRJdGVtOiBBc3luY0xvYWRpbmdJdGVtID0gdGhpcy5pdGVtcy5zaGlmdCgpO1xyXG5cdFx0aWYobmV4dEl0ZW0gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAvLyBhdm9pZCB5aWVsZGluZyBjb250cm9sIHVubmVjZXNzYXJpbHksIGJ1dCBsaW1pdCBzdGFjayBkZXB0aCBhdCB0aGUgc2FtZSB0aW1lXHJcblx0XHRcdGlmICgobmV4dEl0ZW0uaW5kZXggJSA1MCkgPT09IDApIHtcclxuXHRcdFx0XHR0aGlzLnNob3dTdGF0dXMobmV4dEl0ZW0pO1xyXG5cdCAgICBcdFx0d2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIExvZ2dlci5kZWJ1ZyhcImV4ZWN1dGluZyBcIituZXh0SXRlbS5sYWJlbCsgXCIgKFwiK25leHRJdGVtLmluZGV4K1wiL1wiK25leHRJdGVtLm9mK1wiKVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmV4ZWN1dGUobmV4dEl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmV4ZWN1dGUobmV4dEl0ZW0pO1xyXG4gICAgICAgICAgICB9XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLmVsZW1lbnQuaGlkZGVuID0gdHJ1ZTtcclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0cHVibGljIHN1c3BlbmQoKSB7XHJcblx0XHR0aGlzLnN1c3BlbmRlZCA9IHRydWU7XHJcblx0fVxyXG5cdFxyXG5cdHB1YmxpYyByZXN1bWUoKSB7XHJcblx0XHR0aGlzLnN1c3BlbmRlZCA9IGZhbHNlO1xyXG5cdFx0dGhpcy5uZXh0KCk7XHJcblx0fVxyXG5cdHB1YmxpYyBzaG93U3RhdHVzKGl0ZW06IEFzeW5jTG9hZGluZ0l0ZW0pIHtcclxuXHRcdHRoaXMuZWxlbWVudC5pbm5lckhUTUwgPSBpdGVtLmxhYmVsOyAvLyArIFwiIChcIitpdGVtLmluZGV4ICsgXCIvXCIraXRlbS5vZitcIilcIjtcclxuXHR9XHJcblx0XHJcblx0cHVibGljIGV4ZWN1dGUoaXRlbTogQXN5bmNMb2FkaW5nSXRlbSkge1xyXG5cdFx0aXRlbS5jYWxsYmFjayhpdGVtLmRhdGEpO1xyXG5cdFx0aWYoIXRoaXMuc3VzcGVuZGVkKSB7XHJcblx0XHRcdHRoaXMubmV4dCgpO1xyXG5cdFx0fVxyXG5cdH1cclxufVxyXG4iLCIvKipcclxuICogRWxlbWVudHMgd2l0aCB0d28gY29udGVudHMsIHRoYXQgZXhwYW5kIG9uIGRvdWJsZSBjbGlja1xyXG4gKi9cclxuIFxyXG5cdGludGVyZmFjZSBIVE1MRXhwYW5kYWJsZUVsZW1lbnQgZXh0ZW5kcyBIVE1MRWxlbWVudCB7XHJcblx0XHR3aGVuU2hvcnQoaW5uZXJIVE1MOiBzdHJpbmcpOiB2b2lkO1xyXG5cdFx0d2hlbkZ1bGwoaW5uZXJIVE1MOiBzdHJpbmcpOiB2b2lkO1xyXG5cdH1cclxuXHRcclxuXHRjbGFzcyBFeHBhbmRhYmxlIHtcclxuXHRcdHB1YmxpYyBzdGF0aWMgZXh0ZW5kKGVsZW1lbnQ6IEhUTUxFbGVtZW50KTogSFRNTEV4cGFuZGFibGVFbGVtZW50IHtcclxuXHRcdFx0dmFyIGV4dGVuZGVkOiBIVE1MRXhwYW5kYWJsZUVsZW1lbnQgPSA8SFRNTEV4cGFuZGFibGVFbGVtZW50PiBlbGVtZW50O1xyXG5cdFx0XHRlbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJnaXRsaW5lLWV4cGFuZGFibGVcIik7XHJcblx0XHRcdFxyXG5cdFx0XHRleHRlbmRlZC53aGVuRnVsbCA9IChpbm5lckhUTUw6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdGV4dGVuZGVkLm9uY2xpY2sgPSAoZXZlbnQpID0+IHtcclxuXHRcdFx0XHRcdGlmKGV2ZW50LmRldGFpbCA9PSAyKSB7XHJcblx0XHRcdFx0XHRcdGV4dGVuZGVkLmlubmVySFRNTCA9IGlubmVySFRNTDtcclxuXHRcdFx0XHRcdFx0ZXZlbnQuY2FuY2VsQnViYmxlID0gdHJ1ZTtcclxuXHRcdFx0XHRcdFx0ZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiZ2l0bGluZS1leHBhbmRhYmxlLWV4cGFuZGVkXCIpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH07XHJcblx0XHRcdH1cclxuXHRcdFx0XHJcblx0XHRcdGV4dGVuZGVkLndoZW5TaG9ydCA9ICAoaW5uZXJIVE1MOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRleHRlbmRlZC5pbm5lckhUTUwgPSBpbm5lckhUTUw7XHJcblx0XHRcdFx0XHRleHRlbmRlZC5vbm1vdXNlb3V0ID0gKGV2ZW50KSA9PiB7XHJcblx0XHRcdFx0XHRleHRlbmRlZC5pbm5lckhUTUwgPSBpbm5lckhUTUwrIFwiIFwiO1xyXG5cdFx0XHRcdFx0ZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiZ2l0bGluZS1leHBhbmRhYmxlLWV4cGFuZGVkXCIpO1xyXG5cdFx0XHRcdH07XHRcclxuXHRcdFx0fVxyXG5cclxuXHRcdHJldHVybiBleHRlbmRlZDtcclxuXHRcdH1cdFx0XHJcblx0fVxyXG5cdFxyXG4iLCIvKipcclxuICogTmV3IHR5cGVzY3JpcHQgZmlsZVxyXG4gKi9cclxuXHJcbmNsYXNzIENvbW1pdFByb3ZpZGVyIHtcclxuIFx0cHJpdmF0ZSB1cmw7XHJcbiBcdHByaXZhdGUgY2FsbGJhY2s6IEZ1bmN0aW9uO1xyXG4gXHRcclxuXHRjb25zdHJ1Y3RvciAodXJsOiBzdHJpbmcpIHtcclxuXHRcdHRoaXMudXJsID0gdXJsO1xyXG5cdH1cclxuXHRcclxuXHRwdWJsaWMgd2hlbkRvbmUoZGF0YTogYW55KSB7XHJcblx0XHR0aGlzLmNhbGxiYWNrKGRhdGEpO1xyXG5cdH1cclxuXHRcclxuXHRwdWJsaWMgd2l0aENhbGxiYWNrKGNhbGxiYWNrRm46IEZ1bmN0aW9uKSB7XHJcblx0XHR0aGlzLmNhbGxiYWNrID0gY2FsbGJhY2tGbjtcclxuXHR9XHJcblx0XHJcblx0LyoqIHRoaXMgbWV0aG9kIHNob3VsZCBiZSBvdmVyd3JpdHRlbi4gaXQgbXVzdCBjYWxsIHdoZW5Eb25lKGRhdGEpIHdoZW4gYWxsIGRhdGEgd2FzIGxvYWRlZC4gKi9cclxuXHRwdWJsaWMgb25SZXF1ZXN0ZWQodXJsOiBzdHJpbmcpIHtcclxuXHRcdHRocm93IG5ldyBFcnJvcihcIm9uUmVxdWVzdGVkIG5vdCBpbXBsZW1lbnRlZCBvbiBcIit0aGlzKTtcclxuXHR9XHJcblx0XHJcblx0cHVibGljIHJlcXVlc3QoKSB7XHJcblx0XHR0aGlzLm9uUmVxdWVzdGVkKHRoaXMudXJsKTtcclxuXHR9XHJcbn1cclxuXHQiLCJ2YXIgQXN5bmNMb2FkaW5nSXRlbSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQXN5bmNMb2FkaW5nSXRlbShsYWJlbCwgZGF0YSwgY2FsbGJhY2ssIGluZGV4LCBvZikge1xuICAgICAgICB0aGlzLmxhYmVsID0gbGFiZWw7XG4gICAgICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICAgICAgdGhpcy5pbmRleCA9IGluZGV4O1xuICAgICAgICB0aGlzLm9mID0gb2Y7XG4gICAgfVxuICAgIHJldHVybiBBc3luY0xvYWRpbmdJdGVtO1xufSkoKTtcbnZhciBBc3luY0xvYWRlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQXN5bmNMb2FkZXIoZWxlbWVudCkge1xuICAgICAgICB0aGlzLml0ZW1zID0gW107XG4gICAgICAgIHRoaXMuc3VzcGVuZGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgfVxuICAgIC8qKiBkbyB0aGlzIGFzeW5jLCBkaXNwbGF5IHRoZSBsYWJlbCBhbmQgdGhlIGRhdGEgKi9cbiAgICBBc3luY0xvYWRlci5wcm90b3R5cGUudGhlbiA9IGZ1bmN0aW9uIChsYWJlbCwgZGF0YWNhbGxiYWNrLCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnRoZW5TaW5nbGUobGFiZWwsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIGFkZCBpdCB0byB0aGUgYmVnaW5uaW5nIG9mIHRoZSBxdWV1ZVxuICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhY2FsbGJhY2soKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSBkYXRhLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuaXRlbXMudW5zaGlmdChuZXcgQXN5bmNMb2FkaW5nSXRlbShsYWJlbCwgZGF0YVtpXSwgY2FsbGJhY2ssIGksIGRhdGEubGVuZ3RoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIEFzeW5jTG9hZGVyLnByb3RvdHlwZS50aGVuU2luZ2xlID0gZnVuY3Rpb24gKGxhYmVsLCBjYWxsYmFjaykge1xuICAgICAgICB0aGlzLml0ZW1zLnB1c2gobmV3IEFzeW5jTG9hZGluZ0l0ZW0obGFiZWwsIG51bGwsIGNhbGxiYWNrLCAwLCAxKSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgQXN5bmNMb2FkZXIucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKHNoaWVsZCkge1xuICAgICAgICBpZiAoc2hpZWxkID09PSB2b2lkIDApIHsgc2hpZWxkID0gdHJ1ZTsgfVxuICAgICAgICBpZiAoc2hpZWxkKSB7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuaGlkZGVuID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uZXh0KCk7XG4gICAgfTtcbiAgICBBc3luY0xvYWRlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIG5leHRJdGVtID0gdGhpcy5pdGVtcy5zaGlmdCgpO1xuICAgICAgICBpZiAobmV4dEl0ZW0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgLy8gYXZvaWQgeWllbGRpbmcgY29udHJvbCB1bm5lY2Vzc2FyaWx5LCBidXQgbGltaXQgc3RhY2sgZGVwdGggYXQgdGhlIHNhbWUgdGltZVxuICAgICAgICAgICAgaWYgKChuZXh0SXRlbS5pbmRleCAlIDUwKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd1N0YXR1cyhuZXh0SXRlbSk7XG4gICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBMb2dnZXIuZGVidWcoXCJleGVjdXRpbmcgXCIgKyBuZXh0SXRlbS5sYWJlbCArIFwiIChcIiArIG5leHRJdGVtLmluZGV4ICsgXCIvXCIgKyBuZXh0SXRlbS5vZiArIFwiKVwiKTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuZXhlY3V0ZShuZXh0SXRlbSk7XG4gICAgICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmV4ZWN1dGUobmV4dEl0ZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmhpZGRlbiA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFzeW5jTG9hZGVyLnByb3RvdHlwZS5zdXNwZW5kID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnN1c3BlbmRlZCA9IHRydWU7XG4gICAgfTtcbiAgICBBc3luY0xvYWRlci5wcm90b3R5cGUucmVzdW1lID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnN1c3BlbmRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLm5leHQoKTtcbiAgICB9O1xuICAgIEFzeW5jTG9hZGVyLnByb3RvdHlwZS5zaG93U3RhdHVzID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LmlubmVySFRNTCA9IGl0ZW0ubGFiZWw7IC8vICsgXCIgKFwiK2l0ZW0uaW5kZXggKyBcIi9cIitpdGVtLm9mK1wiKVwiO1xuICAgIH07XG4gICAgQXN5bmNMb2FkZXIucHJvdG90eXBlLmV4ZWN1dGUgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICBpdGVtLmNhbGxiYWNrKGl0ZW0uZGF0YSk7XG4gICAgICAgIGlmICghdGhpcy5zdXNwZW5kZWQpIHtcbiAgICAgICAgICAgIHRoaXMubmV4dCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gQXN5bmNMb2FkZXI7XG59KSgpO1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIkJyYW5jaC50c1wiLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJDb21taXQudHNcIi8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiR2l0bGluZS50c1wiLz5cbmZ1bmN0aW9uIGluZGV4VG9YKGluZGV4KSB7XG4gICAgcmV0dXJuIGluZGV4ICogMjAgKyAxMjtcbn1cbnZhciBHaXRsaW5lQ29uZmlnID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBHaXRsaW5lQ29uZmlnKCkge1xuICAgICAgICB0aGlzLmRvdEhlaWdodCA9IDY7XG4gICAgICAgIHRoaXMuZG90V2lkdGggPSA4O1xuICAgICAgICB0aGlzLnJlbW90ZU9ubHkgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5hdmF0YXJzID0gW3RoaXMuYXZhdGFyX2dyYXZhdGFyXTtcbiAgICB9XG4gICAgR2l0bGluZUNvbmZpZy5wcm90b3R5cGUuYXZhdGFyX2dyYXZhdGFyID0gZnVuY3Rpb24gKGVtYWlsKSB7XG4gICAgICAgIHJldHVybiBcImh0dHA6Ly93d3cuZ3JhdmF0YXIuY29tL2F2YXRhci9cIiArIENyeXB0b0pTLk1ENShlbWFpbC50b0xvd2VyQ2FzZSgpKSArIFwiP3M9MTYmZD00MDRcIjtcbiAgICB9O1xuICAgIHJldHVybiBHaXRsaW5lQ29uZmlnO1xufSkoKTtcbi8qKlxuICogRWxlbWVudHMgd2l0aCB0d28gY29udGVudHMsIHRoYXQgZXhwYW5kIG9uIGRvdWJsZSBjbGlja1xuICovXG52YXIgRXhwYW5kYWJsZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRXhwYW5kYWJsZSgpIHtcbiAgICB9XG4gICAgRXhwYW5kYWJsZS5leHRlbmQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICB2YXIgZXh0ZW5kZWQgPSBlbGVtZW50O1xuICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJnaXRsaW5lLWV4cGFuZGFibGVcIik7XG4gICAgICAgIGV4dGVuZGVkLndoZW5GdWxsID0gZnVuY3Rpb24gKGlubmVySFRNTCkge1xuICAgICAgICAgICAgZXh0ZW5kZWQub25jbGljayA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIGlmIChldmVudC5kZXRhaWwgPT0gMikge1xuICAgICAgICAgICAgICAgICAgICBleHRlbmRlZC5pbm5lckhUTUwgPSBpbm5lckhUTUw7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LmNhbmNlbEJ1YmJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImdpdGxpbmUtZXhwYW5kYWJsZS1leHBhbmRlZFwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICBleHRlbmRlZC53aGVuU2hvcnQgPSBmdW5jdGlvbiAoaW5uZXJIVE1MKSB7XG4gICAgICAgICAgICBleHRlbmRlZC5pbm5lckhUTUwgPSBpbm5lckhUTUw7XG4gICAgICAgICAgICBleHRlbmRlZC5vbm1vdXNlb3V0ID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgZXh0ZW5kZWQuaW5uZXJIVE1MID0gaW5uZXJIVE1MICsgXCIgXCI7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiZ2l0bGluZS1leHBhbmRhYmxlLWV4cGFuZGVkXCIpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZGVkO1xuICAgIH07XG4gICAgcmV0dXJuIEV4cGFuZGFibGU7XG59KSgpO1xuLyoqXG4gKiBOZXcgdHlwZXNjcmlwdCBmaWxlXG4gKi9cbnZhciBDb21taXRQcm92aWRlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ29tbWl0UHJvdmlkZXIodXJsKSB7XG4gICAgICAgIHRoaXMudXJsID0gdXJsO1xuICAgIH1cbiAgICBDb21taXRQcm92aWRlci5wcm90b3R5cGUud2hlbkRvbmUgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB0aGlzLmNhbGxiYWNrKGRhdGEpO1xuICAgIH07XG4gICAgQ29tbWl0UHJvdmlkZXIucHJvdG90eXBlLndpdGhDYWxsYmFjayA9IGZ1bmN0aW9uIChjYWxsYmFja0ZuKSB7XG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFja0ZuO1xuICAgIH07XG4gICAgLyoqIHRoaXMgbWV0aG9kIHNob3VsZCBiZSBvdmVyd3JpdHRlbi4gaXQgbXVzdCBjYWxsIHdoZW5Eb25lKGRhdGEpIHdoZW4gYWxsIGRhdGEgd2FzIGxvYWRlZC4gKi9cbiAgICBDb21taXRQcm92aWRlci5wcm90b3R5cGUub25SZXF1ZXN0ZWQgPSBmdW5jdGlvbiAodXJsKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIm9uUmVxdWVzdGVkIG5vdCBpbXBsZW1lbnRlZCBvbiBcIiArIHRoaXMpO1xuICAgIH07XG4gICAgQ29tbWl0UHJvdmlkZXIucHJvdG90eXBlLnJlcXVlc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMub25SZXF1ZXN0ZWQodGhpcy51cmwpO1xuICAgIH07XG4gICAgcmV0dXJuIENvbW1pdFByb3ZpZGVyO1xufSkoKTtcbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgZnVuY3Rpb24gKGQsIGIpIHtcbiAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTtcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG59O1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL0NvbW1pdFByb3ZpZGVyLnRzXCIvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL0dpdGxpbmUudHNcIi8+XG52YXIgTG9jYWxHaXQySnNvblByb3ZpZGVyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTG9jYWxHaXQySnNvblByb3ZpZGVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIExvY2FsR2l0Mkpzb25Qcm92aWRlcigpIHtcbiAgICAgICAgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuICAgIExvY2FsR2l0Mkpzb25Qcm92aWRlci5wcm90b3R5cGUub25SZXF1ZXN0ZWQgPSBmdW5jdGlvbiAodXJsKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGpRdWVyeS5nZXRKU09OKHVybCwge30sIGZ1bmN0aW9uIChqc29uKSB7XG4gICAgICAgICAgICBfdGhpcy53aGVuRG9uZShqc29uKTtcbiAgICAgICAgfSkuZXJyb3IoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgR2l0bGluZS5kaXNwbGF5RmF0YWxFcnJvcihcIkVycm9yIGxvYWRpbmcgZ2l0IGRhdGEgZnJvbSBcIiArIHVybCArIFwiIGNyZWF0ZSBpdCB1c2luZyBnaXQyanNvblwiKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gTG9jYWxHaXQySnNvblByb3ZpZGVyO1xufSkoQ29tbWl0UHJvdmlkZXIpO1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL0NvbW1pdFByb3ZpZGVyLnRzXCIvPlxudmFyIEdpdGh1YkNvbW1pdFByb3ZpZGVyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoR2l0aHViQ29tbWl0UHJvdmlkZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gR2l0aHViQ29tbWl0UHJvdmlkZXIodXJsLCBsaW1pdCwgYWNjZXNzVG9rZW4pIHtcbiAgICAgICAgX3N1cGVyLmNhbGwodGhpcywgdXJsKTtcbiAgICAgICAgdGhpcy5mb3JrcyA9IFtdO1xuICAgICAgICB0aGlzLmJhc2VCcmFuY2hlcyA9IFtdO1xuICAgICAgICB0aGlzLmRhdGEgPSB7fTtcbiAgICAgICAgdGhpcy5kb25lID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYWNjZXNzVG9rZW4gPSBhY2Nlc3NUb2tlbjtcbiAgICAgICAgdGhpcy5saW1pdCA9IGxpbWl0O1xuICAgIH1cbiAgICBHaXRodWJDb21taXRQcm92aWRlci5wcm90b3R5cGUuZ2l0VVJMID0gZnVuY3Rpb24gKHVybCwgYXBpLCBwYXJhbXMpIHtcbiAgICAgICAgaWYgKHBhcmFtcyA9PT0gdm9pZCAwKSB7IHBhcmFtcyA9IFwiXCI7IH1cbiAgICAgICAgLy8gY29udmVydCB0byBhcGkgdXJsIGFuZCByZW1vdmUgdHJhaWxpbmcgL1xuICAgICAgICBpZiAodXJsLmluZGV4T2YoXCJhcGkuZ2l0aHViLmNvbVwiKSA9PSAtMSkge1xuICAgICAgICAgICAgdXJsID0gdXJsLnJlcGxhY2UoLy4qZ2l0aHViLmNvbS8sIFwiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9cIikucmVwbGFjZSgvXFwvXFwvL2csIFwiL1wiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdXJsICsgXCIvXCIgKyBhcGkgKyBcIj9hY2Nlc3NfdG9rZW49XCIgKyB0aGlzLmFjY2Vzc1Rva2VuICsgXCImcGVyX3BhZ2U9XCIgKyB0aGlzLmxpbWl0ICsgXCImY2FsbGJhY2s9PyZcIiArIHBhcmFtcztcbiAgICB9O1xuICAgIEdpdGh1YkNvbW1pdFByb3ZpZGVyLnByb3RvdHlwZS5vblJlcXVlc3RlZCA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgICAgICAgdGhpcy5sb2FkRm9ya3ModXJsKTtcbiAgICB9O1xuICAgIEdpdGh1YkNvbW1pdFByb3ZpZGVyLnByb3RvdHlwZS5sb2FkRm9ya3MgPSBmdW5jdGlvbiAodXJsKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGpRdWVyeS53aGVuKGpRdWVyeS5nZXRKU09OKHRoaXMuZ2l0VVJMKHVybCwgXCJmb3Jrc1wiKSksIGpRdWVyeS5nZXRKU09OKHRoaXMuZ2l0VVJMKHVybCwgXCJicmFuY2hlc1wiKSkpLnRoZW4oZnVuY3Rpb24gKGZvcmtzLCBicmFuY2hlcykge1xuICAgICAgICAgICAgLy90aGlzLmJhc2VDb21taXRzID0gY29tbWl0c1swXS5kYXRhO1xuICAgICAgICAgICAgX3RoaXMucHJvY2Vzc0JyYW5jaGVzKHVybCwgYnJhbmNoZXNbMF0uZGF0YSk7XG4gICAgICAgICAgICBfdGhpcy5mb3JrcyA9IGZvcmtzWzBdLmRhdGE7XG4gICAgICAgICAgICBfdGhpcy5sb2FkQnJhbmNoZXMoKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBHaXRodWJDb21taXRQcm92aWRlci5wcm90b3R5cGUucHJvY2Vzc0JyYW5jaGVzID0gZnVuY3Rpb24gKGZvcmssIGRhdGEpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChicmFuY2gpIHtcbiAgICAgICAgICAgIGJyYW5jaC5yZXBvID0gZm9yay51cmwgIT09IHVuZGVmaW5lZCA/IGZvcmsudXJsIDogZm9yaztcbiAgICAgICAgICAgIGlmIChmb3JrLmZ1bGxfbmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgYnJhbmNoLm5hbWUgPSBicmFuY2gubmFtZSArIFwiQFwiICsgZm9yay5mdWxsX25hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfdGhpcy5iYXNlQnJhbmNoZXMucHVzaChicmFuY2gpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEdpdGh1YkNvbW1pdFByb3ZpZGVyLnByb3RvdHlwZS5sb2FkQnJhbmNoZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBmb3JrUmVxdWVzdHMgPSB0aGlzLmZvcmtzLm1hcChmdW5jdGlvbiAoZm9yaykge1xuICAgICAgICAgICAgcmV0dXJuIGpRdWVyeS5nZXRKU09OKF90aGlzLmdpdFVSTChmb3JrLnVybCwgXCJicmFuY2hlc1wiKSwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBMb2dnZXIuZGVidWcoXCJsb2FkZWQgYnJhbmNoZXMgZm9yIFwiICsgZm9yay5uYW1lKTtcbiAgICAgICAgICAgICAgICBfdGhpcy5wcm9jZXNzQnJhbmNoZXMoZm9yaywgZGF0YS5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgalF1ZXJ5LndoZW4uYXBwbHkoalF1ZXJ5LCBmb3JrUmVxdWVzdHMpLmRvbmUoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgTG9nZ2VyLmRlYnVnKFwiYWxsIGJyYW5jaGVzIGxvYWRlZFwiKTtcbiAgICAgICAgICAgIF90aGlzLmxvYWRDb21taXRzKCk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgR2l0aHViQ29tbWl0UHJvdmlkZXIucHJvdG90eXBlLmxvYWRDb21taXRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgY29tbWl0UmVxdWVzdHMgPSBbXTtcbiAgICAgICAgdGhpcy5iYXNlQnJhbmNoZXMuZm9yRWFjaChmdW5jdGlvbiAoYikge1xuICAgICAgICAgICAgdmFyIGNvbW1pdCA9IF90aGlzLmRhdGFbYi5jb21taXQuc2hhXTtcbiAgICAgICAgICAgIGlmIChjb21taXQgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgY29tbWl0UmVxdWVzdHMucHVzaChqUXVlcnkuZ2V0SlNPTihfdGhpcy5naXRVUkwoYi5yZXBvLCBcImNvbW1pdHNcIiwgXCJzaGE9XCIgKyBiLmNvbW1pdC5zaGEpLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBMb2dnZXIuZGVidWcoXCJsb2FkZWQgY29tbWl0cyBmb3IgXCIgKyBiLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5wcm9jZXNzQ29tbWl0cyhkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGpRdWVyeS53aGVuLmFwcGx5KGpRdWVyeSwgY29tbWl0UmVxdWVzdHMpLmRvbmUoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3RoaXMucHJvY2VzcygpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEdpdGh1YkNvbW1pdFByb3ZpZGVyLnByb3RvdHlwZS5wcm9jZXNzQ29tbWl0cyA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGRhdGEubWFwKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2YXIgYyA9IHt9O1xuICAgICAgICAgICAgYy5zaGEgPSBkYXRhLnNoYTtcbiAgICAgICAgICAgIGMuc3NoYSA9IGRhdGEuc2hhLnN1YnN0cmluZygwLCA4KTtcbiAgICAgICAgICAgIGMucGFyZW50aGFzaGVzID0gZGF0YS5wYXJlbnRzLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5zaGE7IH0pO1xuICAgICAgICAgICAgYy5hdXRob3JuYW1lID0gZGF0YS5jb21taXQuYXV0aG9yLm5hbWU7XG4gICAgICAgICAgICBjLmF1dGhvcmVtYWlsID0gZGF0YS5jb21taXQuYXV0aG9yLmVtYWlsO1xuICAgICAgICAgICAgYy5hdXRob3JkYXRlID0gZGF0YS5jb21taXQuYXV0aG9yLmRhdGU7XG4gICAgICAgICAgICBjLmF1dGhvcnRpbWVzdGFtcCA9IG5ldyBEYXRlKGRhdGEuY29tbWl0LmF1dGhvci5kYXRlKS5nZXRUaW1lKCk7XG4gICAgICAgICAgICBjLmNvbW1pdHRlcm5hbWUgPSBkYXRhLmNvbW1pdC5jb21taXR0ZXIubmFtZTtcbiAgICAgICAgICAgIGMuY29tbWl0dGVyZW1haWwgPSBkYXRhLmNvbW1pdC5jb21taXR0ZXIuZW1haWw7XG4gICAgICAgICAgICBjLmNvbW1pdHRlcmRhdGUgPSBkYXRhLmNvbW1pdC5jb21taXR0ZXIuZGF0ZTtcbiAgICAgICAgICAgIGMuY29tbWl0dGVydGltZXN0YW1wID0gbmV3IERhdGUoZGF0YS5jb21taXQuY29tbWl0dGVyLmRhdGUpLmdldFRpbWUoKTtcbiAgICAgICAgICAgIGMuc3ViamVjdCA9IGRhdGEuY29tbWl0Lm1lc3NhZ2U7XG4gICAgICAgICAgICBjLmJvZHkgPSBcIlwiOyAvLyBUb2RvOiB3aGVyZSB0byBnZXQgdGhpcz9cbiAgICAgICAgICAgIGMucmVmbmFtZXMgPSBbXTsgLy8gc2V0IHdoZW4gcGFyc2luZyBicmFuY2hlc1xuICAgICAgICAgICAgYy5pbkhlYWRzID0gW107IC8vIHNldCB3aGVuIHBhcnNpbmcgYnJhbmNoZXNcbiAgICAgICAgICAgIHJldHVybiBjO1xuICAgICAgICB9KS5mb3JFYWNoKGZ1bmN0aW9uIChjb21taXQpIHtcbiAgICAgICAgICAgIF90aGlzLmRhdGFbY29tbWl0LnNoYV0gPSBjb21taXQ7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgR2l0aHViQ29tbWl0UHJvdmlkZXIucHJvdG90eXBlLnByb2Nlc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuYmFzZUJyYW5jaGVzLmZvckVhY2goZnVuY3Rpb24gKGIpIHtcbiAgICAgICAgICAgIHZhciBjb21taXQgPSBfdGhpcy5kYXRhW2IuY29tbWl0LnNoYV07XG4gICAgICAgICAgICBpZiAoY29tbWl0ID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYi5hc3NpZ25lZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgY29tbWl0LnJlZm5hbWVzLnB1c2goYi5uYW1lKTtcbiAgICAgICAgICAgICAgICBfdGhpcy5hc3NpZ25IZWFkcyhjb21taXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gU29ydFxuICAgICAgICB2YXIgbmV3ZGF0YSA9IHt9O1xuICAgICAgICBPYmplY3Qua2V5cyh0aGlzLmRhdGEpLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5kYXRhW2JdLmNvbW1pdHRlcnRpbWVzdGFtcCAtIF90aGlzLmRhdGFbYV0uY29tbWl0dGVydGltZXN0YW1wO1xuICAgICAgICB9KS5mb3JFYWNoKGZ1bmN0aW9uIChzaGEpIHtcbiAgICAgICAgICAgIG5ld2RhdGFbc2hhXSA9IF90aGlzLmRhdGFbc2hhXTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMud2hlbkRvbmUobmV3ZGF0YSk7XG4gICAgfTtcbiAgICBHaXRodWJDb21taXRQcm92aWRlci5wcm90b3R5cGUuYXNzaWduSGVhZHMgPSBmdW5jdGlvbiAoY29tbWl0KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGNvbW1pdC5wYXJlbnRzMSA9IGNvbW1pdC5wYXJlbnRoYXNoZXMubWFwKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4OyB9KTsgLy8gY29weSBhcnJheVxuICAgICAgICB3aGlsZSAoY29tbWl0LnBhcmVudHMxLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciBuZXdQYXJlbnRzID0gW107XG4gICAgICAgICAgICBjb21taXQucGFyZW50czEuZm9yRWFjaChmdW5jdGlvbiAocGFyZW50SGFzaCkge1xuICAgICAgICAgICAgICAgIHZhciBwID0gX3RoaXMuZGF0YVtwYXJlbnRIYXNoXTtcbiAgICAgICAgICAgICAgICBpZiAocCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcC5pbkhlYWRzLnB1c2goY29tbWl0LnNoYSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFkZCBhbGwgZ3JhbmRwYXJlbnRzIHRvIHRoZSBuZXdwYXJlbnRzXG4gICAgICAgICAgICAgICAgICAgIHAucGFyZW50aGFzaGVzLmZvckVhY2goZnVuY3Rpb24gKGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXdQYXJlbnRzLmluZGV4T2YoaCkgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3UGFyZW50cy5wdXNoKGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbW1pdC5wYXJlbnRzMSA9IG5ld1BhcmVudHM7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBHaXRodWJDb21taXRQcm92aWRlcjtcbn0pKENvbW1pdFByb3ZpZGVyKTtcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJCcmFuY2gudHNcIi8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiQ29tbWl0LnRzXCIvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIkNvbmZpZy50c1wiLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJBc3luY0xvYWRlci50c1wiLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJFeHBhbmRhYmxlLnRzXCIvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIkNvbW1pdFByb3ZpZGVyLnRzXCIvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cInBsdWdpbnMvTG9jYWxHaXQySnNvblByb3ZpZGVyLnRzXCIvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cInBsdWdpbnMvZ2l0aHViLnRzXCIvPlxudmFyIEdpdGxpbmUgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEdpdGxpbmUoKSB7XG4gICAgICAgIHRoaXMuc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMubWF4WCA9IDA7XG4gICAgICAgIHRoaXMubWF4SW5kZXhZID0gMDtcbiAgICAgICAgdGhpcy5jb21taXRzID0ge307XG4gICAgICAgIHRoaXMuaGVhZHNNYXAgPSB7fTtcbiAgICAgICAgdGhpcy5jb25maWcgPSBuZXcgR2l0bGluZUNvbmZpZygpO1xuICAgIH1cbiAgICBHaXRsaW5lLnByb3RvdHlwZS5hZGRDb21taXQgPSBmdW5jdGlvbiAoY29tbWl0KSB7XG4gICAgICAgIHRoaXMuY29tbWl0c1tjb21taXQuZ2V0RnVsbFNoYSgpXSA9IGNvbW1pdDtcbiAgICAgICAgLy8gZmlyc3QgY29tbWl0IG5lZWRlZCBieSByZW5kZXJpbmdcbiAgICAgICAgaWYgKHRoaXMuZmlyc3RDb21taXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5maXJzdENvbW1pdCA9IGNvbW1pdDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgR2l0bGluZS5wcm90b3R5cGUuYWRkQnJhbmNoID0gZnVuY3Rpb24gKHJlZm5hbWUsIGNvbW1pdCwgc3BlY2lmaXR5KSB7XG4gICAgICAgIHZhciBicmFuY2ggPSBuZXcgQnJhbmNoKHJlZm5hbWUsIGNvbW1pdCwgc3BlY2lmaXR5KTtcbiAgICAgICAgdGhpcy5oZWFkc01hcFtyZWZuYW1lXSA9IGJyYW5jaDtcbiAgICB9O1xuICAgIEdpdGxpbmUucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5jYW52YXMgPSBuZXcganNnbC5QYW5lbCh0aGlzLmdyYXBoaWNhbFBhbmVsKTtcbiAgICAgICAgdGhpcy5hbC50aGVuU2luZ2xlKFwiTG9hZGluZyBEYXRhXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzLmFsLnN1c3BlbmQoKTtcbiAgICAgICAgICAgIF90aGlzLmNvbW1pdFByb3ZpZGVyLndpdGhDYWxsYmFjayhmdW5jdGlvbiAoanNvbikge1xuICAgICAgICAgICAgICAgIF90aGlzLmRhdGEgPSBqc29uO1xuICAgICAgICAgICAgICAgIF90aGlzLmFsLnJlc3VtZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBfdGhpcy5jb21taXRQcm92aWRlci5yZXF1ZXN0KCk7XG4gICAgICAgIH0pLnRoZW4oXCJMb2FkaW5nIENvbW1pdHNcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gT2JqZWN0LmtleXMoX3RoaXMuZGF0YSk7IH0sIGZ1bmN0aW9uIChzaGEpIHtcbiAgICAgICAgICAgIHZhciBjb21taXQgPSBuZXcgQ29tbWl0KF90aGlzLCBfdGhpcy5kYXRhW3NoYV0pO1xuICAgICAgICAgICAgX3RoaXMuYWRkQ29tbWl0KGNvbW1pdCk7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAudGhlblNpbmdsZShcIkJ1aWxkaW5nIEdyYXBoXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzLmJ1aWxkR3JhcGgoKTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKFwiRHJhd2luZyBMYWJlbHNcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gT2JqZWN0LmtleXMoX3RoaXMuY29tbWl0cyk7IH0sIGZ1bmN0aW9uIChzaGEpIHtcbiAgICAgICAgICAgIHZhciBjb21taXQgPSBfdGhpcy5jb21taXRzW3NoYV07XG4gICAgICAgICAgICBfdGhpcy5kcmF3Q29tbWl0KGNvbW1pdCk7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAudGhlblNpbmdsZShcIkNyZWF0aW5nIExlZ2VuZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfdGhpcy5yb290TGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIF90aGlzLnJvb3RMYWJlbC5jbGFzc05hbWUgPSBcImNvbW1pdC1sZWdlbmRcIjtcbiAgICAgICAgICAgIF90aGlzLnRleHRQYW5lbC5hcHBlbmRDaGlsZChfdGhpcy5yb290TGFiZWwpO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oXCJEcmF3aW5nIE1lcmdlc1wiLCBmdW5jdGlvbiAoKSB7IHJldHVybiBPYmplY3Qua2V5cyhfdGhpcy5jb21taXRzKTsgfSwgZnVuY3Rpb24gKHNoYSkge1xuICAgICAgICAgICAgdmFyIGNvbW1pdCA9IF90aGlzLmNvbW1pdHNbc2hhXTtcbiAgICAgICAgICAgIF90aGlzLmRyYXdSZWZlcmVuY2VzKGNvbW1pdCk7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAudGhlblNpbmdsZShcIlJlc2l6aW5nXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzLmdyYXBoaWNhbFBhbmVsLnN0eWxlLndpZHRoID0gaW5kZXhUb1goX3RoaXMubWF4WCArIDEpICsgXCJweFwiO1xuICAgICAgICAgICAgX3RoaXMuZ3JhcGhpY2FsUGFuZWwuc3R5bGUuaGVpZ2h0ID0gX3RoaXMuZ2V0SGVpZ2h0KCkgKyBcInB4XCI7XG4gICAgICAgIH0pLnN0YXJ0KCk7XG4gICAgICAgIHdpbmRvdy5vbnJlc2l6ZSA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgX3RoaXMuYWwudGhlbihcIlJlZHJhd2luZ1wiLCBmdW5jdGlvbiAoKSB7IHJldHVybiBPYmplY3Qua2V5cyhfdGhpcy5jb21taXRzKTsgfSwgZnVuY3Rpb24gKHNoYSkge1xuICAgICAgICAgICAgICAgIHZhciBjb21taXQgPSBfdGhpcy5jb21taXRzW3NoYV07XG4gICAgICAgICAgICAgICAgY29tbWl0LnZpZXcucmVkcmF3KCk7XG4gICAgICAgICAgICB9KS50aGVuU2luZ2xlKFwiUmVzaXppbmdcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzLmdyYXBoaWNhbFBhbmVsLnN0eWxlLndpZHRoID0gaW5kZXhUb1goX3RoaXMubWF4WCArIDEpICsgXCJweFwiO1xuICAgICAgICAgICAgICAgIF90aGlzLmdyYXBoaWNhbFBhbmVsLnN0eWxlLmhlaWdodCA9IF90aGlzLmdldEhlaWdodCgpICsgXCJweFwiO1xuICAgICAgICAgICAgfSkuc3RhcnQoZmFsc2UpO1xuICAgICAgICB9O1xuICAgIH07XG4gICAgR2l0bGluZS5wcm90b3R5cGUuZ2V0SGVpZ2h0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yb290TGFiZWwub2Zmc2V0VG9wIC0gdGhpcy5maXJzdENvbW1pdC52aWV3LmxhYmVsLm9mZnNldFRvcDtcbiAgICB9O1xuICAgIEdpdGxpbmUucHJvdG90eXBlLmJ1aWxkR3JhcGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBzaGFzID0gT2JqZWN0LmtleXModGhpcy5jb21taXRzKTtcbiAgICAgICAgc2hhcy5mb3JFYWNoKGZ1bmN0aW9uIChzaGEpIHtcbiAgICAgICAgICAgIHZhciBjb21taXQgPSBfdGhpcy5jb21taXRzW3NoYV07XG4gICAgICAgICAgICBjb21taXQuaW5pdFJlbGF0aW9ucygpO1xuICAgICAgICB9KTtcbiAgICAgICAgc2hhcy5mb3JFYWNoKGZ1bmN0aW9uIChzaGEpIHtcbiAgICAgICAgICAgIHZhciBjb21taXQgPSBfdGhpcy5jb21taXRzW3NoYV07XG4gICAgICAgICAgICBjb21taXQuaW5pdEhlYWRTcGVjaWZpdHkoKTtcbiAgICAgICAgICAgIGNvbW1pdC5pbml0TWVyZ2VzKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmluaXRCcmFuY2hlcygpO1xuICAgIH07XG4gICAgR2l0bGluZS5wcm90b3R5cGUuZHJhd0NvbW1pdCA9IGZ1bmN0aW9uIChjb21taXQpIHtcbiAgICAgICAgLy8gTGFiZWxcbiAgICAgICAgY29tbWl0LnZpZXcgPSBuZXcgQ29tbWl0Vmlldyh0aGlzLmNhbnZhcywgdGhpcy5jb25maWcsIGNvbW1pdCk7XG4gICAgICAgIGlmIChjb21taXQub3V0T2ZTY29wZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGNvbW1pdC52aWV3LmxhYmVsID0gdGhpcy5kcmF3TGFiZWwoY29tbWl0KTtcbiAgICAgICAgICAgIGNvbW1pdC52aWV3LmxhYmVsLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbnNvbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgTG9nZ2VyLmRlYnVnKGNvbW1pdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMudGV4dFBhbmVsLmFwcGVuZENoaWxkKGNvbW1pdC52aWV3LmxhYmVsKTtcbiAgICAgICAgICAgIGNvbW1pdC52aWV3LmxhYmVsLnN0eWxlWydwYWRkaW5nLWxlZnQnXSA9IGluZGV4VG9YKHRoaXMubWF4WCArIDEpICsgXCJweFwiO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBHaXRsaW5lLnByb3RvdHlwZS5kcmF3UmVmZXJlbmNlcyA9IGZ1bmN0aW9uIChjb21taXQpIHtcbiAgICAgICAgY29tbWl0LnZpZXcuYWRkUmVsYXRpb25zKCk7XG4gICAgICAgIGNvbW1pdC52aWV3LnJlZHJhdygpO1xuICAgIH07XG4gICAgR2l0bGluZS5wcm90b3R5cGUuZHJhd0xhYmVsID0gZnVuY3Rpb24gKGNvbW1pdCkge1xuICAgICAgICB2YXIgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgbGFiZWwuY2xhc3NOYW1lID0gXCJjb21taXQtbGVnZW5kXCI7XG4gICAgICAgIC8vIFNIQSBIYXNoIFxuICAgICAgICB2YXIgc2hvcnRTaGEgPSBjb21taXQuZ2V0U2hvcnRTaGEoKTtcbiAgICAgICAgdmFyIGZ1bGxTaGEgPSBjb21taXQuZ2V0RnVsbFNoYSgpO1xuICAgICAgICB2YXIgc2hhID0gRXhwYW5kYWJsZS5leHRlbmQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIikpO1xuICAgICAgICBzaGEud2hlblNob3J0KHNob3J0U2hhICsgXCIgXCIpO1xuICAgICAgICBzaGEud2hlbkZ1bGwoZnVsbFNoYSk7XG4gICAgICAgIHNoYS5zdHlsZS5mb250RmFtaWx5ID0gXCJDb3VyaWVyXCI7XG4gICAgICAgIGxhYmVsLmFwcGVuZENoaWxkKHNoYSk7XG4gICAgICAgIC8vIEF1dGhvciBhbmQgY29tbWl0dGVyXG4gICAgICAgIGxhYmVsLmFwcGVuZENoaWxkKHRoaXMuZHJhd0lkZW50aXR5KFwiYXV0aG9yXCIsIGNvbW1pdC5hdXRob3IpKTtcbiAgICAgICAgaWYgKGNvbW1pdC5hdXRob3IuZW1haWwgIT0gY29tbWl0LmNvbW1pdHRlci5lbWFpbCkge1xuICAgICAgICAgICAgbGFiZWwuYXBwZW5kQ2hpbGQodGhpcy5kcmF3SWRlbnRpdHkoXCJjb21taXR0ZXJcIiwgY29tbWl0LmNvbW1pdHRlcikpO1xuICAgICAgICB9XG4gICAgICAgIC8vIEJyYW5jaCAtIFRPRE86IFRhZ3MgYW5kIG90aGVyIGJyYW5jaGVzXHRcdFxuICAgICAgICBpZiAoY29tbWl0LmJyYW5jaCAmJiBjb21taXQuYnJhbmNoLmNvbW1pdCA9PT0gY29tbWl0ICYmICFjb21taXQuYnJhbmNoLmFub255bW91cykge1xuICAgICAgICAgICAgdmFyIGhlYWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcbiAgICAgICAgICAgIGhlYWQuY2xhc3NOYW1lID0gXCJoZWFkLWxhYmVsXCI7XG4gICAgICAgICAgICBoZWFkLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNvbW1pdC5nZXRDb2xvcig0MCk7XG4gICAgICAgICAgICBoZWFkLnN0eWxlLmNvbG9yID0gXCJ3aGl0ZVwiO1xuICAgICAgICAgICAgaGVhZC5zdHlsZS5wYWRkaW5nTGVmdCA9IGhlYWQuc3R5bGUucGFkZGluZ1JpZ2h0ID0gXCIycHhcIjtcbiAgICAgICAgICAgIGhlYWQuaW5uZXJIVE1MID0gY29tbWl0LmJyYW5jaC5yZWY7XG4gICAgICAgICAgICBsYWJlbC5hcHBlbmRDaGlsZChoZWFkKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBTdWJqZWN0XHRcdFxuICAgICAgICB2YXIgc3ViamVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuICAgICAgICBzdWJqZWN0LmlubmVySFRNTCA9IFwiIFwiICsgY29tbWl0LnN1YmplY3Q7XG4gICAgICAgIHN1YmplY3Quc3R5bGUuY29sb3IgPSBjb21taXQuaGFzTWVyZ2VzKCkgPyBcImdyZXlcIiA6IFwiYmxhY2tcIjtcbiAgICAgICAgbGFiZWwuYXBwZW5kQ2hpbGQoc3ViamVjdCk7XG4gICAgICAgIGxhYmVsLnN0eWxlLnBvc2l0aW9uID0gXCJyZWxhdGl2ZVwiO1xuICAgICAgICByZXR1cm4gbGFiZWw7XG4gICAgfTtcbiAgICBHaXRsaW5lLnByb3RvdHlwZS5kcmF3SWRlbnRpdHkgPSBmdW5jdGlvbiAodHlwZSwgaWQpIHtcbiAgICAgICAgdmFyIGVsID0gRXhwYW5kYWJsZS5leHRlbmQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImdpdGxpbmUtaWRlbnRpdHlcIikpO1xuICAgICAgICBlbC5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCB0eXBlKTtcbiAgICAgICAgZWwuc2V0QXR0cmlidXRlKFwibmFtZVwiLCBpZC5uYW1lKTtcbiAgICAgICAgdmFyIGZ1bGxuYW1lID0gaWQubmFtZSArIFwiICZsdDtcIiArIGlkLmVtYWlsLnRvTG93ZXJDYXNlKCkgKyBcIiZndDtcIjtcbiAgICAgICAgZWwuc2V0QXR0cmlidXRlKFwidGl0bGVcIiwgZnVsbG5hbWUpO1xuICAgICAgICBlbC5zdHlsZS5iYWNrZ3JvdW5kID0gdGhpcy5jb25maWcuYXZhdGFycy5tYXAoZnVuY3Rpb24gKGYpIHsgcmV0dXJuIFwidXJsKFwiICsgZihpZC5lbWFpbCkgKyBcIikgbm8tcmVwZWF0XCI7IH0pLmpvaW4oXCIsIFwiKTtcbiAgICAgICAgZWwud2hlbkZ1bGwoZnVsbG5hbWUpO1xuICAgICAgICBlbC53aGVuU2hvcnQoXCIgXCIpO1xuICAgICAgICByZXR1cm4gZWw7XG4gICAgfTtcbiAgICAvKlxuICAgICAgICBCYXNlZCBvbiB0aGUgc3BlY2lmaXR5IGFzc2lnbiB0aGUgYnJhbmNoZXMgdG8gdGhlIGNvbW1pdHMuIGlmIGluIGRvdWJ0IHRoZSBjb21taXQgd2lsbCBiZSBvbiB0aGUgbW9zdCBzcGVjaWZpYyBicmFuY2hcbiAgICAqL1xuICAgIEdpdGxpbmUucHJvdG90eXBlLmluaXRCcmFuY2hlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGhlYWRzID0gT2JqZWN0LmtleXModGhpcy5oZWFkc01hcCk7XG4gICAgICAgIC8qIHNldCB0aGUgaW5kZXggdG8gdGhlIGhlYWQgb2JqZWN0ICovXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaGVhZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBoZWFkTmFtZSA9IGhlYWRzW2ldO1xuICAgICAgICAgICAgdmFyIGhlYWQgPSB0aGlzLmhlYWRzTWFwW2hlYWROYW1lXTtcbiAgICAgICAgICAgIGhlYWQuY29tbWl0LmluaXREZWZhdWx0QnJhbmNoKCk7XG4gICAgICAgIH1cbiAgICAgICAgLyogU29ydCB0aGUgYnJhbmNoZXMgYnkgc3BlY2lmaXR5ICovXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgaGVhZHMuc29ydChmdW5jdGlvbiAobCwgcikge1xuICAgICAgICAgICAgdmFyIGxIZWFkID0gc2VsZi5oZWFkc01hcFtsXS5jb21taXQ7XG4gICAgICAgICAgICB2YXIgckhlYWQgPSBzZWxmLmhlYWRzTWFwW3JdLmNvbW1pdDtcbiAgICAgICAgICAgIGlmIChsSGVhZCA9PT0gckhlYWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChsSGVhZC5icmFuY2guY2F0ZWdvcnkgPT09IHJIZWFkLmJyYW5jaC5jYXRlZ29yeSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBsSGVhZC5icmFuY2guc3BlY2lmaXR5IC0gckhlYWQuYnJhbmNoLnNwZWNpZml0eTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBsSGVhZC5icmFuY2guY2F0ZWdvcnkubGVuZ3RoIC0gckhlYWQuYnJhbmNoLmNhdGVnb3J5Lmxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8qIHNldCB0aGUgaW5kZXggdG8gdGhlIGhlYWQgb2JqZWN0ICovXG4gICAgICAgIHZhciBtYXhMYW5lID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBoZWFkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGhlYWROYW1lID0gaGVhZHNbaV07XG4gICAgICAgICAgICB2YXIgaGVhZCA9IHRoaXMuaGVhZHNNYXBbaGVhZE5hbWVdO1xuICAgICAgICAgICAgdmFyIHRpcCA9IGhlYWQuY29tbWl0O1xuICAgICAgICAgICAgaWYgKHRpcC5icmFuY2ggPT09IGhlYWQpIHtcbiAgICAgICAgICAgICAgICBoZWFkLmxhbmUgPSBtYXhMYW5lO1xuICAgICAgICAgICAgICAgIC8vaGVhZC5pbmRleCA9IG1heExhbmU7XG4gICAgICAgICAgICAgICAgbWF4TGFuZSsrO1xuICAgICAgICAgICAgICAgIC8vIENhbiB3ZSBkaXNwbGF5IHRoaXMgaGVhZCBhIGxpdHRsZSBtb3JlIHRvIHRoZSBsZWZ0P1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGwgPSAwOyBsIDwgaGVhZHMubGVuZ3RoOyBsKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNhblVzZUxhbmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGhlYWRzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgamhlYWROYW1lID0gaGVhZHNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGVhZE9uTGFuZSA9IHRoaXMuaGVhZHNNYXBbamhlYWROYW1lXS5jb21taXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGVhZE9uTGFuZSA9PT0gdW5kZWZpbmVkIHx8IGhlYWRPbkxhbmUuYnJhbmNoICE9IGhlYWQgJiYgaGVhZE9uTGFuZS5icmFuY2gubGFuZSA9PT0gbCAmJiAodGlwLmludGVyc2VjdHMoaGVhZE9uTGFuZSkgfHwgdGlwLmJyYW5jaC5jYXRlZ29yeSAhPSBoZWFkT25MYW5lLmJyYW5jaC5jYXRlZ29yeSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYW5Vc2VMYW5lID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNhblVzZUxhbmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIExvZ2dlci5kZWJ1ZyhcIk5PIElOVEVSU0VDVFM6IFwiLCB0aXAuYnJhbmNoLnJlZiwgXCIgLSBcIiwgaGVhZE9uTGFuZS5icmFuY2gucmVmKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWQubGFuZSA9IGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLm1heFggPSBNYXRoLm1heCh0aGlzLm1heFgsIGhlYWQubGFuZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8vIExhdW5jaGluZ1xuICAgIEdpdGxpbmUucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb25GaWxlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZyb21Qcm92aWRlcihuZXcgTG9jYWxHaXQySnNvblByb3ZpZGVyKGpzb25GaWxlKSk7XG4gICAgfTtcbiAgICBHaXRsaW5lLnByb3RvdHlwZS5mcm9tUHJvdmlkZXIgPSBmdW5jdGlvbiAoY29tbWl0UHJvdmlkZXIpIHtcbiAgICAgICAgdGhpcy5jb21taXRQcm92aWRlciA9IGNvbW1pdFByb3ZpZGVyO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIEdpdGxpbmUucHJvdG90eXBlLnJlbmRlclRvID0gZnVuY3Rpb24gKHBhbmVsKSB7XG4gICAgICAgIGlmICh0aGlzLmhlYWRlclBhbmVsICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHBhbmVsLmFwcGVuZENoaWxkKHRoaXMuaGVhZGVyUGFuZWwpO1xuICAgICAgICB9XG4gICAgICAgIHBhbmVsLmFwcGVuZENoaWxkKHRoaXMubG9hZGluZ1BhbmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImdpdGxpbmUtbG9hZGluZ3BhbmVsXCIpKTtcbiAgICAgICAgcGFuZWwuYXBwZW5kQ2hpbGQodGhpcy5jb250ZW50UGFuZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZ2l0bGluZS1jb250ZW50cGFuZWxcIikpO1xuICAgICAgICB0aGlzLmNvbnRlbnRQYW5lbC5hcHBlbmRDaGlsZCh0aGlzLmdyYXBoaWNhbFBhbmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImdpdGxpbmUtZ3JhcGhpY2FscGFuZWxcIikpO1xuICAgICAgICB0aGlzLmNvbnRlbnRQYW5lbC5hcHBlbmRDaGlsZCh0aGlzLnRleHRQYW5lbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJnaXRsaW5lLXRleHRwYW5lbFwiKSk7XG4gICAgICAgIHRoaXMuYWwgPSBuZXcgQXN5bmNMb2FkZXIodGhpcy5sb2FkaW5nUGFuZWwpO1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIEdpdGxpbmUucHJvdG90eXBlLndpdGhIZWFkZXIgPSBmdW5jdGlvbiAoaGVhZGVyKSB7XG4gICAgICAgIGlmICh0eXBlb2YgaGVhZGVyID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB0aGlzLmhlYWRlclBhbmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImdpdGxpbmUtaGVhZGVycGFuZWxcIik7XG4gICAgICAgICAgICB0aGlzLmhlYWRlclBhbmVsLmlubmVySFRNTCA9IGhlYWRlcjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaGVhZGVyUGFuZWwgPSBoZWFkZXI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBHaXRsaW5lLmRpc3BsYXlGYXRhbEVycm9yID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgYWxlcnQobWVzc2FnZSk7XG4gICAgfTtcbiAgICByZXR1cm4gR2l0bGluZTtcbn0pKCk7XG4vKipcbiAqIGJhc2ljIHN1cHBvcnQgZm9yIGpzZ2wgc2hhcGVzXG4gKi9cbnZhciBTaGFwZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU2hhcGUoY2FudmFzLCBlbGVtZW50KSB7XG4gICAgICAgIHRoaXMuZGVwZW5kZW5jaWVzID0gW107XG4gICAgICAgIHRoaXMuY2FudmFzID0gY2FudmFzO1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgIH1cbiAgICBTaGFwZS5wcm90b3R5cGUuYWRkSWZNaXNzaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5lbGVtZW50ICE9PSB1bmRlZmluZWQgJiYgdGhpcy5yZW5kZXJlZFRvID09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuYWRkRWxlbWVudHMoKTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZWRUbyA9IHRoaXMuY2FudmFzO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTaGFwZS5wcm90b3R5cGUuYWRkRWxlbWVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY2FudmFzLmFkZEVsZW1lbnQodGhpcy5lbGVtZW50KTtcbiAgICB9O1xuICAgIFNoYXBlLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZGVwZW5kZW5jaWVzLmZvckVhY2goZnVuY3Rpb24gKGRlcCkge1xuICAgICAgICAgICAgZGVwLnVwZGF0ZSgpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFNoYXBlLnByb3RvdHlwZS5kZXBlbmRzT24gPSBmdW5jdGlvbiAob24pIHtcbiAgICAgICAgb24uZGVwZW5kZW5jaWVzLnB1c2godGhpcyk7XG4gICAgfTtcbiAgICByZXR1cm4gU2hhcGU7XG59KSgpO1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIlNoYXBlLnRzXCIvPlxuLyoqXG4gKiBOZXcgdHlwZXNjcmlwdCBmaWxlXG4gKi9cbnZhciBEb3QgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhEb3QsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRG90KGNhbnZhcykge1xuICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBjYW52YXMsIGNhbnZhcy5jcmVhdGVSZWN0YW5nbGUoKSk7XG4gICAgfVxuICAgIERvdC5wcm90b3R5cGUuc2l6ZSA9IGZ1bmN0aW9uICh3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgIHRoaXMuZWxlbWVudC5zZXRXaWR0aCh3aWR0aCk7XG4gICAgICAgIHRoaXMuZWxlbWVudC5zZXRIZWlnaHQoaGVpZ2h0KTtcbiAgICAgICAgdGhpcy5lbGVtZW50LnNldFhSYWRpdXMod2lkdGggLyA0KTtcbiAgICAgICAgdGhpcy5lbGVtZW50LnNldFlSYWRpdXMod2lkdGggLyA0KTtcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICAgICAgdGhpcy5hZGRJZk1pc3NpbmcoKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBEb3QucHJvdG90eXBlLmF0ID0gZnVuY3Rpb24gKHgsIHkpIHtcbiAgICAgICAgdGhpcy54ID0geDtcbiAgICAgICAgdGhpcy55ID0geTtcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICAgICAgdGhpcy5hZGRJZk1pc3NpbmcoKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBEb3QucHJvdG90eXBlLmNvbG9yID0gZnVuY3Rpb24gKHN0cm9rZUNvbG9yLCBmaWxsQ29sb3IpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LmdldFN0cm9rZSgpLnNldFdlaWdodCgxKTtcbiAgICAgICAgdGhpcy5lbGVtZW50LmdldFN0cm9rZSgpLnNldENvbG9yKHN0cm9rZUNvbG9yKTtcbiAgICAgICAgdGhpcy5lbGVtZW50LmdldEZpbGwoKS5zZXRDb2xvcihmaWxsQ29sb3IpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIERvdC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQuc2V0TG9jYXRpb25YWSh0aGlzLnggLSB0aGlzLndpZHRoIC8gMiwgdGhpcy55IC0gdGhpcy5oZWlnaHQgLyAyKTtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS51cGRhdGUuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIHJldHVybiBEb3Q7XG59KShTaGFwZSk7XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiU2hhcGUudHNcIi8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiRG90LnRzXCIvPlxuLyoqXG4gKiBTaGFwZSB0aGF0IGxpbmtzIHR3byBkb3RzXG4gKi9cbnZhciBCYXNlTGluayA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEJhc2VMaW5rLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEJhc2VMaW5rKGNhbnZhcywgZWxlbWVudCkge1xuICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBjYW52YXMsIGVsZW1lbnQpO1xuICAgIH1cbiAgICBCYXNlTGluay5wcm90b3R5cGUuZnJvbSA9IGZ1bmN0aW9uIChmcm9tKSB7XG4gICAgICAgIHRoaXMuZGVwZW5kc09uKGZyb20pO1xuICAgICAgICB0aGlzLnBhcmVudERvdCA9IGZyb207XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgQmFzZUxpbmsucHJvdG90eXBlLnRvID0gZnVuY3Rpb24gKHRvKSB7XG4gICAgICAgIC8vdGhpcy5kZXBlbmRzT24odG8pO1xuICAgICAgICB0aGlzLmNoaWxkRG90ID0gdG87XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgQmFzZUxpbmsucHJvdG90eXBlLmNvbG9yID0gZnVuY3Rpb24gKGxpbmVDb2xvcikge1xuICAgICAgICB0aGlzLmVsZW1lbnQuZ2V0U3Ryb2tlKCkuc2V0V2VpZ2h0KDEpO1xuICAgICAgICB0aGlzLmVsZW1lbnQuZ2V0U3Ryb2tlKCkuc2V0Q29sb3IobGluZUNvbG9yKTtcbiAgICAgICAgdGhpcy5saW5lQ29sb3IgPSBsaW5lQ29sb3I7XG4gICAgICAgIHRoaXMuYWRkSWZNaXNzaW5nKCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgcmV0dXJuIEJhc2VMaW5rO1xufSkoU2hhcGUpO1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIkJhc2VMaW5rLnRzXCIvPlxudmFyIEN1cnZlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQ3VydmUsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQ3VydmUoY2FudmFzKSB7XG4gICAgICAgIF9zdXBlci5jYWxsKHRoaXMsIGNhbnZhcywgY2FudmFzLmNyZWF0ZUN1cnZlKCkpO1xuICAgICAgICB0aGlzLmFycm93ID0gdGhpcy5jYW52YXMuY3JlYXRlUG9seWdvbigpO1xuICAgIH1cbiAgICBDdXJ2ZS5wcm90b3R5cGUuYWRkRWxlbWVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuYWRkRWxlbWVudHMuY2FsbCh0aGlzKTtcbiAgICAgICAgLy8gMm5kIGVsZW1lbnRcbiAgICAgICAgdGhpcy5jYW52YXMuYWRkRWxlbWVudCh0aGlzLmFycm93KTtcbiAgICB9O1xuICAgIEN1cnZlLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB4ID0gdGhpcy5jaGlsZERvdC54O1xuICAgICAgICB2YXIgeSA9IHRoaXMuY2hpbGREb3QueTtcbiAgICAgICAgdmFyIHBhcmVudFggPSB0aGlzLnBhcmVudERvdC54O1xuICAgICAgICB2YXIgcGFyZW50WSA9IHRoaXMucGFyZW50RG90Lnk7XG4gICAgICAgIHZhciBjb2xvciA9IHRoaXMubGluZUNvbG9yO1xuICAgICAgICB2YXIgZGlyZWN0aW9uID0geCA8IHBhcmVudFggPyAxIDogLTE7XG4gICAgICAgIHRoaXMuZWxlbWVudC5zZXRTdGFydFBvaW50WFkocGFyZW50WCwgcGFyZW50WSAtIHRoaXMucGFyZW50RG90LmhlaWdodCAvIDIpO1xuICAgICAgICB0aGlzLmVsZW1lbnQuc2V0RW5kUG9pbnRYWSh4ICsgdGhpcy5jaGlsZERvdC53aWR0aCAvIDIgKiBkaXJlY3Rpb24sIHkpO1xuICAgICAgICB0aGlzLmVsZW1lbnQuc2V0Q29udHJvbDJQb2ludFhZKHBhcmVudFgsIHkpO1xuICAgICAgICB0aGlzLmVsZW1lbnQuc2V0Q29udHJvbDFQb2ludFhZKHBhcmVudFgsIHkpO1xuICAgICAgICB0aGlzLmVsZW1lbnQuZ2V0U3Ryb2tlKCkuc2V0V2VpZ2h0KDEpO1xuICAgICAgICB0aGlzLmVsZW1lbnQuZ2V0U3Ryb2tlKCkuc2V0Q29sb3IoY29sb3IpO1xuICAgICAgICB0aGlzLmFycm93LmdldFN0cm9rZSgpLnNldFdlaWdodCgwKTtcbiAgICAgICAgdGhpcy5hcnJvdy5nZXRGaWxsKCkuc2V0Q29sb3IoY29sb3IpO1xuICAgICAgICB0aGlzLmFycm93LmNsZWFyUG9pbnRzKCk7XG4gICAgICAgIHRoaXMuYXJyb3cuYWRkUG9pbnRYWSgwLCAwKTtcbiAgICAgICAgdGhpcy5hcnJvdy5hZGRQb2ludFhZKDYsIC00KTtcbiAgICAgICAgdGhpcy5hcnJvdy5hZGRQb2ludFhZKDYsIDQpO1xuICAgICAgICAvLyBNb3ZlXHRcdFx0XHRcdFxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuYXJyb3cuZ2V0UG9pbnRzQ291bnQoKTsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgcHggPSB0aGlzLmFycm93LmdldFBvaW50QXQoaSkuWDtcbiAgICAgICAgICAgIHZhciBweSA9IHRoaXMuYXJyb3cuZ2V0UG9pbnRBdChpKS5ZO1xuICAgICAgICAgICAgLy90aGlzLmFycm93LnNldFBvaW50WFlBdChweCwgcHkgKyB5LCBpKTtcbiAgICAgICAgICAgIHRoaXMuYXJyb3cuc2V0UG9pbnRYWUF0KHB4ICogZGlyZWN0aW9uICsgeCArIHRoaXMuY2hpbGREb3Qud2lkdGggLyAyICogZGlyZWN0aW9uLCBweSArIHksIGkpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gQ3VydmU7XG59KShCYXNlTGluayk7XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiQmFzZUxpbmsudHNcIi8+XG4vKipcbiAqIE5ldyB0eXBlc2NyaXB0IGZpbGVcbiAqL1xudmFyIFN0cmFpZ2h0ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU3RyYWlnaHQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3RyYWlnaHQoY2FudmFzKSB7XG4gICAgICAgIF9zdXBlci5jYWxsKHRoaXMsIGNhbnZhcywgY2FudmFzLmNyZWF0ZUxpbmUoKSk7XG4gICAgfVxuICAgIFN0cmFpZ2h0LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUudXBkYXRlLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuZWxlbWVudC5zZXRTdGFydFBvaW50WFkodGhpcy5wYXJlbnREb3QueCwgdGhpcy5wYXJlbnREb3QueSAtIHRoaXMucGFyZW50RG90LmhlaWdodCAvIDIpO1xuICAgICAgICB0aGlzLmVsZW1lbnQuc2V0RW5kUG9pbnRYWSh0aGlzLmNoaWxkRG90LngsIHRoaXMuY2hpbGREb3QueSArIHRoaXMuY2hpbGREb3QuaGVpZ2h0IC8gMik7XG4gICAgfTtcbiAgICByZXR1cm4gU3RyYWlnaHQ7XG59KShCYXNlTGluayk7XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiU2hhcGUudHNcIi8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiRG90LnRzXCIvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIlN0cmFpZ2h0LnRzXCIvPlxudmFyIENyZWF0aW9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQ3JlYXRpb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQ3JlYXRpb24oY2FudmFzKSB7XG4gICAgICAgIF9zdXBlci5jYWxsKHRoaXMsIGNhbnZhcywgY2FudmFzLmNyZWF0ZUxpbmUoKSk7XG4gICAgICAgIHRoaXMuc2Vjb25kTGluZSA9IGNhbnZhcy5jcmVhdGVMaW5lKCk7XG4gICAgfVxuICAgIENyZWF0aW9uLnByb3RvdHlwZS5hZGRFbGVtZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5hZGRFbGVtZW50cy5jYWxsKHRoaXMpO1xuICAgICAgICAvLyAybmQgZWxlbWVudFxuICAgICAgICB0aGlzLmNhbnZhcy5hZGRFbGVtZW50KHRoaXMuc2Vjb25kTGluZSk7IC8vIFRPRDogYWRkIGxhdGVyP1xuICAgIH07XG4gICAgQ3JlYXRpb24ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS51cGRhdGUuY2FsbCh0aGlzKTtcbiAgICAgICAgLy8gSG9yaXpvbnRhbCBkb3R0ZWQgbGluZVxuICAgICAgICBpZiAodGhpcy5wYXJlbnREb3QueCA8IHRoaXMuY2hpbGREb3QueCkge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnNldFN0YXJ0UG9pbnRYWSh0aGlzLnBhcmVudERvdC54ICsgdGhpcy5wYXJlbnREb3Qud2lkdGggLyAyLCB0aGlzLnBhcmVudERvdC55KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zZXRTdGFydFBvaW50WFkodGhpcy5wYXJlbnREb3QueCAtIHRoaXMucGFyZW50RG90LndpZHRoIC8gMiwgdGhpcy5wYXJlbnREb3QueSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5lbGVtZW50LnNldEVuZFBvaW50WFkodGhpcy5jaGlsZERvdC54LCB0aGlzLnBhcmVudERvdC55KTtcbiAgICAgICAgdGhpcy5lbGVtZW50LmdldFN0cm9rZSgpLnNldFdlaWdodCgxKTtcbiAgICAgICAgdGhpcy5lbGVtZW50LmdldFN0cm9rZSgpLnNldERhc2hTdHlsZShqc2dsLkRhc2hTdHlsZXMuREFTSCk7XG4gICAgICAgIHRoaXMuZWxlbWVudC5nZXRTdHJva2UoKS5zZXRDb2xvcih0aGlzLmxpbmVDb2xvcik7XG4gICAgICAgIC8vIFZlcnRpY2FsIGxpbmVcbiAgICAgICAgdGhpcy5zZWNvbmRMaW5lLnNldFN0YXJ0UG9pbnRYWSh0aGlzLmNoaWxkRG90LngsIHRoaXMucGFyZW50RG90LnkpO1xuICAgICAgICB0aGlzLnNlY29uZExpbmUuc2V0RW5kUG9pbnRYWSh0aGlzLmNoaWxkRG90LngsIHRoaXMuY2hpbGREb3QueSArIHRoaXMuY2hpbGREb3QuaGVpZ2h0IC8gMik7XG4gICAgICAgIHRoaXMuc2Vjb25kTGluZS5nZXRTdHJva2UoKS5zZXRXZWlnaHQoMSk7XG4gICAgICAgIHRoaXMuc2Vjb25kTGluZS5nZXRTdHJva2UoKS5zZXRDb2xvcih0aGlzLmxpbmVDb2xvcik7XG4gICAgfTtcbiAgICByZXR1cm4gQ3JlYXRpb247XG59KShCYXNlTGluayk7XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiQ29uZmlnLnRzXCIvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIkNvbW1pdC50c1wiLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJyZW5kZXJpbmcvQ3VydmUudHNcIi8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwicmVuZGVyaW5nL0RvdC50c1wiLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJyZW5kZXJpbmcvU3RyYWlnaHQudHNcIi8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwicmVuZGVyaW5nL0NyZWF0aW9uLnRzXCIvPlxuLyoqXG4gKiBWaWV3IG9mIHRoZSBDb21taXRcbiAqL1xudmFyIENvbW1pdFZpZXcgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENvbW1pdFZpZXcoY2FudmFzLCBjb25maWcsIGNvbW1pdCkge1xuICAgICAgICB0aGlzLmxpbmVzID0gW107XG4gICAgICAgIHRoaXMuY2FudmFzID0gY2FudmFzO1xuICAgICAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcbiAgICAgICAgdGhpcy5jb21taXQgPSBjb21taXQ7XG4gICAgICAgIHRoaXMuZG90ID0gbmV3IERvdCh0aGlzLmNhbnZhcyk7XG4gICAgfVxuICAgIENvbW1pdFZpZXcucHJvdG90eXBlLmFkZFJlbGF0aW9ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgLy8gRGlyZWN0IHBhcmVudFxuICAgICAgICBpZiAodGhpcy5jb21taXQuZGlyZWN0cGFyZW50ICE9IG51bGwpIHtcbiAgICAgICAgICAgIHZhciBkcGw7XG4gICAgICAgICAgICBpZiAodGhpcy5jb21taXQuZ2V0TGFuZSgpID09IHRoaXMuY29tbWl0LmRpcmVjdHBhcmVudC5nZXRMYW5lKCkgfHwgdGhpcy5jb21taXQuZGlyZWN0cGFyZW50Lm91dE9mU2NvcGUpIHtcbiAgICAgICAgICAgICAgICAvLyBkaXJlY3QgcGFyZW50IGlzIHRoZSBzYW1lIFgvbGFuZSwgdGhpcyBtZWFucyBpdCBpcyBhIHN0YW5kYXJkIGZvcndhcmQgY29tbWl0IFxuICAgICAgICAgICAgICAgIGRwbCA9IG5ldyBTdHJhaWdodCh0aGlzLmNhbnZhcykuZnJvbSh0aGlzLmNvbW1pdC5kaXJlY3RwYXJlbnQudmlldy5kb3QpLnRvKHRoaXMuZG90KS5jb2xvcih0aGlzLmNvbW1pdC5nZXRDb2xvcigyMCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gZGlyZWN0IHBhcmVudCBpcyBvbiBhIGRpZmZlcmVudCBsYW5lLCB0aGlzIGlzIG1vc3QgY2VydGFpbmx5IGEgbmV3IGJyYW5jaCBcbiAgICAgICAgICAgICAgICBkcGwgPSBuZXcgQ3JlYXRpb24odGhpcy5jYW52YXMpLmZyb20odGhpcy5jb21taXQuZGlyZWN0cGFyZW50LnZpZXcuZG90KS50byh0aGlzLmRvdCkuY29sb3IodGhpcy5jb21taXQuZ2V0Q29sb3IoMzApKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubGluZXMucHVzaChkcGwpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhbGxtZXJnZXMgPSB0aGlzLmNvbW1pdC5tZXJnZXMuc3RhbmRhcmQuY29uY2F0KHRoaXMuY29tbWl0Lm1lcmdlcy5hbm9ueW1vdXMpO1xuICAgICAgICBhbGxtZXJnZXMuZm9yRWFjaChmdW5jdGlvbiAobWVyZ2UpIHtcbiAgICAgICAgICAgIF90aGlzLmxpbmVzLnB1c2gobmV3IEN1cnZlKF90aGlzLmNhbnZhcylcbiAgICAgICAgICAgICAgICAuZnJvbShtZXJnZS5zb3VyY2Uudmlldy5kb3QpXG4gICAgICAgICAgICAgICAgLnRvKF90aGlzLmRvdClcbiAgICAgICAgICAgICAgICAuY29sb3IobWVyZ2Uuc291cmNlLmdldENvbG9yKDM1KSkpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKiBjYWxjdWxhdGUgdGhlIHBvc2l0aW9ucyBiYXNlZCBvbiBtb2RlbCBhbmQgdXBkYXRlIHRoZSBzaGFwZXMgKi9cbiAgICBDb21taXRWaWV3LnByb3RvdHlwZS5yZWRyYXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZG90XG4gICAgICAgICAgICAuYXQodGhpcy5jb21taXQuZ2V0WCgpLCB0aGlzLmNvbW1pdC5nZXRZKCkpXG4gICAgICAgICAgICAuc2l6ZSh0aGlzLmNvbmZpZy5kb3RXaWR0aCwgdGhpcy5jb25maWcuZG90SGVpZ2h0KVxuICAgICAgICAgICAgLmNvbG9yKHRoaXMuY29tbWl0LmdldENvbG9yKDIwKSwgdGhpcy5jb21taXQuZ2V0Q29sb3IoODApKTtcbiAgICB9O1xuICAgIHJldHVybiBDb21taXRWaWV3O1xufSkoKTtcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJCcmFuY2gudHNcIi8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiR2l0bGluZS50c1wiLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJDb21taXRWaWV3LnRzXCIvPlxuLyoqIGNvbW1pdHRlciBvciBhdXRob3IgKi9cbnZhciBJZGVudGl0eSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gSWRlbnRpdHkobmFtZSwgZW1haWwsIGRhdGUpIHtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy5lbWFpbCA9IGVtYWlsO1xuICAgICAgICB0aGlzLmRhdGUgPSBkYXRlO1xuICAgIH1cbiAgICByZXR1cm4gSWRlbnRpdHk7XG59KSgpO1xudmFyIENvbW1pdCA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ29tbWl0KGNvbnRhaW5lciwgZGF0YSkge1xuICAgICAgICB0aGlzLndhcm5pbmdzID0gW107XG4gICAgICAgIHRoaXMuaW5IZWFkc1JlZiA9IFtdO1xuICAgICAgICB0aGlzLnBhcmVudHMgPSBbXTtcbiAgICAgICAgdGhpcy5jaGlsZHMgPSBbXTtcbiAgICAgICAgdGhpcy5zaWJsaW5ncyA9IFtdO1xuICAgICAgICB0aGlzLm91dE9mU2NvcGUgPSBmYWxzZTsgLy8gVGhpcyBjb21taXQgd2FzIG5vdCBwYXJ0IG9mIHRoZSBsb2dzIHNjb3BlLCBidXQgaXMgcmVmZXJlbmNlZCBieSBhbm90aGVyIGNvbW1pdC5cbiAgICAgICAgdGhpcy5tZXJnZXMgPSB7IHN0YW5kYXJkOiBbXSwgYW5vbnltb3VzOiBbXSB9O1xuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgICAgICAgdGhpcy5kYXRhID0gZGF0YTtcbiAgICAgICAgLy8gcmVmZXJlbmNlIHRoZSBkYXRhIGJhY2sgdG8gdGhlIG9iamVjdFxuICAgICAgICB0aGlzLmRhdGEub2JqID0gdGhpcztcbiAgICAgICAgaWYgKGRhdGEuaW5IZWFkcyA9PSBudWxsKVxuICAgICAgICAgICAgZGF0YS5pbkhlYWRzID0gW107XG4gICAgICAgIGlmIChkYXRhLnBhcmVudGhhc2hlcyA9PSBudWxsKVxuICAgICAgICAgICAgZGF0YS5wYXJlbnRoYXNoZXMgPSBbXTtcbiAgICAgICAgaWYgKGRhdGEucmVmbmFtZXMgPT0gbnVsbClcbiAgICAgICAgICAgIGRhdGEucmVmbmFtZXMgPSBbXTtcbiAgICAgICAgdGhpcy5zaGEgPSBkYXRhLnNoYTtcbiAgICAgICAgdGhpcy5zc2hhID0gZGF0YS5zc2hhO1xuICAgICAgICB0aGlzLnN1YmplY3QgPSBkYXRhLnN1YmplY3Q7XG4gICAgICAgIHRoaXMuaW5kZXhZID0gY29udGFpbmVyLm1heEluZGV4WSsrO1xuICAgICAgICB0aGlzLmNvbW1pdHRlciA9IG5ldyBJZGVudGl0eSh0aGlzLmRhdGEuY29tbWl0dGVybmFtZSwgdGhpcy5kYXRhLmNvbW1pdHRlcmVtYWlsLCBuZXcgRGF0ZSh0aGlzLmRhdGEuY29tbWl0dGVyZGF0ZSkuZ2V0VGltZSgpKTtcbiAgICAgICAgdGhpcy5hdXRob3IgPSBuZXcgSWRlbnRpdHkodGhpcy5kYXRhLmF1dGhvcm5hbWUsIHRoaXMuZGF0YS5hdXRob3JlbWFpbCwgbmV3IERhdGUodGhpcy5kYXRhLmF1dGhvcmRhdGUpLmdldFRpbWUoKSk7XG4gICAgfVxuICAgIENvbW1pdC5wcm90b3R5cGUuZ2V0U2hvcnRTaGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNzaGE7XG4gICAgfTtcbiAgICBDb21taXQucHJvdG90eXBlLmdldEZ1bGxTaGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNoYTtcbiAgICB9O1xuICAgIENvbW1pdC5wcm90b3R5cGUuaW5pdFJlbGF0aW9ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLmRhdGEucGFyZW50aGFzaGVzLmZvckVhY2goZnVuY3Rpb24gKGhhc2gpIHtcbiAgICAgICAgICAgIHZhciBwYXJlbnRDb21taXQgPSBfdGhpcy5jb250YWluZXIuY29tbWl0c1toYXNoXTtcbiAgICAgICAgICAgIC8vIENyZWF0ZSBhIHZpcnR1YWwgY29tbWl0XG4gICAgICAgICAgICBpZiAocGFyZW50Q29tbWl0ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBwYXJlbnRDb21taXQgPSBuZXcgQ29tbWl0KF90aGlzLmNvbnRhaW5lciwgeyBzaGE6IGhhc2ggKyBNYXRoLnJhbmRvbSgpIH0pO1xuICAgICAgICAgICAgICAgIHBhcmVudENvbW1pdC5vdXRPZlNjb3BlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBzZWxmLmNvbnRhaW5lci5hZGRDb21taXQocGFyZW50Q29tbWl0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF90aGlzLnBhcmVudHMucHVzaChwYXJlbnRDb21taXQpO1xuICAgICAgICAgICAgcGFyZW50Q29tbWl0LmNoaWxkcy5wdXNoKF90aGlzKTtcbiAgICAgICAgICAgIF90aGlzLnNpYmxpbmdzID0gcGFyZW50Q29tbWl0LmNoaWxkczsgLy8gdGhpcyB3aWxsIGJlIG92ZXJ3aXR0ZW4gYXMgbmV3IGNoaWxkcyBhcmUgZm91bmRcbiAgICAgICAgICAgIGlmIChfdGhpcy5wYXJlbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgZHAgPSBfdGhpcy5wYXJlbnRzWzBdO1xuICAgICAgICAgICAgICAgIF90aGlzLmRpcmVjdHBhcmVudCA9IGRwO1xuICAgICAgICAgICAgICAgIGRwLmRpcmVjdGNoaWxkID0gX3RoaXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmRhdGEuaW5IZWFkcy5mb3JFYWNoKGZ1bmN0aW9uIChoZWFkc2hhKSB7XG4gICAgICAgICAgICB2YXIgY29tbWl0ID0gX3RoaXMuY29udGFpbmVyLmNvbW1pdHNbaGVhZHNoYV07XG4gICAgICAgICAgICBpZiAoX3RoaXMuaW5IZWFkc1JlZi5pbmRleE9mKGNvbW1pdCkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIF90aGlzLmluSGVhZHNSZWYucHVzaChjb21taXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIENvbW1pdC5wcm90b3R5cGUuaW5pdERlZmF1bHRCcmFuY2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjb21taXQgPSB0aGlzO1xuICAgICAgICB3aGlsZSAoY29tbWl0ICE9IG51bGwpIHtcbiAgICAgICAgICAgIC8vIEdVRVNTSU5HOiBUaGUgY29ycmVjdCBicmFuY2ggaXMgdXN1YWxseSB0aGUgb25lIHdpdGggdGhlIGxlYXN0IHNwZWNpZmljIG5hbWVcbiAgICAgICAgICAgIGlmIChjb21taXQuYnJhbmNoID09IG51bGwgfHwgY29tbWl0LmJyYW5jaC5zcGVjaWZpdHkgPiB0aGlzLmJyYW5jaC5zcGVjaWZpdHkpIHtcbiAgICAgICAgICAgICAgICBjb21taXQuYnJhbmNoID0gdGhpcy5icmFuY2g7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb21taXQuYnJhbmNoLnN0YXJ0ID0gY29tbWl0OyAvLyB0aGlzIGZ1bmN0aW9uIHdpbGwgdHJhdmVyc2UgdGhlIHBhcmVudHMsIHNvIHRoZSBsYXN0IG9uZSB3aWxsIGJlIHRoZSBmaXJzdCBjb21taXRcbiAgICAgICAgICAgIGNvbW1pdC5icmFuY2gub3JpZ2luID0gY29tbWl0LmRpcmVjdHBhcmVudDsgLy8gdGhpcyBjb3VsZCBiZSBudWxsIC0+IGl0IGlzIG91dHNpZGUgb2YgdGhlIGhpc3RvcnkuXG4gICAgICAgICAgICBjb21taXQgPSBjb21taXQuZGlyZWN0cGFyZW50O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDb21taXQucHJvdG90eXBlLmluaXRIZWFkU3BlY2lmaXR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZGF0YS5yZWZuYW1lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHJlZm5hbWUgPSB0aGlzLmRhdGEucmVmbmFtZXNbaV07XG4gICAgICAgICAgICBpZiAoIXRoaXMuY29udGFpbmVyLmNvbmZpZy5yZW1vdGVPbmx5IHx8IHJlZm5hbWUuaW5kZXhPZihcIm9yaWdpbi9cIikgPT0gMCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbnRhaW5lci5jb25maWcucmVtb3RlT25seSkge1xuICAgICAgICAgICAgICAgICAgICByZWZuYW1lID0gcmVmbmFtZS5yZXBsYWNlKC9eb3JpZ2luLi8sICcnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHNwZWNpZml0eSA9IHJlZm5hbWUucmVwbGFjZSgvW15cXC8tXS9nLCAnJykubGVuZ3RoICogMTAwMDtcbiAgICAgICAgICAgICAgICBzcGVjaWZpdHkgKz0gcmVmbmFtZS5yZXBsYWNlKC9bXmEtekEtWjAtOS1dLywgJycpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5hZGRCcmFuY2gocmVmbmFtZSwgdGhpcywgc3BlY2lmaXR5KTtcbiAgICAgICAgICAgICAgICAvKiBhc3NpZ24gdGhlIG1vc3Qgc3BlY2lmaWMgaGVhZCBvbiB0aGlzIHRpcCBjb21taXQgKi9cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5tYXhTcGVjaWZpdHkgPT0gbnVsbCB8fCBzcGVjaWZpdHkgPCB0aGlzLm1heFNwZWNpZml0eSkge1xuICAgICAgICAgICAgICAgICAgICBMb2dnZXIuZGVidWcoXCJhc3NpZ25pbmcgYnJhbmNoXCIsIHJlZm5hbWUsIHRoaXMuc2hhLCB0aGlzLm1heFNwZWNpZml0eSwgc3BlY2lmaXR5KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXhTcGVjaWZpdHkgPSBzcGVjaWZpdHk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnJhbmNoID0gdGhpcy5jb250YWluZXIuaGVhZHNNYXBbcmVmbmFtZV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuaW5pdERlZmF1bHRCcmFuY2goKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29tbWl0LnByb3RvdHlwZS5pbml0TWVyZ2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLm1lcmdlcyA9IHsgc3RhbmRhcmQ6IFtdLCBhbm9ueW1vdXM6IFtdIH07XG4gICAgICAgIHRoaXMud2FybmluZ3MgPSBbXTtcbiAgICAgICAgLy8gRGV0ZWN0IGEgbWVyZ2UgKG9jdG9wdXMgY3VycmVudGx5IG5vdCBzdXBwb3J0ZWQpXG4gICAgICAgIGlmICh0aGlzLnBhcmVudHMubGVuZ3RoID09IDEpIHtcbiAgICAgICAgICAgIHZhciBkcCA9IHRoaXMucGFyZW50c1swXTtcbiAgICAgICAgICAgIHRoaXMuZGlyZWN0cGFyZW50ID0gZHA7XG4gICAgICAgICAgICBkcC5kaXJlY3RjaGlsZCA9IHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGFyZW50cy5sZW5ndGggPj0gMikge1xuICAgICAgICAgICAgdmFyIGRwID0gdGhpcy5wYXJlbnRzWzBdO1xuICAgICAgICAgICAgdGhpcy5kaXJlY3RwYXJlbnQgPSBkcDtcbiAgICAgICAgICAgIGRwLmRpcmVjdGNoaWxkID0gdGhpcztcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgdGhpcy5wYXJlbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1wID0gdGhpcy5wYXJlbnRzW2ldO1xuICAgICAgICAgICAgICAgIGlmIChtcCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIENsdWVzIGlmIHRoaXMgaXMgYSBzdGFuZGFyZCBvciBhbm9ueW1vdXMgbWVyZ2VcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1wLmRhdGEucmVmbmFtZXMubGVuZ3RoID4gMCAvLyBUaGlzIGlzIHN0YW5kYXJkIG1lcmdlIHdpdGggbXBzIGhlYWRcbiAgICAgICAgICAgICAgICAgICAgICAgIHx8IG1wLmluSGVhZHNSZWYubGVuZ3RoICE9IGRwLmluSGVhZHNSZWYubGVuZ3RoIC8vIFRoZSBoZWFkcyBvZiBib3RoIGFyZSBkaWZmZXJlbnRcbiAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lcmdlcy5zdGFuZGFyZC5wdXNoKHsgc291cmNlOiBtcCB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgYSBhbm9ueW1vdXMgKGF1dG9tYXRpYykgbWVyZ2Ugb24gdGhlIHNhbWUgYnJhbmNoXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lcmdlcy5hbm9ueW1vdXMucHVzaCh7IHNvdXJjZTogbXAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRBbm9ueW1vdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29tbWl0LnByb3RvdHlwZS5pbml0QW5vbnltb3VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBDcmVhdGUgYSBkdW1teSBicmFuY2ggZm9yIGFub255bW91cyBtZXJnZXMsIHdoaWNoIGlzIGFzIHNwZWNpZmljIGFzIHRoZSBvcmlnaW5hbCBicmFuY2guIFxuICAgICAgICAvLyB0cnkgZmluZGluZyB0aGUgb3JpZ2luYWwgYnJhbmNoIGJ5IGdvaW5nIHVwIGRpcmVjdCBjaGlsZHMsIHdoaWNoIHdpbGwgZ2V0IHRoZSBvcmlnaW5hbFxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMubWVyZ2VzLmFub255bW91cy5mb3JFYWNoKGZ1bmN0aW9uIChfbWVyZ2UpIHtcbiAgICAgICAgICAgIHZhciBtZXJnZSA9IF9tZXJnZS5zb3VyY2U7XG4gICAgICAgICAgICB2YXIgY2hpbGQgPSBfdGhpcztcbiAgICAgICAgICAgIHdoaWxlIChjaGlsZCAhPSBudWxsICYmIGNoaWxkLmJyYW5jaCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY2hpbGQgPSBjaGlsZC5kaXJlY3RjaGlsZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qIHRoaXMgaXMgb25seSBhbiBhbm9ueW1vdXMgYnJhbmNoIGhlYWQsIGlmIHRoZXJlIGlzIG9ubHkgb25lIGNoaWxkICh0aGUgbWVyZ2UpXG4gICAgICAgICAgICAgICBUT0RPOiBpZiB0aGVyZSBhcmUgbXVsdGlwbGUsIGl0IG1pZ2h0IHJlc3VsdCBpbiB3cm9uZ2x5IGFzc2lnbmVkIGJyYW5jaGVzICovXG4gICAgICAgICAgICBpZiAoY2hpbGQgIT0gbnVsbCAmJiBtZXJnZS5icmFuY2ggPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIG1lcmdlLmJyYW5jaCA9IG5ldyBCcmFuY2goY2hpbGQuYnJhbmNoLnJlZiArIFwiL2Fub255bW91c1wiICsgbWVyZ2Uuc2hhICsgTWF0aC5yYW5kb20oKSwgbWVyZ2UsIGNoaWxkLmJyYW5jaC5zcGVjaWZpdHkgKyAxKTtcbiAgICAgICAgICAgICAgICBtZXJnZS5icmFuY2guYW5vbnltb3VzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBtZXJnZS5icmFuY2gucGFyZW50ID0gY2hpbGQuYnJhbmNoO1xuICAgICAgICAgICAgICAgIG1lcmdlLmJyYW5jaC5zdGFydCA9IGNoaWxkO1xuICAgICAgICAgICAgICAgIG1lcmdlLmJyYW5jaC5jYXRlZ29yeSA9IGNoaWxkLmJyYW5jaC5jYXRlZ29yeTtcbiAgICAgICAgICAgICAgICBfdGhpcy5jb250YWluZXIuaGVhZHNNYXBbbWVyZ2UuYnJhbmNoLnJlZl0gPSBtZXJnZS5icmFuY2g7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQ29tbWl0LnByb3RvdHlwZS5nZXRDb2xvciA9IGZ1bmN0aW9uIChsaWdodG5lc3MpIHtcbiAgICAgICAgaWYgKHRoaXMuYnJhbmNoID09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMud2FybihcIk5vIEJyYW5jaCBzZXRcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgYiA9IHRoaXMuYnJhbmNoO1xuICAgICAgICAgICAgaWYgKHRoaXMuYnJhbmNoLmFub255bW91cykge1xuICAgICAgICAgICAgICAgIGIgPSB0aGlzLmJyYW5jaC5wYXJlbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgaHVlID0gYi5sYW5lICogMzAwIC8gdGhpcy5jb250YWluZXIubWF4WDtcbiAgICAgICAgICAgIHJldHVybiBcImhzbChcIiArIGh1ZSArIFwiLCAxMDAlLCBcIiArIGxpZ2h0bmVzcyArIFwiJSlcIjtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29tbWl0LnByb3RvdHlwZS5oYXNNZXJnZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1lcmdlcy5zdGFuZGFyZC5sZW5ndGggPiAwIHx8IHRoaXMubWVyZ2VzLmFub255bW91cy5sZW5ndGggPiAwO1xuICAgIH07XG4gICAgQ29tbWl0LnByb3RvdHlwZS5nZXRYID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gaW5kZXhUb1godGhpcy5nZXRMYW5lKCkpO1xuICAgIH07XG4gICAgQ29tbWl0LnByb3RvdHlwZS5nZXRZID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5vdXRPZlNjb3BlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb250YWluZXIucm9vdExhYmVsLm9mZnNldFRvcCArIDIwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnZpZXcubGFiZWwub2Zmc2V0VG9wIC0gdGhpcy5jb250YWluZXIuZmlyc3RDb21taXQudmlldy5sYWJlbC5vZmZzZXRUb3AgKyB0aGlzLnZpZXcubGFiZWwub2Zmc2V0SGVpZ2h0IC8gMjtcbiAgICB9O1xuICAgIENvbW1pdC5wcm90b3R5cGUuZ2V0T3JpZ2luSW5kZXhZID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5icmFuY2gub3JpZ2luICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYnJhbmNoLm9yaWdpbi5nZXRJbmRleFkoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmJyYW5jaC5zdGFydC5vdXRPZlNjb3BlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb250YWluZXIubWF4SW5kZXhZO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYnJhbmNoLnN0YXJ0LmluZGV4WTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29tbWl0LnByb3RvdHlwZS5pbnRlcnNlY3RzID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgICAgIHZhciBvdGhlclkgPSA5OTk5OTk5LCB0aGlzWSA9IDk5OTk5OTtcbiAgICAgICAgaWYgKHRoaXMub3V0T2ZTY29wZSB8fCBvdGhlci5vdXRPZlNjb3BlKVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIGlmIChvdGhlci5kaXJlY3RjaGlsZCAhPSBudWxsKSB7XG4gICAgICAgICAgICBvdGhlclkgPSBvdGhlci5kaXJlY3RjaGlsZC5pbmRleFk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZGlyZWN0Y2hpbGQgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpc1kgPSB0aGlzLmRpcmVjdGNoaWxkLmluZGV4WTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5nZXRPcmlnaW5JbmRleFkoKSA+PSBNYXRoLm1pbihvdGhlci5pbmRleFksIG90aGVyWSkgJiYgTWF0aC5taW4odGhpc1ksIHRoaXMuaW5kZXhZKSA8PSBvdGhlci5nZXRPcmlnaW5JbmRleFkoKTtcbiAgICB9O1xuICAgIENvbW1pdC5wcm90b3R5cGUuZ2V0SW5kZXggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEuaW5kZXg7XG4gICAgfTtcbiAgICBDb21taXQucHJvdG90eXBlLmdldEluZGV4WSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5kZXhZO1xuICAgIH07XG4gICAgQ29tbWl0LnByb3RvdHlwZS53YXJuID0gZnVuY3Rpb24gKHdhcm5pbmcpIHtcbiAgICAgICAgdGhpcy53YXJuaW5ncy5wdXNoKHdhcm5pbmcpO1xuICAgICAgICB0aGlzLmRlYnVnKHdhcm5pbmcpO1xuICAgIH07XG4gICAgQ29tbWl0LnByb3RvdHlwZS5kZWJ1ZyA9IGZ1bmN0aW9uICh3YXJuaW5nKSB7XG4gICAgICAgIGlmIChjb25zb2xlKSB7XG4gICAgICAgICAgICBMb2dnZXIuZGVidWcod2FybmluZywgdGhpcyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENvbW1pdC5wcm90b3R5cGUuZ2V0TGFuZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuYnJhbmNoICE9IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJyYW5jaC5jb21taXQuYnJhbmNoLmxhbmU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICByZXR1cm4gQ29tbWl0O1xufSkoKTtcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJDb21taXQudHNcIi8+XG52YXIgQnJhbmNoID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBCcmFuY2gocmVmbmFtZSwgY29tbWl0LCBzcGVjaWZpdHkpIHtcbiAgICAgICAgdGhpcy5yZWYgPSByZWZuYW1lO1xuICAgICAgICB0aGlzLmNvbW1pdCA9IGNvbW1pdDtcbiAgICAgICAgdGhpcy5zcGVjaWZpdHkgPSBzcGVjaWZpdHk7XG4gICAgICAgIHRoaXMuc2hvcnRuYW1lID0gcmVmbmFtZS5zcGxpdChcIkBcIilbMF07XG4gICAgICAgIHRoaXMuY2F0ZWdvcnkgPSB0aGlzLnNob3J0bmFtZS5zdWJzdHJpbmcoMCwgdGhpcy5zaG9ydG5hbWUubGFzdEluZGV4T2YoXCIvXCIpKTtcbiAgICB9XG4gICAgcmV0dXJuIEJyYW5jaDtcbn0pKCk7XG5cbiIsIi8qKlxyXG4gKiBOZXcgdHlwZXNjcmlwdCBmaWxlXHJcbiAqL1xyXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vQ29tbWl0UHJvdmlkZXIudHNcIi8+XHJcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9HaXRsaW5lLnRzXCIvPlxyXG5kZWNsYXJlIHZhciBqUXVlcnk6IGFueTtcclxuZGVjbGFyZSB2YXIgTG9nZ2VyOiBhbnk7XHJcblxyXG5jbGFzcyBMb2NhbEdpdDJKc29uUHJvdmlkZXIgZXh0ZW5kcyBDb21taXRQcm92aWRlciB7XHJcblx0XHJcblx0cHVibGljIG9uUmVxdWVzdGVkKHVybDogc3RyaW5nKSB7XHJcblx0XHRcclxuXHRcdGpRdWVyeS5nZXRKU09OKHVybCwge30sIChqc29uKSA9PiB7XHJcblx0XHRcdHRoaXMud2hlbkRvbmUoanNvbik7XHJcblx0XHR9KS5lcnJvcihmdW5jdGlvbigpIHtcclxuXHRcdFx0R2l0bGluZS5kaXNwbGF5RmF0YWxFcnJvcihcIkVycm9yIGxvYWRpbmcgZ2l0IGRhdGEgZnJvbSBcIit1cmwrIFwiIGNyZWF0ZSBpdCB1c2luZyBnaXQyanNvblwiKTtcclxuXHRcdH0pO1xyXG5cdH1cclxufSIsIi8qKlxyXG4gKiBHaXRodWIgY29tbWl0IHByb3ZpZGVyLiBvbmx5IHdvcmtzIGlmIHRoZXJlIGlzIGFuZCBhY2Nlc3N0b2tlbiBjb25maWd1cmVkIGluIHRoZSBicm93c2VyXHJcbiAqL1xyXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vQ29tbWl0UHJvdmlkZXIudHNcIi8+XHJcbmRlY2xhcmUgdmFyIGpRdWVyeTogYW55O1xyXG5kZWNsYXJlIHZhciBMb2dnZXI6IGFueTtcclxuXHJcbmNsYXNzIEdpdGh1YkNvbW1pdFByb3ZpZGVyIGV4dGVuZHMgQ29tbWl0UHJvdmlkZXIge1xyXG5cclxuXHRwcml2YXRlIGZvcmtzOiBhbnlbXSA9IFtdO1xyXG5cdHByaXZhdGUgYmFzZUNvbW1pdHM6IGFueVtdO1xyXG5cdHByaXZhdGUgYmFzZUJyYW5jaGVzOiBhbnlbXSA9IFtdO1xyXG5cdHByaXZhdGUgZGF0YSA6IHt9ID0ge307XHJcblx0XHRcclxuXHRwcml2YXRlIGxpbWl0O1xyXG5cdHByaXZhdGUgYWNjZXNzVG9rZW46IHN0cmluZztcclxuXHRwcml2YXRlIGRvbmU6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHRcclxuXHRjb25zdHJ1Y3RvciAodXJsOiBzdHJpbmcsIGxpbWl0OiBudW1iZXIsIGFjY2Vzc1Rva2VuOiBzdHJpbmcpIHtcclxuXHRcdHN1cGVyKHVybCk7XHJcblx0XHR0aGlzLmFjY2Vzc1Rva2VuID0gYWNjZXNzVG9rZW47XHJcblx0XHR0aGlzLmxpbWl0ID0gbGltaXQ7XHJcblx0fVxyXG5cdFxyXG5cdHB1YmxpYyBnaXRVUkwodXJsOiBzdHJpbmcsIGFwaTogc3RyaW5nLCBwYXJhbXM6IHN0cmluZyA9IFwiXCIpIHtcclxuXHJcblx0XHQvLyBjb252ZXJ0IHRvIGFwaSB1cmwgYW5kIHJlbW92ZSB0cmFpbGluZyAvXHJcblx0XHRpZih1cmwuaW5kZXhPZihcImFwaS5naXRodWIuY29tXCIpID09IC0xKSB7XHJcblx0XHRcdHVybCA9IHVybC5yZXBsYWNlKC8uKmdpdGh1Yi5jb20vLCBcImh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vcmVwb3MvXCIpLnJlcGxhY2UoL1xcL1xcLy9nLCBcIi9cIik7XHJcblx0XHRcdFx0XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gdXJsICsgXCIvXCIrYXBpK1wiP2FjY2Vzc190b2tlbj1cIit0aGlzLmFjY2Vzc1Rva2VuK1wiJnBlcl9wYWdlPVwiK3RoaXMubGltaXQrXCImY2FsbGJhY2s9PyZcIitwYXJhbXM7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgb25SZXF1ZXN0ZWQodXJsOiBzdHJpbmcpIHtcclxuXHRcdHRoaXMubG9hZEZvcmtzKHVybClcclxuXHR9XHJcblx0XHJcblx0cHVibGljIGxvYWRGb3Jrcyh1cmw6IHN0cmluZykge1xyXG5cdFx0alF1ZXJ5LndoZW4oXHJcblx0XHRcdFx0alF1ZXJ5LmdldEpTT04odGhpcy5naXRVUkwodXJsLCBcImZvcmtzXCIpKSxcclxuXHRcdFx0XHRqUXVlcnkuZ2V0SlNPTih0aGlzLmdpdFVSTCh1cmwsIFwiYnJhbmNoZXNcIikpXHJcblx0XHRcdCkudGhlbiggKGZvcmtzLCBicmFuY2hlcykgPT4ge1xyXG5cdFx0XHRcdC8vdGhpcy5iYXNlQ29tbWl0cyA9IGNvbW1pdHNbMF0uZGF0YTtcclxuXHRcdFx0XHR0aGlzLnByb2Nlc3NCcmFuY2hlcyh1cmwsIGJyYW5jaGVzWzBdLmRhdGEpO1xyXG5cdFx0XHRcdHRoaXMuZm9ya3MgPSBmb3Jrc1swXS5kYXRhO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdHRoaXMubG9hZEJyYW5jaGVzKCk7XHJcblx0XHRcdH0pO1xyXG5cdFx0XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgcHJvY2Vzc0JyYW5jaGVzKGZvcmssIGRhdGEpIHtcclxuXHRcdGRhdGEuZm9yRWFjaChicmFuY2ggPT4ge1xyXG5cdFx0XHRicmFuY2gucmVwbyA9IGZvcmsudXJsICE9PSB1bmRlZmluZWQgPyBmb3JrLnVybCA6IGZvcms7XHJcblx0XHRcdGlmKGZvcmsuZnVsbF9uYW1lICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRicmFuY2gubmFtZSA9IGJyYW5jaC5uYW1lICsgXCJAXCIgKyBmb3JrLmZ1bGxfbmFtZTtcclxuXHRcdFx0fVxyXG5cdFx0XHR0aGlzLmJhc2VCcmFuY2hlcy5wdXNoKGJyYW5jaCk7XHJcblx0XHR9KTtcclxuXHR9XHJcblx0XHJcblx0cHVibGljIGxvYWRCcmFuY2hlcygpIHtcclxuXHRcdHZhciBmb3JrUmVxdWVzdHMgPSB0aGlzLmZvcmtzLm1hcChmb3JrID0+IHtyZXR1cm4galF1ZXJ5LmdldEpTT04odGhpcy5naXRVUkwoZm9yay51cmwsIFwiYnJhbmNoZXNcIiksIGRhdGEgPT4ge1xyXG5cdFx0XHRMb2dnZXIuZGVidWcoXCJsb2FkZWQgYnJhbmNoZXMgZm9yIFwiK2ZvcmsubmFtZSk7XHJcblx0XHRcdHRoaXMucHJvY2Vzc0JyYW5jaGVzKGZvcmssIGRhdGEuZGF0YSk7XHJcblx0XHR9KX0pO1xyXG5cdFx0alF1ZXJ5LndoZW4uYXBwbHkoalF1ZXJ5LCBmb3JrUmVxdWVzdHMpLmRvbmUoKCkgPT4ge1xyXG5cdFx0XHRMb2dnZXIuZGVidWcoXCJhbGwgYnJhbmNoZXMgbG9hZGVkXCIpO1xyXG5cdFx0XHR0aGlzLmxvYWRDb21taXRzKCk7XHJcblx0XHR9KTtcclxuXHR9XHJcblx0XHJcblx0cHVibGljIGxvYWRDb21taXRzKCkge1xyXG5cdFx0dmFyIGNvbW1pdFJlcXVlc3RzID0gW107XHJcblx0XHR0aGlzLmJhc2VCcmFuY2hlcy5mb3JFYWNoKGIgPT4ge1xyXG5cdFx0XHR2YXIgY29tbWl0ID0gdGhpcy5kYXRhW2IuY29tbWl0LnNoYV07XHJcblx0XHRcdGlmKGNvbW1pdCA9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRjb21taXRSZXF1ZXN0cy5wdXNoKFxyXG5cdFx0XHRcdFx0alF1ZXJ5LmdldEpTT04odGhpcy5naXRVUkwoYi5yZXBvLCBcImNvbW1pdHNcIiwgXCJzaGE9XCIrYi5jb21taXQuc2hhKSwgZGF0YSA9PiB7XHJcblx0XHRcdFx0XHRcdExvZ2dlci5kZWJ1ZyhcImxvYWRlZCBjb21taXRzIGZvciBcIitiLm5hbWUpO1xyXG5cdFx0XHRcdFx0XHR0aGlzLnByb2Nlc3NDb21taXRzKGRhdGEuZGF0YSk7XHJcblx0XHRcdFx0XHR9KSk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0XHJcblx0XHRqUXVlcnkud2hlbi5hcHBseShqUXVlcnksIGNvbW1pdFJlcXVlc3RzKS5kb25lKCgpID0+IHtcclxuXHRcdFx0dGhpcy5wcm9jZXNzKCk7XHJcblx0XHR9KTtcclxuXHR9XHJcblx0XHJcblx0cHVibGljIHByb2Nlc3NDb21taXRzKGRhdGEpIHtcclxuXHRcdGRhdGEubWFwKGRhdGEgPT4ge1xyXG5cdFx0XHR2YXIgYzphbnkgPSB7fTtcclxuXHRcdFx0Yy5zaGEgPSBkYXRhLnNoYTtcclxuXHRcdFx0Yy5zc2hhID0gZGF0YS5zaGEuc3Vic3RyaW5nKDAsOCk7XHJcblx0XHRcdGMucGFyZW50aGFzaGVzID0gKDxhbnlbXT4gZGF0YS5wYXJlbnRzKS5tYXAoeCA9PiB7IHJldHVybiB4LnNoYX0pO1x0XHRcdFxyXG5cdFx0XHRjLmF1dGhvcm5hbWUgPSBkYXRhLmNvbW1pdC5hdXRob3IubmFtZTtcclxuXHRcdFx0Yy5hdXRob3JlbWFpbCA9IGRhdGEuY29tbWl0LmF1dGhvci5lbWFpbDtcclxuXHRcdFx0Yy5hdXRob3JkYXRlID0gZGF0YS5jb21taXQuYXV0aG9yLmRhdGU7XHJcblx0XHRcdGMuYXV0aG9ydGltZXN0YW1wID0gbmV3IERhdGUoZGF0YS5jb21taXQuYXV0aG9yLmRhdGUpLmdldFRpbWUoKTtcclxuXHRcdFx0XHJcblx0XHRcdGMuY29tbWl0dGVybmFtZSA9IGRhdGEuY29tbWl0LmNvbW1pdHRlci5uYW1lO1xyXG5cdFx0XHRjLmNvbW1pdHRlcmVtYWlsID0gZGF0YS5jb21taXQuY29tbWl0dGVyLmVtYWlsO1xyXG5cdFx0XHRjLmNvbW1pdHRlcmRhdGUgPSBkYXRhLmNvbW1pdC5jb21taXR0ZXIuZGF0ZTtcclxuXHRcdFx0Yy5jb21taXR0ZXJ0aW1lc3RhbXAgPSBuZXcgRGF0ZShkYXRhLmNvbW1pdC5jb21taXR0ZXIuZGF0ZSkuZ2V0VGltZSgpO1xyXG5cdFxyXG5cdFx0XHRjLnN1YmplY3QgPSBkYXRhLmNvbW1pdC5tZXNzYWdlO1xyXG5cdFx0XHRjLmJvZHkgPSBcIlwiOyAvLyBUb2RvOiB3aGVyZSB0byBnZXQgdGhpcz9cclxuXHRcdFx0Yy5yZWZuYW1lcyA9IFtdOyAvLyBzZXQgd2hlbiBwYXJzaW5nIGJyYW5jaGVzXHJcblx0XHRcdGMuaW5IZWFkcyA9IFtdOyAvLyBzZXQgd2hlbiBwYXJzaW5nIGJyYW5jaGVzXHJcblx0XHRcdFxyXG5cdFx0XHRyZXR1cm4gYztcclxuXHRcdH0pLmZvckVhY2goY29tbWl0ID0+IHtcclxuXHRcdFx0dGhpcy5kYXRhW2NvbW1pdC5zaGFdID0gY29tbWl0O1xyXG5cdFx0fSk7XHJcblx0XHRcclxuXHR9XHJcblx0XHJcblxyXG5cdHB1YmxpYyBwcm9jZXNzKCkge1xyXG5cdFx0dGhpcy5iYXNlQnJhbmNoZXMuZm9yRWFjaChiID0+IHtcclxuXHRcdFx0dmFyIGNvbW1pdCA9IHRoaXMuZGF0YVtiLmNvbW1pdC5zaGFdO1xyXG5cdFx0XHRpZihjb21taXQgPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0Ly8gY29tbWl0IG1pc3NpbmcgZm9yIGJyYW5jaCAtIFRPRE86IGZldGNoIGl0XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Yi5hc3NpZ25lZCA9IHRydWU7XHJcblx0XHRcdFx0Y29tbWl0LnJlZm5hbWVzLnB1c2goYi5uYW1lKTtcclxuXHRcdFx0XHR0aGlzLmFzc2lnbkhlYWRzKGNvbW1pdCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0XHJcblx0XHQvLyBTb3J0XHJcblx0XHR2YXIgbmV3ZGF0YSA9IHt9O1xyXG5cdFx0T2JqZWN0LmtleXModGhpcy5kYXRhKS5zb3J0KChhLGIpID0+IHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuZGF0YVtiXS5jb21taXR0ZXJ0aW1lc3RhbXAgLSB0aGlzLmRhdGFbYV0uY29tbWl0dGVydGltZXN0YW1wO1xyXG5cdFx0fSkuZm9yRWFjaChzaGEgPT4ge1xyXG5cdFx0XHRuZXdkYXRhW3NoYV0gPSB0aGlzLmRhdGFbc2hhXTtcclxuXHRcdH0pO1xyXG5cdFx0XHJcblx0XHRcclxuXHRcdHRoaXMud2hlbkRvbmUobmV3ZGF0YSk7XHJcblx0fVxyXG5cdFxyXG5cdHByaXZhdGUgYXNzaWduSGVhZHMoY29tbWl0KSB7XHJcblx0XHRjb21taXQucGFyZW50czEgPSBjb21taXQucGFyZW50aGFzaGVzLm1hcCggeCA9PiB7IHJldHVybiB4fSk7IC8vIGNvcHkgYXJyYXlcclxuXHRcclxuXHRcdHdoaWxlKGNvbW1pdC5wYXJlbnRzMS5sZW5ndGggPiAwKSB7XHJcblx0XHRcdHZhciBuZXdQYXJlbnRzID0gW107XHJcblx0XHRcdGNvbW1pdC5wYXJlbnRzMS5mb3JFYWNoKCBwYXJlbnRIYXNoID0+IHtcclxuXHRcdFx0XHR2YXIgcCA9IHRoaXMuZGF0YVtwYXJlbnRIYXNoXVx0XHJcblx0XHRcdFx0aWYocCAhPSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRcdHAuaW5IZWFkcy5wdXNoKGNvbW1pdC5zaGEpXHJcblx0XHRcdFx0XHQvLyBhZGQgYWxsIGdyYW5kcGFyZW50cyB0byB0aGUgbmV3cGFyZW50c1xyXG5cdFx0XHRcdFx0cC5wYXJlbnRoYXNoZXMuZm9yRWFjaChoID0+IHtcclxuXHRcdFx0XHRcdFx0aWYobmV3UGFyZW50cy5pbmRleE9mKGgpID09PSAtMSkge1xyXG5cdFx0XHRcdFx0XHRcdG5ld1BhcmVudHMucHVzaChoKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSlcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRjb21taXQucGFyZW50czEgPSBuZXdQYXJlbnRzXHJcblx0XHR9XHJcblx0fVxyXG59IiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIkJyYW5jaC50c1wiLz5cclxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIkNvbW1pdC50c1wiLz5cclxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIkNvbmZpZy50c1wiLz5cclxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIkFzeW5jTG9hZGVyLnRzXCIvPlxyXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiRXhwYW5kYWJsZS50c1wiLz5cclxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIkNvbW1pdFByb3ZpZGVyLnRzXCIvPlxyXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwicGx1Z2lucy9Mb2NhbEdpdDJKc29uUHJvdmlkZXIudHNcIi8+XHJcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJwbHVnaW5zL2dpdGh1Yi50c1wiLz5cclxuXHRcclxuaW50ZXJmYWNlIENvbW1pdHMgeyBba2V5OnN0cmluZ106Q29tbWl0OyB9XHJcbmludGVyZmFjZSBCcmFuY2hlcyB7IFtrZXk6c3RyaW5nXTpCcmFuY2g7IH1cclxuXHRcclxuY2xhc3MgR2l0bGluZSB7XHJcblx0XHJcblx0c2VsZiA9IHRoaXM7XHJcblx0cHVibGljIG1heFg6bnVtYmVyID0gMDtcclxuXHRwdWJsaWMgbWF4SW5kZXhZOm51bWJlciA9IDA7XHJcblx0cHVibGljIGNvbW1pdHM6Q29tbWl0cyA9IHt9O1xyXG5cdHB1YmxpYyBmaXJzdENvbW1pdDpDb21taXQ7XHJcblx0cHVibGljIGNhbnZhcztcclxuXHRwdWJsaWMgZGF0YTtcclxuXHRwdWJsaWMgcGFuZWw7XHJcblx0cHVibGljIHRleHRQYW5lbDtcclxuXHRwdWJsaWMgaGVhZHNNYXA6QnJhbmNoZXMgPSB7fTtcclxuXHRwdWJsaWMgcm9vdExhYmVsOyBcclxuXHRcdFxyXG5cdHB1YmxpYyBhbDogQXN5bmNMb2FkZXI7XHJcblx0XHJcblx0cHVibGljIGNvbmZpZzogR2l0bGluZUNvbmZpZyA9IG5ldyBHaXRsaW5lQ29uZmlnKCk7XHJcblx0XHRcdFxyXG5cdC8vIEhUTUwgc3R1ZmZcclxuXHRwcml2YXRlIGxvYWRpbmdQYW5lbDogSFRNTEVsZW1lbnQ7XHJcblx0cHJpdmF0ZSBncmFwaGljYWxQYW5lbDogSFRNTEVsZW1lbnQ7XHJcblx0cHJpdmF0ZSBoZWFkZXJQYW5lbDogSFRNTEVsZW1lbnQ7ICBcclxuXHRwcml2YXRlIGNvbnRlbnRQYW5lbDogSFRNTEVsZW1lbnQ7XHJcblx0XHRcdFxyXG5cdHByaXZhdGUgY29tbWl0UHJvdmlkZXI6IENvbW1pdFByb3ZpZGVyO1xyXG5cdFxyXG5cdHB1YmxpYyBhZGRDb21taXQoY29tbWl0OiBDb21taXQpIHtcclxuXHRcdHRoaXMuY29tbWl0c1tjb21taXQuZ2V0RnVsbFNoYSgpXSA9IGNvbW1pdDtcclxuXHRcdFxyXG5cdFx0Ly8gZmlyc3QgY29tbWl0IG5lZWRlZCBieSByZW5kZXJpbmdcclxuXHRcdGlmKHRoaXMuZmlyc3RDb21taXQgPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHR0aGlzLmZpcnN0Q29tbWl0ID0gY29tbWl0O1xyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHRwdWJsaWMgYWRkQnJhbmNoKHJlZm5hbWU6IHN0cmluZywgY29tbWl0OiBDb21taXQsIHNwZWNpZml0eTogbnVtYmVyKSB7XHJcblx0XHR2YXIgYnJhbmNoID0gbmV3IEJyYW5jaChyZWZuYW1lLCBjb21taXQsIHNwZWNpZml0eSk7XHJcblx0XHR0aGlzLmhlYWRzTWFwW3JlZm5hbWVdID0gYnJhbmNoO1xyXG5cdH1cclxuXHRcclxuXHRwdWJsaWMgcmVuZGVyKCkge1xyXG5cdFx0dGhpcy5jYW52YXMgPSBuZXcganNnbC5QYW5lbCh0aGlzLmdyYXBoaWNhbFBhbmVsKTtcclxuXHJcblx0XHR0aGlzLmFsLnRoZW5TaW5nbGUoXCJMb2FkaW5nIERhdGFcIiwgKCkgPT4ge1xyXG5cdFx0XHR0aGlzLmFsLnN1c3BlbmQoKTtcclxuXHRcdFx0dGhpcy5jb21taXRQcm92aWRlci53aXRoQ2FsbGJhY2soIChqc29uKSA9PiB7XHJcblx0XHRcdFx0dGhpcy5kYXRhID0ganNvbjtcclxuXHRcdFx0XHR0aGlzLmFsLnJlc3VtZSgpO1xyXG5cdFx0XHR9KVxyXG5cdFx0XHR0aGlzLmNvbW1pdFByb3ZpZGVyLnJlcXVlc3QoKTtcclxuXHRcdH0pLnRoZW4oXCJMb2FkaW5nIENvbW1pdHNcIiwgKCkgPT4ge3JldHVybiBPYmplY3Qua2V5cyh0aGlzLmRhdGEpfSwgKHNoYSkgPT4ge1xyXG5cdFx0XHR2YXIgY29tbWl0ID0gbmV3IENvbW1pdCh0aGlzLCB0aGlzLmRhdGFbc2hhXSk7XHJcblx0XHRcdHRoaXMuYWRkQ29tbWl0KGNvbW1pdCk7XHJcblx0XHR9KVxyXG5cdFx0LnRoZW5TaW5nbGUoXCJCdWlsZGluZyBHcmFwaFwiLCAoKSA9PiB7XHJcblx0XHRcdHRoaXMuYnVpbGRHcmFwaCgpO1xyXG5cdFx0fSlcclxuXHRcdC50aGVuKFwiRHJhd2luZyBMYWJlbHNcIiwgKCkgPT4ge3JldHVybiBPYmplY3Qua2V5cyh0aGlzLmNvbW1pdHMpfSwgKHNoYSkgPT4ge1xyXG5cdFx0XHR2YXIgY29tbWl0ID0gdGhpcy5jb21taXRzW3NoYV07XHJcblx0XHRcdHRoaXMuZHJhd0NvbW1pdChjb21taXQpO1xyXG5cdFx0fSlcclxuXHRcdC50aGVuU2luZ2xlKFwiQ3JlYXRpbmcgTGVnZW5kXCIsICgpID0+IHtcclxuXHRcdFx0dGhpcy5yb290TGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxyXG5cdFx0XHR0aGlzLnJvb3RMYWJlbC5jbGFzc05hbWUgPSBcImNvbW1pdC1sZWdlbmRcIlxyXG5cdFx0XHR0aGlzLnRleHRQYW5lbC5hcHBlbmRDaGlsZCh0aGlzLnJvb3RMYWJlbCk7XHJcblx0XHR9KVxyXG5cdFx0LnRoZW4oXCJEcmF3aW5nIE1lcmdlc1wiLCAoKSA9PiB7cmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuY29tbWl0cyl9LCAoc2hhKSA9PiB7XHJcblx0XHRcdHZhciBjb21taXQgPSB0aGlzLmNvbW1pdHNbc2hhXTtcclxuXHRcdFx0dGhpcy5kcmF3UmVmZXJlbmNlcyhjb21taXQpO1xyXG5cdFx0fSlcclxuXHRcdC50aGVuU2luZ2xlKFwiUmVzaXppbmdcIiwgKCkgPT4ge1xyXG5cdFx0XHR0aGlzLmdyYXBoaWNhbFBhbmVsLnN0eWxlLndpZHRoID0gaW5kZXhUb1godGhpcy5tYXhYICsgMSkgKyBcInB4XCJcclxuXHRcdFx0dGhpcy5ncmFwaGljYWxQYW5lbC5zdHlsZS5oZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpICsgXCJweFwiO1xyXG5cdFx0fSkuc3RhcnQoKTtcclxuXHRcdFxyXG5cdFx0d2luZG93Lm9ucmVzaXplID0gKGV2ZW50OiBVSUV2ZW50KSA9PiB7XHJcblx0XHRcdFxyXG5cdFx0XHR0aGlzLmFsLnRoZW4oXCJSZWRyYXdpbmdcIiwgKCkgPT4ge3JldHVybiBPYmplY3Qua2V5cyh0aGlzLmNvbW1pdHMpfSwgKHNoYSkgPT4ge1xyXG5cdFx0XHRcdHZhciBjb21taXQ6Q29tbWl0ID0gdGhpcy5jb21taXRzW3NoYV07XHJcblx0XHRcdFx0Y29tbWl0LnZpZXcucmVkcmF3KCk7XHJcblx0XHRcdH0pLnRoZW5TaW5nbGUoXCJSZXNpemluZ1wiLCAoKSA9PiB7XHJcblx0XHRcdFx0dGhpcy5ncmFwaGljYWxQYW5lbC5zdHlsZS53aWR0aCA9IGluZGV4VG9YKHRoaXMubWF4WCArIDEpICsgXCJweFwiXHJcblx0XHRcdFx0dGhpcy5ncmFwaGljYWxQYW5lbC5zdHlsZS5oZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpICsgXCJweFwiO1xyXG5cdFx0XHR9KS5zdGFydChmYWxzZSk7IFxyXG5cdFx0fTtcclxuXHR9XHJcblx0XHJcblx0cHVibGljIGdldEhlaWdodCgpIHtcclxuXHRcdHJldHVybiB0aGlzLnJvb3RMYWJlbC5vZmZzZXRUb3AgLSB0aGlzLmZpcnN0Q29tbWl0LnZpZXcubGFiZWwub2Zmc2V0VG9wO1xyXG5cdH1cclxuXHRcclxuXHRwdWJsaWMgYnVpbGRHcmFwaCgpIHtcclxuXHRcdHZhciBzaGFzID0gT2JqZWN0LmtleXModGhpcy5jb21taXRzKTtcclxuXHRcdHNoYXMuZm9yRWFjaCgoc2hhKSA9PiB7XHJcblx0XHRcdHZhciBjb21taXQgPSB0aGlzLmNvbW1pdHNbc2hhXTtcclxuXHRcdFx0Y29tbWl0LmluaXRSZWxhdGlvbnMoKTtcclxuXHRcdH0pO1xyXG5cdFx0c2hhcy5mb3JFYWNoKChzaGEpID0+IHtcclxuXHRcdFx0dmFyIGNvbW1pdCA9IHRoaXMuY29tbWl0c1tzaGFdO1xyXG5cdFx0XHRcclxuXHRcdFx0Y29tbWl0LmluaXRIZWFkU3BlY2lmaXR5KCk7XHJcblx0XHRcdGNvbW1pdC5pbml0TWVyZ2VzKCk7XHJcblx0XHR9KTtcclxuXHRcdHRoaXMuaW5pdEJyYW5jaGVzKCk7XHJcblx0fVxyXG5cdFxyXG5cdHB1YmxpYyBkcmF3Q29tbWl0KGNvbW1pdDogQ29tbWl0KSB7XHJcblx0XHQvLyBMYWJlbFxyXG5cdFx0Y29tbWl0LnZpZXcgPSBuZXcgQ29tbWl0Vmlldyh0aGlzLmNhbnZhcywgdGhpcy5jb25maWcsIGNvbW1pdCk7XHJcblx0XHRcclxuXHRcdGlmKGNvbW1pdC5vdXRPZlNjb3BlID09PSBmYWxzZSkge1xyXG5cdFx0XHRjb21taXQudmlldy5sYWJlbCA9IHRoaXMuZHJhd0xhYmVsKGNvbW1pdCk7XHJcblxyXG5cdFx0XHRjb21taXQudmlldy5sYWJlbC5vbmNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0aWYoY29uc29sZSkge1xyXG5cdFx0XHRcdFx0TG9nZ2VyLmRlYnVnKGNvbW1pdCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9O1xyXG5cclxuXHRcdFx0dGhpcy50ZXh0UGFuZWwuYXBwZW5kQ2hpbGQoY29tbWl0LnZpZXcubGFiZWwpO1xyXG5cdFx0XHRjb21taXQudmlldy5sYWJlbC5zdHlsZVsncGFkZGluZy1sZWZ0J10gPSBpbmRleFRvWCh0aGlzLm1heFggKyAxKStcInB4XCJcclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0cHVibGljIGRyYXdSZWZlcmVuY2VzKGNvbW1pdDogQ29tbWl0KSB7XHJcblx0XHRjb21taXQudmlldy5hZGRSZWxhdGlvbnMoKTtcclxuXHRcdGNvbW1pdC52aWV3LnJlZHJhdygpO1xyXG5cdH1cclxuXHRcclxuXHRwdWJsaWMgZHJhd0xhYmVsKGNvbW1pdDogQ29tbWl0KSB7XHJcblx0XHR2YXIgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxyXG5cdFx0bGFiZWwuY2xhc3NOYW1lID0gXCJjb21taXQtbGVnZW5kXCJcclxuXHJcblx0XHQvLyBTSEEgSGFzaCBcclxuXHRcdHZhciBzaG9ydFNoYTpzdHJpbmcgPSBjb21taXQuZ2V0U2hvcnRTaGEoKTtcclxuXHRcdHZhciBmdWxsU2hhOnN0cmluZyA9IGNvbW1pdC5nZXRGdWxsU2hhKCk7XHJcblx0XHR2YXIgc2hhOkhUTUxFeHBhbmRhYmxlRWxlbWVudCA9IEV4cGFuZGFibGUuZXh0ZW5kKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpKTtcclxuXHRcdHNoYS53aGVuU2hvcnQoc2hvcnRTaGErXCIgXCIpO1xyXG5cdFx0c2hhLndoZW5GdWxsKGZ1bGxTaGEpO1xyXG5cdFx0c2hhLnN0eWxlLmZvbnRGYW1pbHkgPSBcIkNvdXJpZXJcIjtcclxuXHRcdFxyXG5cdFx0bGFiZWwuYXBwZW5kQ2hpbGQoc2hhKTtcclxuXHRcdFxyXG5cdFx0Ly8gQXV0aG9yIGFuZCBjb21taXR0ZXJcclxuXHRcdGxhYmVsLmFwcGVuZENoaWxkKHRoaXMuZHJhd0lkZW50aXR5KFwiYXV0aG9yXCIsIGNvbW1pdC5hdXRob3IpKTtcclxuXHRcdFxyXG5cdFx0aWYoY29tbWl0LmF1dGhvci5lbWFpbCAhPSBjb21taXQuY29tbWl0dGVyLmVtYWlsKSB7XHJcblx0XHRcdGxhYmVsLmFwcGVuZENoaWxkKHRoaXMuZHJhd0lkZW50aXR5KFwiY29tbWl0dGVyXCIsIGNvbW1pdC5jb21taXR0ZXIpKTtcclxuXHRcdH1cclxuXHRcdCBcclxuXHRcdC8vIEJyYW5jaCAtIFRPRE86IFRhZ3MgYW5kIG90aGVyIGJyYW5jaGVzXHRcdFxyXG5cdFx0aWYoY29tbWl0LmJyYW5jaCAmJiBjb21taXQuYnJhbmNoLmNvbW1pdCA9PT0gY29tbWl0ICYmICFjb21taXQuYnJhbmNoLmFub255bW91cykge1xyXG5cdFx0XHR2YXIgaGVhZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xyXG5cdFx0XHRoZWFkLmNsYXNzTmFtZSA9IFwiaGVhZC1sYWJlbFwiO1xyXG5cdFx0XHRoZWFkLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNvbW1pdC5nZXRDb2xvcig0MCk7XHJcblx0XHRcdGhlYWQuc3R5bGUuY29sb3IgPSBcIndoaXRlXCI7XHJcblx0XHRcdGhlYWQuc3R5bGUucGFkZGluZ0xlZnQgPSBoZWFkLnN0eWxlLnBhZGRpbmdSaWdodCA9IFwiMnB4XCI7XHJcblx0XHRcdGhlYWQuaW5uZXJIVE1MID0gY29tbWl0LmJyYW5jaC5yZWY7XHJcblx0XHJcblx0XHRcdGxhYmVsLmFwcGVuZENoaWxkKGhlYWQpO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHRcclxuXHRcdC8vIFN1YmplY3RcdFx0XHJcblx0XHR2YXIgc3ViamVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xyXG5cdFx0c3ViamVjdC5pbm5lckhUTUwgPSBcIiBcIitjb21taXQuc3ViamVjdDtcclxuXHRcdHN1YmplY3Quc3R5bGUuY29sb3IgPSBjb21taXQuaGFzTWVyZ2VzKCkgPyBcImdyZXlcIjogXCJibGFja1wiO1xyXG5cdFx0bGFiZWwuYXBwZW5kQ2hpbGQoc3ViamVjdCk7IFxyXG5cdFx0XHJcblx0XHRsYWJlbC5zdHlsZS5wb3NpdGlvbiA9IFwicmVsYXRpdmVcIjtcclxuXHRcdHJldHVybiBsYWJlbDtcclxuXHR9XHJcblx0XHJcblx0cHVibGljIGRyYXdJZGVudGl0eSh0eXBlOiBzdHJpbmcsIGlkOiBJZGVudGl0eSkge1xyXG5cdFx0dmFyIGVsOiBIVE1MRXhwYW5kYWJsZUVsZW1lbnQgPSBFeHBhbmRhYmxlLmV4dGVuZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZ2l0bGluZS1pZGVudGl0eVwiKSk7XHJcblx0XHRlbC5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCB0eXBlKTtcclxuXHRcdGVsLnNldEF0dHJpYnV0ZShcIm5hbWVcIiwgaWQubmFtZSk7XHJcblx0XHR2YXIgZnVsbG5hbWUgPSBpZC5uYW1lICsgXCIgJmx0O1wiK2lkLmVtYWlsLnRvTG93ZXJDYXNlKCkrXCImZ3Q7XCI7XHJcblx0XHRlbC5zZXRBdHRyaWJ1dGUoXCJ0aXRsZVwiLCBmdWxsbmFtZSk7XHJcblx0XHRcclxuXHRcdGVsLnN0eWxlLmJhY2tncm91bmQgPSB0aGlzLmNvbmZpZy5hdmF0YXJzLm1hcChmID0+IHtyZXR1cm4gXCJ1cmwoXCIrZihpZC5lbWFpbCkrXCIpIG5vLXJlcGVhdFwifSkuam9pbihcIiwgXCIpO1xyXG5cdFx0ZWwud2hlbkZ1bGwoZnVsbG5hbWUpO1xyXG5cdFx0ZWwud2hlblNob3J0KFwiIFwiKTtcclxuXHRcdHJldHVybiBlbDtcclxuXHR9XHJcblxyXG5cdC8qXHJcblx0XHRCYXNlZCBvbiB0aGUgc3BlY2lmaXR5IGFzc2lnbiB0aGUgYnJhbmNoZXMgdG8gdGhlIGNvbW1pdHMuIGlmIGluIGRvdWJ0IHRoZSBjb21taXQgd2lsbCBiZSBvbiB0aGUgbW9zdCBzcGVjaWZpYyBicmFuY2ggXHJcblx0Ki9cclxuXHRwdWJsaWMgaW5pdEJyYW5jaGVzKCkgICB7XHJcblxyXG5cdFx0dmFyIGhlYWRzID0gT2JqZWN0LmtleXModGhpcy5oZWFkc01hcCk7XHJcblx0XHRcclxuXHRcdC8qIHNldCB0aGUgaW5kZXggdG8gdGhlIGhlYWQgb2JqZWN0ICovXHJcblx0XHRmb3IodmFyIGkgPTA7IGk8IGhlYWRzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdHZhciBoZWFkTmFtZSA9IGhlYWRzW2ldO1xyXG5cdFx0XHR2YXIgaGVhZCA9IHRoaXMuaGVhZHNNYXBbaGVhZE5hbWVdO1xyXG5cdFx0XHRoZWFkLmNvbW1pdC5pbml0RGVmYXVsdEJyYW5jaCgpO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHQvKiBTb3J0IHRoZSBicmFuY2hlcyBieSBzcGVjaWZpdHkgKi9cclxuXHRcdHZhciBzZWxmID0gdGhpcztcclxuXHRcdGhlYWRzLnNvcnQoZnVuY3Rpb24obCwgcikge1xyXG5cdFx0XHR2YXIgbEhlYWQ6IENvbW1pdCA9IHNlbGYuaGVhZHNNYXBbbF0uY29tbWl0O1xyXG5cdFx0XHR2YXIgckhlYWQ6IENvbW1pdCA9IHNlbGYuaGVhZHNNYXBbcl0uY29tbWl0O1xyXG5cdFx0XHRcclxuXHRcdFx0aWYobEhlYWQgPT09IHJIZWFkKSB7XHJcblx0XHRcdFx0cmV0dXJuIDA7XHJcblx0XHRcdH1cclxuXHRcdFx0XHJcblx0XHRcdGlmKGxIZWFkLmJyYW5jaC5jYXRlZ29yeSA9PT0gckhlYWQuYnJhbmNoLmNhdGVnb3J5KSB7XHJcblx0XHRcdFx0cmV0dXJuIGxIZWFkLmJyYW5jaC5zcGVjaWZpdHkgLSBySGVhZC5icmFuY2guc3BlY2lmaXR5O1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHJldHVybiBsSGVhZC5icmFuY2guY2F0ZWdvcnkubGVuZ3RoIC0gckhlYWQuYnJhbmNoLmNhdGVnb3J5Lmxlbmd0aDtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG5cclxuXHJcblx0XHQvKiBzZXQgdGhlIGluZGV4IHRvIHRoZSBoZWFkIG9iamVjdCAqL1xyXG5cdFx0dmFyIG1heExhbmUgPSAwO1xyXG5cdFx0Zm9yKHZhciBpID0wOyBpPCBoZWFkcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHR2YXIgaGVhZE5hbWUgPSBoZWFkc1tpXTtcclxuXHRcdFx0dmFyIGhlYWQgPSB0aGlzLmhlYWRzTWFwW2hlYWROYW1lXTtcclxuXHRcdFx0dmFyIHRpcDogQ29tbWl0ID0gaGVhZC5jb21taXQ7XHJcblx0XHRcdFxyXG5cdFx0XHRpZih0aXAuYnJhbmNoID09PSBoZWFkKSB7XHJcblx0XHRcdFx0aGVhZC5sYW5lID0gbWF4TGFuZTtcclxuXHRcdFx0XHQvL2hlYWQuaW5kZXggPSBtYXhMYW5lO1xyXG5cdFx0XHRcdG1heExhbmUgKys7XHJcblxyXG5cdFx0XHRcdC8vIENhbiB3ZSBkaXNwbGF5IHRoaXMgaGVhZCBhIGxpdHRsZSBtb3JlIHRvIHRoZSBsZWZ0P1xyXG5cdFx0XHRcdGZvcih2YXIgbD0wOyBsPCBoZWFkcy5sZW5ndGg7IGwrKykge1xyXG5cclxuXHRcdFx0XHRcdHZhciBjYW5Vc2VMYW5lIDogYm9vbGVhbiA9IHRydWU7XHJcblx0XHRcdFx0XHRmb3IodmFyIGo9MDsgajwgaGVhZHMubGVuZ3RoOyBqKyspIHtcclxuXHRcdFx0XHRcdFx0dmFyIGpoZWFkTmFtZSA9IGhlYWRzW2pdO1xyXG5cdFx0XHRcdFx0XHR2YXIgaGVhZE9uTGFuZTogQ29tbWl0ID0gdGhpcy5oZWFkc01hcFtqaGVhZE5hbWVdLmNvbW1pdDtcclxuXHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdGlmKGhlYWRPbkxhbmUgPT09IHVuZGVmaW5lZCB8fCBoZWFkT25MYW5lLmJyYW5jaCAhPSBoZWFkICYmIGhlYWRPbkxhbmUuYnJhbmNoLmxhbmUgPT09IGwgJiYgKHRpcC5pbnRlcnNlY3RzKGhlYWRPbkxhbmUpIHx8IHRpcC5icmFuY2guY2F0ZWdvcnkgIT0gaGVhZE9uTGFuZS5icmFuY2guY2F0ZWdvcnkpKSB7XHJcblx0XHRcdFx0XHRcdFx0Y2FuVXNlTGFuZSA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRpZihjYW5Vc2VMYW5lKSB7XHJcblx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHRMb2dnZXIuZGVidWcoXCJOTyBJTlRFUlNFQ1RTOiBcIix0aXAuYnJhbmNoLnJlZixcIiAtIFwiLGhlYWRPbkxhbmUuYnJhbmNoLnJlZik7XHJcblx0XHRcdFx0XHRcdGhlYWQubGFuZSA9IGw7XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRcclxuXHRcdFx0XHR0aGlzLm1heFggPSBNYXRoLm1heCh0aGlzLm1heFgsIGhlYWQubGFuZSk7XHJcblx0XHRcdH1cclxuXHJcblx0XHR9XHJcblx0XHRcclxuXHR9XHJcblxyXG5cdC8vIExhdW5jaGluZ1xyXG5cdHB1YmxpYyBmcm9tSlNPTihqc29uRmlsZTogc3RyaW5nKTogR2l0bGluZSB7XHJcblx0XHRyZXR1cm4gdGhpcy5mcm9tUHJvdmlkZXIobmV3IExvY2FsR2l0Mkpzb25Qcm92aWRlcihqc29uRmlsZSkpO1xyXG5cdH1cclxuXHRcclxuXHRwdWJsaWMgZnJvbVByb3ZpZGVyKGNvbW1pdFByb3ZpZGVyOiBDb21taXRQcm92aWRlcik6IEdpdGxpbmUge1xyXG5cdFx0dGhpcy5jb21taXRQcm92aWRlciA9IGNvbW1pdFByb3ZpZGVyO1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fVxyXG5cdFxyXG5cdHByaXZhdGUgcmVuZGVyVG8ocGFuZWw6IEhUTUxFbGVtZW50KTogR2l0bGluZSB7XHJcblx0XHRpZih0aGlzLmhlYWRlclBhbmVsICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0cGFuZWwuYXBwZW5kQ2hpbGQodGhpcy5oZWFkZXJQYW5lbCk7XHJcblx0XHR9XHJcblx0XHRwYW5lbC5hcHBlbmRDaGlsZCh0aGlzLmxvYWRpbmdQYW5lbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJnaXRsaW5lLWxvYWRpbmdwYW5lbFwiKSk7XHJcblx0XHRwYW5lbC5hcHBlbmRDaGlsZCh0aGlzLmNvbnRlbnRQYW5lbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJnaXRsaW5lLWNvbnRlbnRwYW5lbFwiKSk7XHJcblx0XHR0aGlzLmNvbnRlbnRQYW5lbC5hcHBlbmRDaGlsZCh0aGlzLmdyYXBoaWNhbFBhbmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImdpdGxpbmUtZ3JhcGhpY2FscGFuZWxcIikpO1xyXG5cdFx0dGhpcy5jb250ZW50UGFuZWwuYXBwZW5kQ2hpbGQodGhpcy50ZXh0UGFuZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZ2l0bGluZS10ZXh0cGFuZWxcIikpO1xyXG5cdFx0dGhpcy5hbCA9IG5ldyBBc3luY0xvYWRlcih0aGlzLmxvYWRpbmdQYW5lbCk7XHJcblx0XHRcclxuXHRcdHRoaXMucmVuZGVyKCk7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9XHJcblx0XHJcblx0cHVibGljIHdpdGhIZWFkZXIoaGVhZGVyOiBzdHJpbmcpOiBHaXRsaW5lO1xyXG5cdHB1YmxpYyB3aXRoSGVhZGVyKGhlYWRlcjogSFRNTEVsZW1lbnQpOiBHaXRsaW5lO1xyXG5cclxuXHRwdWJsaWMgd2l0aEhlYWRlcihoZWFkZXI6IGFueSkge1xyXG5cdFx0aWYodHlwZW9mIGhlYWRlciA9PT0gXCJzdHJpbmdcIikge1xyXG5cdFx0XHR0aGlzLmhlYWRlclBhbmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImdpdGxpbmUtaGVhZGVycGFuZWxcIik7XHJcblx0XHRcdHRoaXMuaGVhZGVyUGFuZWwuaW5uZXJIVE1MID0gaGVhZGVyO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGhpcy5oZWFkZXJQYW5lbCA9IGhlYWRlcjtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fVxyXG5cdFxyXG5cdHB1YmxpYyBzdGF0aWMgZGlzcGxheUZhdGFsRXJyb3IobWVzc2FnZTogc3RyaW5nKSB7XHJcblx0XHRhbGVydChtZXNzYWdlKTtcclxuXHR9XHRcclxufVxyXG4iLCIvKipcclxuICogYmFzaWMgc3VwcG9ydCBmb3IganNnbCBzaGFwZXNcclxuICovXHJcbmNsYXNzIFNoYXBlIHtcclxuXHRwcm90ZWN0ZWQgZWxlbWVudDogYW55OyAvLyBqc2dsIGVsZW1lbnRcclxuXHRwcml2YXRlIHJlbmRlcmVkVG86IEhUTUxFbGVtZW50OyAvLyBqc2dsIGNhbnZhcyAoYW55IGh0bWwpXHJcblx0cHJvdGVjdGVkIGNhbnZhczogYW55O1xyXG5cdHByaXZhdGUgZGVwZW5kZW5jaWVzIDogU2hhcGVbXSA9IFtdO1xyXG5cdHB1YmxpYyBjb25zdHJ1Y3RvcihjYW52YXM6IGFueSwgZWxlbWVudDogYW55KSB7XHJcblx0XHR0aGlzLmNhbnZhcyA9IGNhbnZhcztcclxuXHRcdHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgYWRkSWZNaXNzaW5nKCkge1xyXG5cdFx0aWYodGhpcy5lbGVtZW50ICE9PSB1bmRlZmluZWQgJiYgdGhpcy5yZW5kZXJlZFRvID09IG51bGwpIHtcclxuXHRcdFx0dGhpcy5hZGRFbGVtZW50cygpO1xyXG5cdFx0XHR0aGlzLnJlbmRlcmVkVG8gPSB0aGlzLmNhbnZhcztcclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0cHVibGljIGFkZEVsZW1lbnRzKCkge1xyXG5cdFx0dGhpcy5jYW52YXMuYWRkRWxlbWVudCh0aGlzLmVsZW1lbnQpO1x0XHJcblx0fVxyXG5cdFxyXG5cdHB1YmxpYyB1cGRhdGUoKSB7XHJcblx0XHR0aGlzLmRlcGVuZGVuY2llcy5mb3JFYWNoKGRlcCA9PiB7XHJcblx0XHRcdGRlcC51cGRhdGUoKTtcclxuXHRcdH0pXHJcblx0fVxyXG5cdFxyXG5cdHB1YmxpYyBkZXBlbmRzT24ob246IFNoYXBlKSB7XHJcblx0XHRvbi5kZXBlbmRlbmNpZXMucHVzaCh0aGlzKTtcclxuXHR9XHJcbn0iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiU2hhcGUudHNcIi8+XHJcbi8qKlxyXG4gKiBOZXcgdHlwZXNjcmlwdCBmaWxlXHJcbiAqL1xyXG5cclxuY2xhc3MgRG90IGV4dGVuZHMgU2hhcGUge1xyXG5cdFxyXG5cdHg6IG51bWJlcjtcclxuXHR5OiBudW1iZXI7XHJcblx0d2lkdGg6IG51bWJlcjtcclxuXHRoZWlnaHQ6IG51bWJlcjtcclxuXHRcclxuXHRjb25zdHJ1Y3RvcihjYW52YXM6IGFueSkge1xyXG5cdFx0c3VwZXIoY2FudmFzLCBjYW52YXMuY3JlYXRlUmVjdGFuZ2xlKCkpO1xyXG5cdH1cclxuXHRcclxuXHRwdWJsaWMgc2l6ZSh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcik6IERvdCB7XHJcblx0XHR0aGlzLndpZHRoID0gd2lkdGg7XHJcblx0XHR0aGlzLmhlaWdodCA9IGhlaWdodDtcclxuXHRcdFxyXG5cdFx0dGhpcy5lbGVtZW50LnNldFdpZHRoKHdpZHRoKTtcclxuXHRcdHRoaXMuZWxlbWVudC5zZXRIZWlnaHQoaGVpZ2h0KTtcclxuXHRcdHRoaXMuZWxlbWVudC5zZXRYUmFkaXVzKHdpZHRoIC80KTtcclxuXHRcdHRoaXMuZWxlbWVudC5zZXRZUmFkaXVzKHdpZHRoIC80KTtcclxuXHRcdFxyXG5cdFx0dGhpcy51cGRhdGUoKTtcclxuXHRcdHRoaXMuYWRkSWZNaXNzaW5nKCk7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9XHJcblx0XHJcblx0cHVibGljIGF0KHg6IG51bWJlciwgeTogbnVtYmVyKTogRG90ICB7XHJcblx0XHR0aGlzLnggPSB4O1xyXG5cdFx0dGhpcy55ID0geTtcclxuXHRcdFxyXG5cdFx0dGhpcy51cGRhdGUoKTtcclxuXHRcdHRoaXMuYWRkSWZNaXNzaW5nKCk7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9XHJcblx0XHJcblx0cHVibGljIGNvbG9yKHN0cm9rZUNvbG9yOiBzdHJpbmcsIGZpbGxDb2xvcjogc3RyaW5nKTogRG90IHtcclxuXHRcdHRoaXMuZWxlbWVudC5nZXRTdHJva2UoKS5zZXRXZWlnaHQoMSk7XHJcblx0XHR0aGlzLmVsZW1lbnQuZ2V0U3Ryb2tlKCkuc2V0Q29sb3Ioc3Ryb2tlQ29sb3IpO1xyXG5cdFx0dGhpcy5lbGVtZW50LmdldEZpbGwoKS5zZXRDb2xvcihmaWxsQ29sb3IpO1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fVxyXG5cdFxyXG5cdHB1YmxpYyB1cGRhdGUoKSB7XHJcblx0XHR0aGlzLmVsZW1lbnQuc2V0TG9jYXRpb25YWSh0aGlzLnggLSB0aGlzLndpZHRoIC8gMiwgdGhpcy55IC0gdGhpcy5oZWlnaHQgLyAyKTtcclxuXHRcdHN1cGVyLnVwZGF0ZSgpO1xyXG5cdH1cclxuXHRcclxufSIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJTaGFwZS50c1wiLz5cclxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIkRvdC50c1wiLz5cclxuLyoqXHJcbiAqIFNoYXBlIHRoYXQgbGlua3MgdHdvIGRvdHNcclxuICovXHJcblxyXG5jbGFzcyBCYXNlTGluayBleHRlbmRzIFNoYXBlIHtcclxuXHRcclxuXHRwYXJlbnREb3Q6IERvdDtcclxuXHRjaGlsZERvdDogRG90O1xyXG5cdFxyXG5cdGxpbmVDb2xvcjogc3RyaW5nO1xyXG5cdFxyXG5cdGNvbnN0cnVjdG9yKGNhbnZhczogYW55LCBlbGVtZW50OiBhbnkpIHtcclxuXHRcdHN1cGVyKGNhbnZhcywgZWxlbWVudCk7XHJcblx0fVxyXG5cdFxyXG5cdHB1YmxpYyBmcm9tKGZyb206IERvdCk6IEJhc2VMaW5rICB7XHJcblx0XHR0aGlzLmRlcGVuZHNPbihmcm9tKTtcclxuXHRcdHRoaXMucGFyZW50RG90ID0gZnJvbTtcclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH1cclxuXHRcclxuXHRwdWJsaWMgdG8odG86IERvdCk6IEJhc2VMaW5rIHtcclxuXHRcdC8vdGhpcy5kZXBlbmRzT24odG8pO1xyXG5cdFx0dGhpcy5jaGlsZERvdCA9IHRvO1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fVxyXG5cdFxyXG5cdHB1YmxpYyBjb2xvcihsaW5lQ29sb3I6IHN0cmluZyk6IEJhc2VMaW5rIHtcclxuXHRcdHRoaXMuZWxlbWVudC5nZXRTdHJva2UoKS5zZXRXZWlnaHQoMSk7XHJcblx0XHR0aGlzLmVsZW1lbnQuZ2V0U3Ryb2tlKCkuc2V0Q29sb3IobGluZUNvbG9yKTtcclxuXHRcdHRoaXMubGluZUNvbG9yID0gbGluZUNvbG9yO1xyXG5cdFx0dGhpcy5hZGRJZk1pc3NpbmcoKTtcdFx0XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9XHJcbn0iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiQmFzZUxpbmsudHNcIi8+XHJcbi8qKlxyXG4gKiBOZXcgdHlwZXNjcmlwdCBmaWxlXHJcbiAqL1xyXG5kZWNsYXJlIHZhciBqc2dsOiBhbnk7XHJcbiBcclxuY2xhc3MgQ3VydmUgZXh0ZW5kcyBCYXNlTGluayB7XHJcblx0XHJcblx0cHJpdmF0ZSBhcnJvdztcclxuXHRcclxuXHRjb25zdHJ1Y3RvcihjYW52YXM6IGFueSkge1xyXG5cdFx0c3VwZXIoY2FudmFzLCBjYW52YXMuY3JlYXRlQ3VydmUoKSk7XHJcblx0XHR0aGlzLmFycm93ID0gdGhpcy5jYW52YXMuY3JlYXRlUG9seWdvbigpO1xyXG5cdH1cclxuXHRcclxuXHRwdWJsaWMgYWRkRWxlbWVudHMoKSB7XHJcblx0XHRzdXBlci5hZGRFbGVtZW50cygpO1xyXG5cdFx0XHJcblx0XHQvLyAybmQgZWxlbWVudFxyXG5cdFx0dGhpcy5jYW52YXMuYWRkRWxlbWVudCh0aGlzLmFycm93KTtcclxuXHR9XHJcblx0XHJcblx0cHVibGljIHVwZGF0ZSgpIHtcclxuXHRcdHZhciB4OiBudW1iZXIgPSB0aGlzLmNoaWxkRG90Lng7XHJcblx0XHR2YXIgeTogbnVtYmVyID0gdGhpcy5jaGlsZERvdC55O1xyXG5cdFx0dmFyIHBhcmVudFg6IG51bWJlciA9IHRoaXMucGFyZW50RG90Lng7XHJcblx0XHR2YXIgcGFyZW50WTogbnVtYmVyID0gdGhpcy5wYXJlbnREb3QueTtcclxuXHRcdHZhciBjb2xvcjogc3RyaW5nID0gdGhpcy5saW5lQ29sb3I7XHJcblxyXG5cdFx0dmFyIGRpcmVjdGlvbiA9IHggPCBwYXJlbnRYID8gMSA6IC0xO1xyXG5cclxuXHRcdHRoaXMuZWxlbWVudC5zZXRTdGFydFBvaW50WFkocGFyZW50WCwgcGFyZW50WSAtIHRoaXMucGFyZW50RG90LmhlaWdodCAvIDIpXHJcblx0XHR0aGlzLmVsZW1lbnQuc2V0RW5kUG9pbnRYWSh4K3RoaXMuY2hpbGREb3Qud2lkdGggLyAyKmRpcmVjdGlvbiwgeSk7XHJcblx0XHR0aGlzLmVsZW1lbnQuc2V0Q29udHJvbDJQb2ludFhZKHBhcmVudFgsIHkpO1xyXG5cdFx0dGhpcy5lbGVtZW50LnNldENvbnRyb2wxUG9pbnRYWShwYXJlbnRYLCB5KTtcclxuXHJcblx0XHR0aGlzLmVsZW1lbnQuZ2V0U3Ryb2tlKCkuc2V0V2VpZ2h0KDEpO1xyXG5cdFx0dGhpcy5lbGVtZW50LmdldFN0cm9rZSgpLnNldENvbG9yKGNvbG9yKTtcclxuXHRcdFxyXG5cdFx0XHJcblx0XHR0aGlzLmFycm93LmdldFN0cm9rZSgpLnNldFdlaWdodCgwKVxyXG5cdFx0dGhpcy5hcnJvdy5nZXRGaWxsKCkuc2V0Q29sb3IoY29sb3IpXHJcblx0XHRcclxuXHRcdHRoaXMuYXJyb3cuY2xlYXJQb2ludHMoKTtcclxuXHRcdHRoaXMuYXJyb3cuYWRkUG9pbnRYWSgwLDApO1xyXG5cdFx0dGhpcy5hcnJvdy5hZGRQb2ludFhZKDYsLTQpXHJcblx0XHR0aGlzLmFycm93LmFkZFBvaW50WFkoNiw0KVxyXG5cdFx0XHJcblx0XHQvLyBNb3ZlXHRcdFx0XHRcdFxyXG5cdFx0Zm9yKHZhciBpPTA7aTx0aGlzLmFycm93LmdldFBvaW50c0NvdW50KCk7IGkrKykge1xyXG5cdFx0XHR2YXIgcHggPSB0aGlzLmFycm93LmdldFBvaW50QXQoaSkuWDtcclxuXHRcdFx0dmFyIHB5ID0gdGhpcy5hcnJvdy5nZXRQb2ludEF0KGkpLlk7XHJcblx0XHRcdC8vdGhpcy5hcnJvdy5zZXRQb2ludFhZQXQocHgsIHB5ICsgeSwgaSk7XHJcblx0XHRcdHRoaXMuYXJyb3cuc2V0UG9pbnRYWUF0KHB4KmRpcmVjdGlvbiArIHggKyB0aGlzLmNoaWxkRG90LndpZHRoIC8gMipkaXJlY3Rpb24sIHB5ICsgeSwgaSk7XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG59IiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIkJhc2VMaW5rLnRzXCIvPlxyXG4vKipcclxuICogTmV3IHR5cGVzY3JpcHQgZmlsZVxyXG4gKi9cclxuXHJcbmNsYXNzIFN0cmFpZ2h0IGV4dGVuZHMgQmFzZUxpbmsge1xyXG5cdFxyXG5cdGNvbnN0cnVjdG9yKGNhbnZhczogYW55KSB7XHJcblx0XHRzdXBlcihjYW52YXMsIGNhbnZhcy5jcmVhdGVMaW5lKCkpO1xyXG5cdH1cclxuXHRcclxuXHRwdWJsaWMgdXBkYXRlKCkge1xyXG5cdFx0c3VwZXIudXBkYXRlKCk7XHJcblx0XHR0aGlzLmVsZW1lbnQuc2V0U3RhcnRQb2ludFhZKHRoaXMucGFyZW50RG90LngsIHRoaXMucGFyZW50RG90LnkgLSB0aGlzLnBhcmVudERvdC5oZWlnaHQgLyAyKTtcclxuXHRcdHRoaXMuZWxlbWVudC5zZXRFbmRQb2ludFhZKHRoaXMuY2hpbGREb3QueCwgdGhpcy5jaGlsZERvdC55ICsgdGhpcy5jaGlsZERvdC5oZWlnaHQgLyAyKTtcclxuXHR9XHJcblx0XHJcbn0iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiU2hhcGUudHNcIi8+XHJcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJEb3QudHNcIi8+XHJcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJTdHJhaWdodC50c1wiLz5cclxuLyoqXHJcbiAqIE5ldyB0eXBlc2NyaXB0IGZpbGVcclxuICovXHJcbmRlY2xhcmUgdmFyIGpzZ2w6IGFueTtcclxuXHJcbmNsYXNzIENyZWF0aW9uIGV4dGVuZHMgQmFzZUxpbmsge1xyXG5cdFxyXG5cdHNlY29uZExpbmU7XHJcblx0XHJcblx0Y29uc3RydWN0b3IoY2FudmFzOiBhbnkpIHtcclxuXHRcdHN1cGVyKGNhbnZhcywgY2FudmFzLmNyZWF0ZUxpbmUoKSk7XHJcblx0XHR0aGlzLnNlY29uZExpbmUgPSBjYW52YXMuY3JlYXRlTGluZSgpO1xyXG5cdH1cclxuXHRcclxuXHRwdWJsaWMgYWRkRWxlbWVudHMoKSB7XHJcblx0XHRzdXBlci5hZGRFbGVtZW50cygpO1xyXG5cdFx0XHJcblx0XHQvLyAybmQgZWxlbWVudFxyXG5cdFx0dGhpcy5jYW52YXMuYWRkRWxlbWVudCh0aGlzLnNlY29uZExpbmUpOyAvLyBUT0Q6IGFkZCBsYXRlcj9cclxuXHR9XHJcblx0XHJcblx0cHVibGljIHVwZGF0ZSgpIHtcclxuXHRcdHN1cGVyLnVwZGF0ZSgpO1xyXG5cdFx0XHJcblx0XHQvLyBIb3Jpem9udGFsIGRvdHRlZCBsaW5lXHJcblx0XHRpZih0aGlzLnBhcmVudERvdC54IDwgdGhpcy5jaGlsZERvdC54KSB7XHJcblx0XHRcdHRoaXMuZWxlbWVudC5zZXRTdGFydFBvaW50WFkodGhpcy5wYXJlbnREb3QueCArIHRoaXMucGFyZW50RG90LndpZHRoIC8gMiwgdGhpcy5wYXJlbnREb3QueSlcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRoaXMuZWxlbWVudC5zZXRTdGFydFBvaW50WFkodGhpcy5wYXJlbnREb3QueCAtIHRoaXMucGFyZW50RG90LndpZHRoIC8gMiwgdGhpcy5wYXJlbnREb3QueSlcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0dGhpcy5lbGVtZW50LnNldEVuZFBvaW50WFkodGhpcy5jaGlsZERvdC54LCB0aGlzLnBhcmVudERvdC55KTtcclxuXHRcdHRoaXMuZWxlbWVudC5nZXRTdHJva2UoKS5zZXRXZWlnaHQoMSk7XHJcblx0XHR0aGlzLmVsZW1lbnQuZ2V0U3Ryb2tlKCkuc2V0RGFzaFN0eWxlKGpzZ2wuRGFzaFN0eWxlcy5EQVNIKTsgXHJcblx0XHR0aGlzLmVsZW1lbnQuZ2V0U3Ryb2tlKCkuc2V0Q29sb3IodGhpcy5saW5lQ29sb3IpO1xyXG5cdFx0XHJcblx0XHQvLyBWZXJ0aWNhbCBsaW5lXHJcblx0XHR0aGlzLnNlY29uZExpbmUuc2V0U3RhcnRQb2ludFhZKHRoaXMuY2hpbGREb3QueCwgdGhpcy5wYXJlbnREb3QueSlcclxuXHRcdHRoaXMuc2Vjb25kTGluZS5zZXRFbmRQb2ludFhZKHRoaXMuY2hpbGREb3QueCwgdGhpcy5jaGlsZERvdC55ICsgdGhpcy5jaGlsZERvdC5oZWlnaHQgLyAyKTtcclxuXHRcdHRoaXMuc2Vjb25kTGluZS5nZXRTdHJva2UoKS5zZXRXZWlnaHQoMSlcclxuXHRcdHRoaXMuc2Vjb25kTGluZS5nZXRTdHJva2UoKS5zZXRDb2xvcih0aGlzLmxpbmVDb2xvcik7XHJcblx0fVxyXG59IiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIkNvbmZpZy50c1wiLz5cclxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIkNvbW1pdC50c1wiLz5cclxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cInJlbmRlcmluZy9DdXJ2ZS50c1wiLz5cclxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cInJlbmRlcmluZy9Eb3QudHNcIi8+XHJcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJyZW5kZXJpbmcvU3RyYWlnaHQudHNcIi8+XHJcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJyZW5kZXJpbmcvQ3JlYXRpb24udHNcIi8+XHJcbi8qKlxyXG4gKiBWaWV3IG9mIHRoZSBDb21taXRcclxuICovXHJcbiBcclxuIGNsYXNzIENvbW1pdFZpZXcge1xyXG4gXHRcclxuIFx0cHVibGljIGNvbW1pdCA6IENvbW1pdDtcclxuIFx0cHVibGljIGxhYmVsIDogSFRNTEVsZW1lbnQ7XHJcbiBcdHB1YmxpYyBjYW52YXM6IGFueTsgLy8ganNnbFxyXG4gXHRwdWJsaWMgY29uZmlnIDogR2l0bGluZUNvbmZpZztcclxuXHJcbiBcdHB1YmxpYyBkb3QgOiBEb3Q7XHJcbiBcdHB1YmxpYyBsaW5lcyA6IFNoYXBlW10gPSBbXTtcclxuIFx0XHJcbiBcdGNvbnN0cnVjdG9yKGNhbnZhcywgY29uZmlnOiBHaXRsaW5lQ29uZmlnLCBjb21taXQ6IENvbW1pdCkge1xyXG4gXHRcdHRoaXMuY2FudmFzID0gY2FudmFzO1xyXG4gXHRcdHRoaXMuY29uZmlnID0gY29uZmlnO1xyXG4gXHRcdHRoaXMuY29tbWl0ID0gY29tbWl0O1xyXG4gXHRcdFxyXG4gXHRcdHRoaXMuZG90ID0gbmV3IERvdCh0aGlzLmNhbnZhcyk7XHJcblx0fVxyXG5cdFxyXG5cdHB1YmxpYyBhZGRSZWxhdGlvbnMoKSB7XHJcblxyXG5cdFx0Ly8gRGlyZWN0IHBhcmVudFxyXG5cdFx0aWYodGhpcy5jb21taXQuZGlyZWN0cGFyZW50ICE9IG51bGwpIHtcclxuXHRcdFx0dmFyIGRwbCA6IFNoYXBlO1xyXG5cdFx0XHRpZih0aGlzLmNvbW1pdC5nZXRMYW5lKCkgPT0gdGhpcy5jb21taXQuZGlyZWN0cGFyZW50LmdldExhbmUoKSB8fCB0aGlzLmNvbW1pdC5kaXJlY3RwYXJlbnQub3V0T2ZTY29wZSkgeyAgXHJcblx0XHRcdFx0Ly8gZGlyZWN0IHBhcmVudCBpcyB0aGUgc2FtZSBYL2xhbmUsIHRoaXMgbWVhbnMgaXQgaXMgYSBzdGFuZGFyZCBmb3J3YXJkIGNvbW1pdCBcclxuXHRcdFx0XHRkcGwgPSBuZXcgU3RyYWlnaHQodGhpcy5jYW52YXMpLmZyb20odGhpcy5jb21taXQuZGlyZWN0cGFyZW50LnZpZXcuZG90KS50byh0aGlzLmRvdCkuY29sb3IodGhpcy5jb21taXQuZ2V0Q29sb3IoMjApKTtcclxuXHRcdFx0fSBlbHNlIHsgXHJcblx0XHRcdFx0Ly8gZGlyZWN0IHBhcmVudCBpcyBvbiBhIGRpZmZlcmVudCBsYW5lLCB0aGlzIGlzIG1vc3QgY2VydGFpbmx5IGEgbmV3IGJyYW5jaCBcclxuXHRcdFx0XHRkcGwgPSBuZXcgQ3JlYXRpb24odGhpcy5jYW52YXMpLmZyb20odGhpcy5jb21taXQuZGlyZWN0cGFyZW50LnZpZXcuZG90KS50byh0aGlzLmRvdCkuY29sb3IodGhpcy5jb21taXQuZ2V0Q29sb3IoMzApKTtcclxuXHRcdFx0fSBcclxuXHRcdFx0XHJcblx0XHRcdHRoaXMubGluZXMucHVzaChkcGwpO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHR2YXIgYWxsbWVyZ2VzID0gdGhpcy5jb21taXQubWVyZ2VzLnN0YW5kYXJkLmNvbmNhdCh0aGlzLmNvbW1pdC5tZXJnZXMuYW5vbnltb3VzKTtcclxuXHRcdGFsbG1lcmdlcy5mb3JFYWNoKG1lcmdlID0+IHtcclxuXHRcdFx0dGhpcy5saW5lcy5wdXNoKFxyXG5cdFx0XHRcdG5ldyBDdXJ2ZSh0aGlzLmNhbnZhcylcclxuXHRcdFx0XHQuZnJvbShtZXJnZS5zb3VyY2Uudmlldy5kb3QpXHJcblx0XHRcdFx0LnRvKHRoaXMuZG90KVxyXG5cdFx0XHRcdC5jb2xvcihtZXJnZS5zb3VyY2UuZ2V0Q29sb3IoMzUpKSlcclxuXHRcdFx0XHQ7XHRcdFxyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuIFx0LyoqIGNhbGN1bGF0ZSB0aGUgcG9zaXRpb25zIGJhc2VkIG9uIG1vZGVsIGFuZCB1cGRhdGUgdGhlIHNoYXBlcyAqL1xyXG4gXHRwdWJsaWMgcmVkcmF3KCkge1xyXG4gXHRcdHRoaXMuZG90XHJcbiBcdFx0XHQuYXQodGhpcy5jb21taXQuZ2V0WCgpLCB0aGlzLmNvbW1pdC5nZXRZKCkpXHJcbiBcdFx0XHQuc2l6ZSh0aGlzLmNvbmZpZy5kb3RXaWR0aCwgdGhpcy5jb25maWcuZG90SGVpZ2h0KVxyXG4gXHRcdFx0LmNvbG9yKHRoaXMuY29tbWl0LmdldENvbG9yKDIwKSwgdGhpcy5jb21taXQuZ2V0Q29sb3IoODApKTtcclxuIFx0fVxyXG4gXHRcclxuXHQgXHJcbiB9XHJcbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJCcmFuY2gudHNcIi8+XHJcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJHaXRsaW5lLnRzXCIvPlxyXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiQ29tbWl0Vmlldy50c1wiLz5cclxuXHJcbi8qKiBjb21taXR0ZXIgb3IgYXV0aG9yICovXHJcbmNsYXNzIElkZW50aXR5IHtcclxuXHRwdWJsaWMgaW1hZ2U6IHN0cmluZzsgLy8gb3B0aW9uYWxcclxuXHRcclxuXHRwdWJsaWMgY29uc3RydWN0b3IgKHB1YmxpYyBuYW1lOiBzdHJpbmcsIHB1YmxpYyBlbWFpbDogc3RyaW5nLCBwdWJsaWMgZGF0ZTpudW1iZXIpIHtcclxuXHR9XHJcbn1cclxuXHJcbmNsYXNzIENvbW1pdCB7XHJcblx0cHJpdmF0ZSBjb250YWluZXI6IEdpdGxpbmU7XHJcblxyXG5cdHByaXZhdGUgd2FybmluZ3M6IGFueVtdID0gW107XHJcblx0cHJpdmF0ZSBpbkhlYWRzUmVmOiBDb21taXRbXSA9IFtdO1xyXG5cdHByaXZhdGUgcGFyZW50czogQ29tbWl0W10gPSBbXTtcclxuXHRwcml2YXRlIGNoaWxkczogQ29tbWl0W10gPSBbXTtcclxuXHRwcml2YXRlIHNpYmxpbmdzOiBDb21taXRbXSA9IFtdO1xyXG5cdHB1YmxpYyBvdXRPZlNjb3BlOiBib29sZWFuID0gZmFsc2U7IC8vIFRoaXMgY29tbWl0IHdhcyBub3QgcGFydCBvZiB0aGUgbG9ncyBzY29wZSwgYnV0IGlzIHJlZmVyZW5jZWQgYnkgYW5vdGhlciBjb21taXQuXHJcblx0cHVibGljIG1lcmdlcyA9IHsgc3RhbmRhcmQ6IFtdLCBhbm9ueW1vdXM6IFtdfTtcclxuXHRwcml2YXRlIHNoYTogc3RyaW5nO1xyXG5cdHByaXZhdGUgc3NoYTogc3RyaW5nOyAvLyBBYmJyZXZpYXRlZCBoYXNoXHJcblx0cHVibGljIHN1YmplY3Q6IHN0cmluZztcclxuXHRwcml2YXRlIGRhdGE6IGFueTtcclxuXHRwcml2YXRlIGluZGV4WTogbnVtYmVyO1xyXG5cclxuXHRwcml2YXRlIG1heFNwZWNpZml0eTogbnVtYmVyO1xyXG5cdHB1YmxpYyBicmFuY2g6IEJyYW5jaDtcclxuXHRwdWJsaWMgZGlyZWN0cGFyZW50OiBDb21taXQ7XHJcblx0cHVibGljIGRpcmVjdGNoaWxkOiBDb21taXQ7XHJcblx0XHJcblx0cHVibGljIHZpZXcgOiBDb21taXRWaWV3O1xyXG5cdFxyXG5cdHB1YmxpYyBjb21taXR0ZXI6IElkZW50aXR5O1xyXG5cdHB1YmxpYyBhdXRob3I6IElkZW50aXR5O1xyXG5cdFxyXG5cdGNvbnN0cnVjdG9yKGNvbnRhaW5lcjogR2l0bGluZSwgZGF0YSkge1xyXG5cdFx0dGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XHJcblx0XHR0aGlzLmRhdGEgPSBkYXRhO1xyXG5cdFx0XHJcblx0XHQvLyByZWZlcmVuY2UgdGhlIGRhdGEgYmFjayB0byB0aGUgb2JqZWN0XHJcblx0XHR0aGlzLmRhdGEub2JqID0gdGhpcztcclxuXHRcdFxyXG5cdFx0aWYoZGF0YS5pbkhlYWRzID09IG51bGwpIGRhdGEuaW5IZWFkcyA9IFtdO1xyXG5cdFx0aWYoZGF0YS5wYXJlbnRoYXNoZXMgPT0gbnVsbCkgZGF0YS5wYXJlbnRoYXNoZXMgPSBbXTtcclxuXHRcdGlmKGRhdGEucmVmbmFtZXMgPT0gbnVsbCkgZGF0YS5yZWZuYW1lcyA9IFtdO1xyXG5cdFxyXG5cdFx0dGhpcy5zaGEgPSBkYXRhLnNoYTtcclxuXHRcdHRoaXMuc3NoYSA9IGRhdGEuc3NoYTtcclxuXHRcdHRoaXMuc3ViamVjdCA9IGRhdGEuc3ViamVjdDtcclxuXHRcdHRoaXMuaW5kZXhZID0gY29udGFpbmVyLm1heEluZGV4WSArKztcclxuXHRcdFxyXG5cdFx0dGhpcy5jb21taXR0ZXIgPSBuZXcgSWRlbnRpdHkodGhpcy5kYXRhLmNvbW1pdHRlcm5hbWUsIHRoaXMuZGF0YS5jb21taXR0ZXJlbWFpbCwgbmV3IERhdGUodGhpcy5kYXRhLmNvbW1pdHRlcmRhdGUpLmdldFRpbWUoKSk7XHJcblx0XHR0aGlzLmF1dGhvciA9IG5ldyBJZGVudGl0eSh0aGlzLmRhdGEuYXV0aG9ybmFtZSwgdGhpcy5kYXRhLmF1dGhvcmVtYWlsLCBuZXcgRGF0ZSh0aGlzLmRhdGEuYXV0aG9yZGF0ZSkuZ2V0VGltZSgpKTtcclxuXHR9XHJcblx0XHJcblx0cHVibGljIGdldFNob3J0U2hhKCkgOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIHRoaXMuc3NoYTtcclxuXHR9XHJcblx0XHJcblx0cHVibGljIGdldEZ1bGxTaGEoKSA6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gdGhpcy5zaGE7XHJcblx0fVxyXG5cdFxyXG5cdHB1YmxpYyBpbml0UmVsYXRpb25zKCkge1xyXG5cdFx0dmFyIHNlbGYgPSB0aGlzO1xyXG5cdFx0XHJcblx0XHR0aGlzLmRhdGEucGFyZW50aGFzaGVzLmZvckVhY2goIGhhc2ggPT4ge1xyXG5cdFx0XHR2YXIgcGFyZW50Q29tbWl0ID0gdGhpcy5jb250YWluZXIuY29tbWl0c1toYXNoXTtcclxuXHJcblx0XHRcdC8vIENyZWF0ZSBhIHZpcnR1YWwgY29tbWl0XHJcblx0XHRcdGlmKHBhcmVudENvbW1pdCA9PSBudWxsKSB7XHJcblx0XHRcdFx0cGFyZW50Q29tbWl0ID0gbmV3IENvbW1pdCh0aGlzLmNvbnRhaW5lciwgIHtzaGE6IGhhc2grTWF0aC5yYW5kb20oKX0pO1xyXG5cdFx0XHRcdHBhcmVudENvbW1pdC5vdXRPZlNjb3BlID0gdHJ1ZTtcclxuXHRcdFx0XHRzZWxmLmNvbnRhaW5lci5hZGRDb21taXQocGFyZW50Q29tbWl0KTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0dGhpcy5wYXJlbnRzLnB1c2gocGFyZW50Q29tbWl0KTtcclxuXHRcdFx0cGFyZW50Q29tbWl0LmNoaWxkcy5wdXNoKHRoaXMpO1xyXG5cdFx0XHR0aGlzLnNpYmxpbmdzID0gcGFyZW50Q29tbWl0LmNoaWxkczsgLy8gdGhpcyB3aWxsIGJlIG92ZXJ3aXR0ZW4gYXMgbmV3IGNoaWxkcyBhcmUgZm91bmRcclxuXHRcdFx0XHJcblx0XHRcdGlmKHRoaXMucGFyZW50cy5sZW5ndGggPiAwKSB7XHJcblx0XHRcdFx0dmFyIGRwID0gdGhpcy5wYXJlbnRzWzBdO1xyXG5cdFx0XHRcdHRoaXMuZGlyZWN0cGFyZW50ID0gZHA7XHJcblx0XHRcdFx0ZHAuZGlyZWN0Y2hpbGQgPSB0aGlzO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdFxyXG5cdFx0dGhpcy5kYXRhLmluSGVhZHMuZm9yRWFjaChoZWFkc2hhID0+IHtcclxuXHRcdFx0dmFyIGNvbW1pdCA9IHRoaXMuY29udGFpbmVyLmNvbW1pdHNbaGVhZHNoYV07XHJcblx0XHRcdGlmKHRoaXMuaW5IZWFkc1JlZi5pbmRleE9mKGNvbW1pdCkgPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdHRoaXMuaW5IZWFkc1JlZi5wdXNoKGNvbW1pdClcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRcclxuXHR9XHJcblx0XHJcblx0cHVibGljIGluaXREZWZhdWx0QnJhbmNoKCkge1xyXG5cdFx0dmFyIGNvbW1pdDogQ29tbWl0ID0gdGhpcztcclxuXHRcdFx0XHJcblx0XHR3aGlsZShjb21taXQgIT0gbnVsbCkge1xyXG5cdFx0XHRcdFxyXG5cdFx0XHQvLyBHVUVTU0lORzogVGhlIGNvcnJlY3QgYnJhbmNoIGlzIHVzdWFsbHkgdGhlIG9uZSB3aXRoIHRoZSBsZWFzdCBzcGVjaWZpYyBuYW1lXHJcblx0XHRcdGlmKGNvbW1pdC5icmFuY2ggPT0gbnVsbCB8fCBjb21taXQuYnJhbmNoLnNwZWNpZml0eSA+IHRoaXMuYnJhbmNoLnNwZWNpZml0eSkge1xyXG5cdFx0XHRcdGNvbW1pdC5icmFuY2ggPSB0aGlzLmJyYW5jaDtcclxuXHRcdFx0XHQvL2NvbW1pdC5kZWJ1ZyhcImFzc2lnbmluZyBcIit0aGlzLmJyYW5jaC5yZWYpXHJcblx0XHRcdH1cclxuXHRcdFx0Y29tbWl0LmJyYW5jaC5zdGFydCA9IGNvbW1pdDsgLy8gdGhpcyBmdW5jdGlvbiB3aWxsIHRyYXZlcnNlIHRoZSBwYXJlbnRzLCBzbyB0aGUgbGFzdCBvbmUgd2lsbCBiZSB0aGUgZmlyc3QgY29tbWl0XHJcblx0XHRcdGNvbW1pdC5icmFuY2gub3JpZ2luID0gY29tbWl0LmRpcmVjdHBhcmVudDsgLy8gdGhpcyBjb3VsZCBiZSBudWxsIC0+IGl0IGlzIG91dHNpZGUgb2YgdGhlIGhpc3RvcnkuXHJcblx0XHRcdGNvbW1pdCA9IGNvbW1pdC5kaXJlY3RwYXJlbnQ7XHJcblx0XHR9XHJcblx0fVxyXG5cdHB1YmxpYyBpbml0SGVhZFNwZWNpZml0eSgpIHtcclxuXHRcdGZvciAodmFyIGk9MDsgaTx0aGlzLmRhdGEucmVmbmFtZXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0dmFyIHJlZm5hbWUgPSB0aGlzLmRhdGEucmVmbmFtZXNbaV07XHJcblx0XHJcblx0XHRcdGlmKCF0aGlzLmNvbnRhaW5lci5jb25maWcucmVtb3RlT25seSB8fCByZWZuYW1lLmluZGV4T2YoXCJvcmlnaW4vXCIpID09IDApIHtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRpZih0aGlzLmNvbnRhaW5lci5jb25maWcucmVtb3RlT25seSkge1xyXG5cdFx0XHRcdFx0cmVmbmFtZSA9IHJlZm5hbWUucmVwbGFjZSgvXm9yaWdpbi4vLCAnJyk7XHRcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0dmFyIHNwZWNpZml0eSA9IHJlZm5hbWUucmVwbGFjZSgvW15cXC8tXS9nLCAnJykubGVuZ3RoKjEwMDA7XHJcblx0XHRcdFx0c3BlY2lmaXR5ICs9IHJlZm5hbWUucmVwbGFjZSgvW15hLXpBLVowLTktXS8sICcnKS5sZW5ndGg7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0dGhpcy5jb250YWluZXIuYWRkQnJhbmNoKHJlZm5hbWUsIHRoaXMsIHNwZWNpZml0eSk7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0LyogYXNzaWduIHRoZSBtb3N0IHNwZWNpZmljIGhlYWQgb24gdGhpcyB0aXAgY29tbWl0ICovXHJcblx0XHRcdFx0aWYgKHRoaXMubWF4U3BlY2lmaXR5ID09IG51bGwgfHwgc3BlY2lmaXR5IDwgdGhpcy5tYXhTcGVjaWZpdHkpIHtcclxuXHRcdFx0XHRcdExvZ2dlci5kZWJ1ZyhcImFzc2lnbmluZyBicmFuY2hcIiwgcmVmbmFtZSwgdGhpcy5zaGEsIHRoaXMubWF4U3BlY2lmaXR5LCBzcGVjaWZpdHkpXHJcblx0XHRcdFx0XHR0aGlzLm1heFNwZWNpZml0eSA9IHNwZWNpZml0eTtcclxuXHRcdFx0XHRcdHRoaXMuYnJhbmNoID0gdGhpcy5jb250YWluZXIuaGVhZHNNYXBbcmVmbmFtZV07XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHJcblx0XHRcdFx0dGhpcy5pbml0RGVmYXVsdEJyYW5jaCgpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdHB1YmxpYyBpbml0TWVyZ2VzKCkge1xyXG5cclxuXHRcdHRoaXMubWVyZ2VzID0geyBzdGFuZGFyZDogW10sIGFub255bW91czogW119O1xyXG5cdFx0dGhpcy53YXJuaW5ncyA9IFtdO1xyXG5cdFx0XHJcblx0XHQvLyBEZXRlY3QgYSBtZXJnZSAob2N0b3B1cyBjdXJyZW50bHkgbm90IHN1cHBvcnRlZClcclxuXHJcblx0XHRpZih0aGlzLnBhcmVudHMubGVuZ3RoID09IDEpIHtcclxuXHRcdFx0dmFyIGRwID0gdGhpcy5wYXJlbnRzWzBdO1xyXG5cdFx0XHR0aGlzLmRpcmVjdHBhcmVudCA9IGRwO1xyXG5cdFx0XHRkcC5kaXJlY3RjaGlsZCA9IHRoaXM7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdGlmKHRoaXMucGFyZW50cy5sZW5ndGggPj0gMikge1xyXG5cdFx0XHR2YXIgZHAgPSB0aGlzLnBhcmVudHNbMF07XHJcblx0XHRcdHRoaXMuZGlyZWN0cGFyZW50ID0gZHA7XHJcblx0XHRcdGRwLmRpcmVjdGNoaWxkID0gdGhpcztcclxuXHJcblx0XHRcdGZvcih2YXIgaSA9IDEgOyBpPHRoaXMucGFyZW50cy5sZW5ndGggOyBpKyspIHtcdFx0XHRcclxuXHRcdFx0dmFyIG1wID0gdGhpcy5wYXJlbnRzW2ldO1xyXG5cdFxyXG5cdFx0XHRcdGlmKG1wICE9IG51bGwpIHtcclxuXHRcclxuXHRcdFx0XHRcdC8vIENsdWVzIGlmIHRoaXMgaXMgYSBzdGFuZGFyZCBvciBhbm9ueW1vdXMgbWVyZ2VcclxuXHRcdFx0XHRcdGlmKG1wLmRhdGEucmVmbmFtZXMubGVuZ3RoID4gMCAvLyBUaGlzIGlzIHN0YW5kYXJkIG1lcmdlIHdpdGggbXBzIGhlYWRcclxuXHRcdFx0XHRcdFx0fHwgbXAuaW5IZWFkc1JlZi5sZW5ndGggIT0gZHAuaW5IZWFkc1JlZi5sZW5ndGggLy8gVGhlIGhlYWRzIG9mIGJvdGggYXJlIGRpZmZlcmVudFxyXG5cdFx0XHRcdFx0KSB7XHJcblx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHR0aGlzLm1lcmdlcy5zdGFuZGFyZC5wdXNoKHtzb3VyY2U6IG1wfSk7XHJcblx0XHRcdFx0XHR9IGVsc2UgIHtcclxuXHRcdFx0XHRcdFx0Ly8gVGhpcyBpcyBhIGFub255bW91cyAoYXV0b21hdGljKSBtZXJnZSBvbiB0aGUgc2FtZSBicmFuY2hcclxuXHRcdFx0XHRcdFx0dGhpcy5tZXJnZXMuYW5vbnltb3VzLnB1c2goe3NvdXJjZTogbXB9KVxyXG5cdFx0XHRcdFx0XHR0aGlzLmluaXRBbm9ueW1vdXMoKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0cHVibGljIGluaXRBbm9ueW1vdXMoKSB7XHJcblx0XHQvLyBDcmVhdGUgYSBkdW1teSBicmFuY2ggZm9yIGFub255bW91cyBtZXJnZXMsIHdoaWNoIGlzIGFzIHNwZWNpZmljIGFzIHRoZSBvcmlnaW5hbCBicmFuY2guIFxyXG5cdFx0Ly8gdHJ5IGZpbmRpbmcgdGhlIG9yaWdpbmFsIGJyYW5jaCBieSBnb2luZyB1cCBkaXJlY3QgY2hpbGRzLCB3aGljaCB3aWxsIGdldCB0aGUgb3JpZ2luYWxcclxuXHRcdFxyXG5cdFx0dmFyIHNlbGY6IENvbW1pdCA9IHRoaXM7XHJcblx0XHR0aGlzLm1lcmdlcy5hbm9ueW1vdXMuZm9yRWFjaChfbWVyZ2UgPT4ge1xyXG5cdFx0XHR2YXIgbWVyZ2U6IENvbW1pdCA9IF9tZXJnZS5zb3VyY2VcclxuXHRcdFx0dmFyIGNoaWxkID0gdGhpcztcclxuXHRcdFx0XHJcblx0XHRcdHdoaWxlKGNoaWxkICE9IG51bGwgJiYgY2hpbGQuYnJhbmNoID09IG51bGwpIHtcclxuXHRcdFx0XHRjaGlsZCA9IGNoaWxkLmRpcmVjdGNoaWxkO1xyXG5cdFx0XHR9XHJcblx0XHRcdFx0XHJcblx0XHRcdC8qIHRoaXMgaXMgb25seSBhbiBhbm9ueW1vdXMgYnJhbmNoIGhlYWQsIGlmIHRoZXJlIGlzIG9ubHkgb25lIGNoaWxkICh0aGUgbWVyZ2UpIFxyXG5cdFx0XHQgICBUT0RPOiBpZiB0aGVyZSBhcmUgbXVsdGlwbGUsIGl0IG1pZ2h0IHJlc3VsdCBpbiB3cm9uZ2x5IGFzc2lnbmVkIGJyYW5jaGVzICovIFxyXG5cdFx0XHRpZihjaGlsZCAhPSBudWxsICYmIG1lcmdlLmJyYW5jaCA9PSBudWxsKSB7XHJcblx0XHRcdFx0bWVyZ2UuYnJhbmNoID0gbmV3IEJyYW5jaChjaGlsZC5icmFuY2gucmVmK1wiL2Fub255bW91c1wiK21lcmdlLnNoYStNYXRoLnJhbmRvbSgpLCBtZXJnZSwgY2hpbGQuYnJhbmNoLnNwZWNpZml0eSsxKTtcclxuXHRcdFx0XHRtZXJnZS5icmFuY2guYW5vbnltb3VzID0gdHJ1ZTtcclxuXHRcdFx0XHRtZXJnZS5icmFuY2gucGFyZW50ID0gY2hpbGQuYnJhbmNoO1xyXG5cdFx0XHRcdG1lcmdlLmJyYW5jaC5zdGFydCA9Y2hpbGQ7XHJcblx0XHRcdFx0bWVyZ2UuYnJhbmNoLmNhdGVnb3J5ID0gY2hpbGQuYnJhbmNoLmNhdGVnb3J5O1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdHRoaXMuY29udGFpbmVyLmhlYWRzTWFwW21lcmdlLmJyYW5jaC5yZWZdID0gbWVyZ2UuYnJhbmNoO1xyXG5cdFx0XHR9XHJcblx0XHRcdFxyXG5cdFx0fSk7XHJcblx0fVxyXG5cdFxyXG5cdHB1YmxpYyBnZXRDb2xvcihsaWdodG5lc3M6IG51bWJlcik6IHN0cmluZyB7XHJcblx0XHRpZih0aGlzLmJyYW5jaCA9PSBudWxsKSB7XHJcblx0XHRcdHRoaXMud2FybihcIk5vIEJyYW5jaCBzZXRcIilcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHZhciBiID0gdGhpcy5icmFuY2g7XHJcblx0XHRcdGlmKHRoaXMuYnJhbmNoLmFub255bW91cykge1xyXG5cdFx0XHRcdGIgPSB0aGlzLmJyYW5jaC5wYXJlbnQ7XHJcblx0XHRcdH1cclxuXHRcdFx0XHJcblx0XHRcdHZhciBodWUgPSBiLmxhbmUgKiAzMDAvdGhpcy5jb250YWluZXIubWF4WDtcclxuXHRcdFx0cmV0dXJuIFwiaHNsKFwiK2h1ZStcIiwgMTAwJSwgXCIrbGlnaHRuZXNzK1wiJSlcIjtcclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0cHVibGljIGhhc01lcmdlcygpOiBib29sZWFuIHtcclxuXHRcdHJldHVybiB0aGlzLm1lcmdlcy5zdGFuZGFyZC5sZW5ndGggPiAwIHx8IHRoaXMubWVyZ2VzLmFub255bW91cy5sZW5ndGggPiAwO1xyXG5cdH1cclxuXHRcclxuXHRwdWJsaWMgZ2V0WCgpIHtcclxuXHRcdHJldHVybiBpbmRleFRvWCh0aGlzLmdldExhbmUoKSk7IFxyXG5cdH1cclxuXHRcclxuXHRwdWJsaWMgZ2V0WSgpIHtcclxuXHRcdGlmKHRoaXMub3V0T2ZTY29wZSkge1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5jb250YWluZXIucm9vdExhYmVsLm9mZnNldFRvcCArIDIwO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRoaXMudmlldy5sYWJlbC5vZmZzZXRUb3AgLSB0aGlzLmNvbnRhaW5lci5maXJzdENvbW1pdC52aWV3LmxhYmVsLm9mZnNldFRvcCArIHRoaXMudmlldy5sYWJlbC5vZmZzZXRIZWlnaHQgLzI7XHJcblx0fVxyXG5cdFxyXG5cdHB1YmxpYyBnZXRPcmlnaW5JbmRleFkoKTogbnVtYmVyIHtcclxuXHRcdGlmKHRoaXMuYnJhbmNoLm9yaWdpbiAhPSB1bmRlZmluZWQpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuYnJhbmNoLm9yaWdpbi5nZXRJbmRleFkoKTtcclxuXHRcdH0gZWxzZSBpZih0aGlzLmJyYW5jaC5zdGFydC5vdXRPZlNjb3BlKXtcclxuXHRcdFx0cmV0dXJuIHRoaXMuY29udGFpbmVyLm1heEluZGV4WTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHJldHVybiB0aGlzLmJyYW5jaC5zdGFydC5pbmRleFk7XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdHB1YmxpYyBpbnRlcnNlY3RzKG90aGVyOiBDb21taXQpOiBib29sZWFuIHtcclxuXHRcdHZhciBvdGhlclk9OTk5OTk5OSwgdGhpc1k9OTk5OTk5O1xyXG5cdFx0aWYodGhpcy5vdXRPZlNjb3BlIHx8IG90aGVyLm91dE9mU2NvcGUpIHJldHVybiB0cnVlO1xyXG5cdFx0XHJcblx0XHRpZihvdGhlci5kaXJlY3RjaGlsZCAhPSBudWxsKSB7XHJcblx0XHRcdG90aGVyWSA9IG90aGVyLmRpcmVjdGNoaWxkLmluZGV4WTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0aWYodGhpcy5kaXJlY3RjaGlsZCAhPSBudWxsKSB7XHJcblx0XHRcdHRoaXNZID0gdGhpcy5kaXJlY3RjaGlsZC5pbmRleFk7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdHJldHVybiB0aGlzLmdldE9yaWdpbkluZGV4WSgpID49IE1hdGgubWluKG90aGVyLmluZGV4WSwgb3RoZXJZKSAmJiBNYXRoLm1pbih0aGlzWSwgdGhpcy5pbmRleFkpIDw9IG90aGVyLmdldE9yaWdpbkluZGV4WSgpO1xyXG5cdH1cclxuXHRcclxuXHRwdWJsaWMgZ2V0SW5kZXgoKTogbnVtYmVyIHtcclxuXHRcdHJldHVybiB0aGlzLmRhdGEuaW5kZXg7XHJcblx0fVxyXG5cdFxyXG5cdHB1YmxpYyBnZXRJbmRleFkoKTogbnVtYmVyIHtcclxuXHRcdHJldHVybiB0aGlzLmluZGV4WTtcclxuXHR9XHJcblx0XHJcblx0cHVibGljIHdhcm4od2FybmluZzogc3RyaW5nKSB7XHJcblx0XHR0aGlzLndhcm5pbmdzLnB1c2god2FybmluZyk7XHJcblx0XHR0aGlzLmRlYnVnKHdhcm5pbmcpO1xyXG5cdH1cclxuXHRcclxuXHRwdWJsaWMgZGVidWcod2FybmluZzogc3RyaW5nKSB7XHJcblx0XHRpZihjb25zb2xlKSB7XHJcblx0XHRcdExvZ2dlci5kZWJ1Zyh3YXJuaW5nLCB0aGlzKTtcclxuXHRcdH1cclxuXHR9XHJcblx0XHRcclxuXHRwdWJsaWMgZ2V0TGFuZSgpIHtcclxuXHRcdGlmKHRoaXMuYnJhbmNoICE9IG51bGwpIHsgLy8gVE9ETzogYW5vbnltb3VzIGJyYW5jaGVzIHdpbGwgZ2V0IHRoZWlyIGluZGV4IGZyb20gcGFyZW50IG9uZXNcclxuXHRcdFx0cmV0dXJuIHRoaXMuYnJhbmNoLmNvbW1pdC5icmFuY2gubGFuZTtcclxuXHRcdH1cdFxyXG5cdFx0cmV0dXJuIG51bGw7XHJcblx0fVxyXG5cdFxyXG5cclxuXHRcclxufVxyXG5cdFxyXG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiQ29tbWl0LnRzXCIvPlxyXG5cclxuY2xhc3MgQnJhbmNoIHtcclxuXHRwdWJsaWMgc3BlY2lmaXR5OiBudW1iZXI7XHJcblx0cHVibGljIHN0YXJ0OiBDb21taXQ7XHJcblx0cHVibGljIG9yaWdpbjogQ29tbWl0O1xyXG5cdHB1YmxpYyBjYXRlZ29yeTogc3RyaW5nO1xyXG5cdHB1YmxpYyBjb21taXQ6IENvbW1pdDsgLy8gSGVhZCBjb21taXRcclxuXHRwdWJsaWMgcmVmOiBzdHJpbmc7IC8vIE5hbWUgb2YgdGhlIGJyYW5jaFxyXG5cdHB1YmxpYyBzaG9ydG5hbWU6IHN0cmluZyAvLyBuYW1lIHdpdGhvdXQgcmVwbyBcclxuXHRwdWJsaWMgbGFuZTogbnVtYmVyO1xyXG5cdHB1YmxpYyBwYXJlbnQ6IEJyYW5jaDtcclxuXHRwdWJsaWMgYW5vbnltb3VzOiBib29sZWFuO1xyXG5cdFxyXG5cclxuXHRjb25zdHJ1Y3RvcihyZWZuYW1lOiBzdHJpbmcsIGNvbW1pdDogQ29tbWl0LCBzcGVjaWZpdHk6IG51bWJlcikge1xyXG5cdFx0dGhpcy5yZWYgPSByZWZuYW1lO1xyXG5cdFx0dGhpcy5jb21taXQgPSBjb21taXQ7XHJcblx0XHR0aGlzLnNwZWNpZml0eSA9IHNwZWNpZml0eTtcclxuXHRcdHRoaXMuc2hvcnRuYW1lID0gcmVmbmFtZS5zcGxpdChcIkBcIilbMF07XHJcblx0XHR0aGlzLmNhdGVnb3J5ID0gdGhpcy5zaG9ydG5hbWUuc3Vic3RyaW5nKDAsIHRoaXMuc2hvcnRuYW1lLmxhc3RJbmRleE9mKFwiL1wiKSk7XHJcblx0fVxyXG59Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
